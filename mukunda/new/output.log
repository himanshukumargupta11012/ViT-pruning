nohup: ignoring input
2025-04-24 15:30:56.088868: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-24 15:30:56.105375: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745488856.125282 1344097 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745488856.131300 1344097 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-24 15:30:56.150756: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/ai21btech11012/ViT-pruning/mukunda/myenv/lib/python3.12/site-packages/transformers/models/vit/feature_extraction_vit.py:28: FutureWarning: The class ViTFeatureExtractor is deprecated and will be removed in version 5 of Transformers. Please use ViTImageProcessor instead.
  warnings.warn(
Fast image processor class <class 'transformers.models.vit.image_processing_vit_fast.ViTImageProcessorFast'> is available for this model. Using slow image processor class. To use the fast image processor class set `use_fast=True`.
CUDA device: 0 hi_main.py --model_desc vit_config.json
Path to dataset files: /home/ai21btech11012/.cache/kagglehub/datasets/akash2sharma/tiny-imagenet/versions/1/tiny-imagenet-200
vit.embeddings.cls_token: torch.Size([1, 1, 768])
vit.embeddings.position_embeddings: torch.Size([1, 197, 768])
vit.embeddings.patch_embeddings.projection.weight: torch.Size([768, 3, 16, 16])
vit.embeddings.patch_embeddings.projection.bias: torch.Size([768])
vit.encoder.layer.0.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.0.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.0.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.0.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.0.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.0.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.0.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.0.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.0.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.0.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.0.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.0.output.dense.bias: torch.Size([768])
vit.encoder.layer.0.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.0.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.0.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.0.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.1.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.1.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.1.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.1.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.1.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.1.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.1.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.1.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.1.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.1.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.1.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.1.output.dense.bias: torch.Size([768])
vit.encoder.layer.1.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.1.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.1.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.1.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.2.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.2.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.2.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.2.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.2.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.2.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.2.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.2.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.2.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.2.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.2.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.2.output.dense.bias: torch.Size([768])
vit.encoder.layer.2.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.2.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.2.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.2.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.3.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.3.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.3.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.3.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.3.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.3.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.3.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.3.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.3.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.3.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.3.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.3.output.dense.bias: torch.Size([768])
vit.encoder.layer.3.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.3.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.3.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.3.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.4.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.4.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.4.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.4.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.4.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.4.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.4.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.4.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.4.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.4.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.4.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.4.output.dense.bias: torch.Size([768])
vit.encoder.layer.4.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.4.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.4.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.4.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.5.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.5.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.5.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.5.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.5.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.5.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.5.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.5.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.5.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.5.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.5.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.5.output.dense.bias: torch.Size([768])
vit.encoder.layer.5.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.5.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.5.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.5.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.6.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.6.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.6.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.6.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.6.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.6.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.6.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.6.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.6.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.6.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.6.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.6.output.dense.bias: torch.Size([768])
vit.encoder.layer.6.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.6.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.6.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.6.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.7.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.7.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.7.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.7.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.7.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.7.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.7.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.7.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.7.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.7.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.7.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.7.output.dense.bias: torch.Size([768])
vit.encoder.layer.7.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.7.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.7.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.7.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.8.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.8.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.8.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.8.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.8.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.8.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.8.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.8.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.8.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.8.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.8.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.8.output.dense.bias: torch.Size([768])
vit.encoder.layer.8.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.8.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.8.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.8.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.9.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.9.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.9.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.9.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.9.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.9.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.9.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.9.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.9.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.9.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.9.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.9.output.dense.bias: torch.Size([768])
vit.encoder.layer.9.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.9.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.9.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.9.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.10.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.10.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.10.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.10.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.10.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.10.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.10.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.10.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.10.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.10.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.10.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.10.output.dense.bias: torch.Size([768])
vit.encoder.layer.10.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.10.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.10.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.10.layernorm_after.bias: torch.Size([768])
vit.encoder.layer.11.attention.attention.query.weight: torch.Size([768, 768])
vit.encoder.layer.11.attention.attention.query.bias: torch.Size([768])
vit.encoder.layer.11.attention.attention.key.weight: torch.Size([768, 768])
vit.encoder.layer.11.attention.attention.key.bias: torch.Size([768])
vit.encoder.layer.11.attention.attention.value.weight: torch.Size([768, 768])
vit.encoder.layer.11.attention.attention.value.bias: torch.Size([768])
vit.encoder.layer.11.attention.output.dense.weight: torch.Size([768, 768])
vit.encoder.layer.11.attention.output.dense.bias: torch.Size([768])
vit.encoder.layer.11.intermediate.dense.weight: torch.Size([3072, 768])
vit.encoder.layer.11.intermediate.dense.bias: torch.Size([3072])
vit.encoder.layer.11.output.dense.weight: torch.Size([768, 3072])
vit.encoder.layer.11.output.dense.bias: torch.Size([768])
vit.encoder.layer.11.layernorm_before.weight: torch.Size([768])
vit.encoder.layer.11.layernorm_before.bias: torch.Size([768])
vit.encoder.layer.11.layernorm_after.weight: torch.Size([768])
vit.encoder.layer.11.layernorm_after.bias: torch.Size([768])
vit.layernorm.weight: torch.Size([768])
vit.layernorm.bias: torch.Size([768])
classifier.weight: torch.Size([1000, 768])
classifier.bias: torch.Size([1000])
Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:18<02:11, 18.84s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:34<01:40, 16.76s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:48<01:17, 15.48s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [01:03<01:01, 15.38s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [01:19<00:47, 15.71s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [01:36<00:32, 16.09s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [01:52<00:16, 16.13s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [02:00<00:00, 13.50s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy at starting: (0.0, tensor(1.))
Epoch [1/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [1/10]:   1%|          | 1/157 [00:04<12:17,  4.73s/it]Epoch [1/10]:   1%|▏         | 2/157 [00:12<16:35,  6.42s/it]Epoch [1/10]:   2%|▏         | 3/157 [00:20<18:59,  7.40s/it]Epoch [1/10]:   3%|▎         | 4/157 [00:29<20:02,  7.86s/it]Epoch [1/10]:   3%|▎         | 5/157 [00:38<20:32,  8.11s/it]Epoch [1/10]:   4%|▍         | 6/157 [00:46<20:46,  8.26s/it]Epoch [1/10]:   4%|▍         | 7/157 [00:55<20:52,  8.35s/it]Epoch [1/10]:   5%|▌         | 8/157 [01:03<20:54,  8.42s/it]Epoch [1/10]:   6%|▌         | 9/157 [01:12<20:52,  8.46s/it]Epoch [1/10]:   6%|▋         | 10/157 [01:20<20:47,  8.49s/it]Epoch [1/10]:   7%|▋         | 11/157 [01:28<20:23,  8.38s/it]Epoch [1/10]:   8%|▊         | 12/157 [01:37<20:05,  8.31s/it]Epoch [1/10]:   8%|▊         | 13/157 [01:45<20:07,  8.38s/it]Epoch [1/10]:   9%|▉         | 14/157 [01:54<20:06,  8.44s/it]Epoch [1/10]:  10%|▉         | 15/157 [02:02<20:03,  8.48s/it]Epoch [1/10]:  10%|█         | 16/157 [02:11<19:58,  8.50s/it]Epoch [1/10]:  11%|█         | 17/157 [02:19<19:53,  8.52s/it]Epoch [1/10]:  11%|█▏        | 18/157 [02:28<19:45,  8.53s/it]Epoch [1/10]:  12%|█▏        | 19/157 [02:36<19:07,  8.31s/it]Epoch [1/10]:  13%|█▎        | 20/157 [02:43<18:35,  8.14s/it]Epoch [1/10]:  13%|█▎        | 21/157 [02:51<18:13,  8.04s/it]Epoch [1/10]:  14%|█▍        | 22/157 [02:55<15:29,  6.88s/it]Epoch [1/10]:  15%|█▍        | 23/157 [03:01<14:29,  6.49s/it]Epoch [1/10]:  15%|█▌        | 24/157 [03:09<15:12,  6.86s/it]Epoch [1/10]:  16%|█▌        | 25/157 [03:17<15:45,  7.16s/it]Epoch [1/10]:  17%|█▋        | 26/157 [03:25<16:33,  7.58s/it]Epoch [1/10]:  17%|█▋        | 27/157 [03:34<17:01,  7.86s/it]Epoch [1/10]:  18%|█▊        | 28/157 [03:42<17:19,  8.06s/it]Epoch [1/10]:  18%|█▊        | 29/157 [03:50<17:07,  8.03s/it]Epoch [1/10]:  19%|█▉        | 30/157 [03:55<15:01,  7.09s/it]Epoch [1/10]:  20%|█▉        | 31/157 [04:00<13:31,  6.44s/it]Epoch [1/10]:  20%|██        | 32/157 [04:05<12:27,  5.98s/it]Epoch [1/10]:  21%|██        | 33/157 [04:09<10:55,  5.28s/it]Epoch [1/10]:  22%|██▏       | 34/157 [04:11<09:20,  4.56s/it]Epoch [1/10]:  22%|██▏       | 35/157 [04:16<09:28,  4.66s/it]Epoch [1/10]:  23%|██▎       | 36/157 [04:21<09:32,  4.73s/it]Epoch [1/10]:  24%|██▎       | 37/157 [04:26<09:34,  4.79s/it]Epoch [1/10]:  24%|██▍       | 38/157 [04:31<09:32,  4.81s/it]Epoch [1/10]:  25%|██▍       | 39/157 [04:36<09:29,  4.83s/it]Epoch [1/10]:  25%|██▌       | 40/157 [04:41<09:28,  4.86s/it]Epoch [1/10]:  26%|██▌       | 41/157 [04:46<09:24,  4.87s/it]Epoch [1/10]:  27%|██▋       | 42/157 [04:51<09:21,  4.88s/it]Epoch [1/10]:  27%|██▋       | 43/157 [04:56<09:17,  4.89s/it]Epoch [1/10]:  28%|██▊       | 44/157 [04:59<08:37,  4.58s/it]Epoch [1/10]:  29%|██▊       | 45/157 [05:01<07:04,  3.79s/it]Epoch [1/10]:  29%|██▉       | 46/157 [05:06<07:37,  4.12s/it]Epoch [1/10]:  30%|██▉       | 47/157 [05:11<07:58,  4.35s/it]Epoch [1/10]:  31%|███       | 48/157 [05:16<08:12,  4.52s/it]Epoch [1/10]:  31%|███       | 49/157 [05:21<08:19,  4.63s/it]Epoch [1/10]:  32%|███▏      | 50/157 [05:26<08:23,  4.71s/it]Epoch [1/10]:  32%|███▏      | 51/157 [05:31<08:25,  4.76s/it]Epoch [1/10]:  33%|███▎      | 52/157 [05:36<08:24,  4.80s/it]Epoch [1/10]:  34%|███▍      | 53/157 [05:40<08:22,  4.83s/it]Epoch [1/10]:  34%|███▍      | 54/157 [05:45<08:19,  4.85s/it]Epoch [1/10]:  35%|███▌      | 55/157 [05:49<07:33,  4.44s/it]Epoch [1/10]:  36%|███▌      | 56/157 [05:51<06:23,  3.80s/it]Epoch [1/10]:  36%|███▋      | 57/157 [05:56<06:52,  4.13s/it]Epoch [1/10]:  37%|███▋      | 58/157 [06:01<07:11,  4.36s/it]Epoch [1/10]:  38%|███▊      | 59/157 [06:06<07:23,  4.52s/it]Epoch [1/10]:  38%|███▊      | 60/157 [06:11<07:28,  4.63s/it]Epoch [1/10]:  39%|███▉      | 61/157 [06:16<07:31,  4.70s/it]Epoch [1/10]:  39%|███▉      | 62/157 [06:20<07:31,  4.75s/it]Epoch [1/10]:  40%|████      | 63/157 [06:25<07:30,  4.79s/it]Epoch [1/10]:  41%|████      | 64/157 [06:30<07:28,  4.82s/it]Epoch [1/10]:  41%|████▏     | 65/157 [06:35<07:25,  4.84s/it]Epoch [1/10]:  42%|████▏     | 66/157 [06:39<07:04,  4.66s/it]Epoch [1/10]:  43%|████▎     | 67/157 [06:42<06:03,  4.04s/it]Epoch [1/10]:  43%|████▎     | 68/157 [06:43<04:38,  3.13s/it]Epoch [1/10]:  44%|████▍     | 69/157 [06:46<04:34,  3.12s/it]Epoch [1/10]:  45%|████▍     | 70/157 [06:51<05:17,  3.65s/it]Epoch [1/10]:  45%|████▌     | 71/157 [06:56<05:46,  4.02s/it]Epoch [1/10]:  46%|████▌     | 72/157 [07:01<06:03,  4.28s/it]Epoch [1/10]:  46%|████▋     | 73/157 [07:06<06:15,  4.47s/it]Epoch [1/10]:  47%|████▋     | 74/157 [07:11<06:21,  4.60s/it]Epoch [1/10]:  48%|████▊     | 75/157 [07:18<07:31,  5.50s/it]Epoch [1/10]:  48%|████▊     | 76/157 [07:27<08:39,  6.42s/it]Epoch [1/10]:  49%|████▉     | 77/157 [07:35<09:25,  7.06s/it]Epoch [1/10]:  50%|████▉     | 78/157 [07:44<09:52,  7.50s/it]Epoch [1/10]:  50%|█████     | 79/157 [07:51<09:48,  7.55s/it]Epoch [1/10]:  51%|█████     | 80/157 [08:00<10:03,  7.84s/it]Epoch [1/10]:  52%|█████▏    | 81/157 [08:09<10:11,  8.05s/it]Epoch [1/10]:  52%|█████▏    | 82/157 [08:17<10:15,  8.20s/it]Epoch [1/10]:  53%|█████▎    | 83/157 [08:26<10:15,  8.31s/it]Epoch [1/10]:  54%|█████▎    | 84/157 [08:34<10:11,  8.38s/it]Epoch [1/10]:  54%|█████▍    | 85/157 [08:43<10:06,  8.43s/it]Epoch [1/10]:  55%|█████▍    | 86/157 [08:51<10:01,  8.47s/it]Epoch [1/10]:  55%|█████▌    | 87/157 [09:00<09:53,  8.48s/it]Epoch [1/10]:  56%|█████▌    | 88/157 [09:08<09:46,  8.50s/it]Epoch [1/10]:  57%|█████▋    | 89/157 [09:17<09:38,  8.50s/it]Epoch [1/10]:  57%|█████▋    | 90/157 [09:24<09:09,  8.21s/it]Epoch [1/10]:  58%|█████▊    | 91/157 [09:33<09:08,  8.31s/it]Epoch [1/10]:  59%|█████▊    | 92/157 [09:41<08:50,  8.17s/it]Epoch [1/10]:  59%|█████▉    | 93/157 [09:49<08:39,  8.12s/it]Epoch [1/10]:  60%|█████▉    | 94/157 [09:57<08:39,  8.24s/it]Epoch [1/10]:  61%|██████    | 95/157 [10:06<08:36,  8.34s/it]Epoch [1/10]:  61%|██████    | 96/157 [10:14<08:32,  8.39s/it]Epoch [1/10]:  62%|██████▏   | 97/157 [10:23<08:26,  8.44s/it]Epoch [1/10]:  62%|██████▏   | 98/157 [10:31<08:19,  8.47s/it]Epoch [1/10]:  63%|██████▎   | 99/157 [10:40<08:12,  8.49s/it]Epoch [1/10]:  64%|██████▎   | 100/157 [10:48<07:51,  8.27s/it]Epoch [1/10]:  64%|██████▍   | 101/157 [10:56<07:47,  8.35s/it]Epoch [1/10]:  65%|██████▍   | 102/157 [11:05<07:42,  8.41s/it]Epoch [1/10]:  66%|██████▌   | 103/157 [11:13<07:36,  8.46s/it]Epoch [1/10]:  66%|██████▌   | 104/157 [11:22<07:29,  8.49s/it]Epoch [1/10]:  67%|██████▋   | 105/157 [11:31<07:22,  8.50s/it]Epoch [1/10]:  68%|██████▊   | 106/157 [11:39<07:14,  8.51s/it]Epoch [1/10]:  68%|██████▊   | 107/157 [11:48<07:06,  8.52s/it]Epoch [1/10]:  69%|██████▉   | 108/157 [11:56<06:58,  8.54s/it]Epoch [1/10]:  69%|██████▉   | 109/157 [12:05<06:49,  8.53s/it]Epoch [1/10]:  70%|███████   | 110/157 [12:12<06:19,  8.07s/it]Epoch [1/10]:  71%|███████   | 111/157 [12:16<05:25,  7.08s/it]Epoch [1/10]:  71%|███████▏  | 112/157 [12:25<05:34,  7.43s/it]Epoch [1/10]:  72%|███████▏  | 113/157 [12:33<05:41,  7.76s/it]Epoch [1/10]:  73%|███████▎  | 114/157 [12:42<05:44,  8.00s/it]Epoch [1/10]:  73%|███████▎  | 115/157 [12:50<05:42,  8.16s/it]Epoch [1/10]:  74%|███████▍  | 116/157 [12:59<05:39,  8.27s/it]Epoch [1/10]:  75%|███████▍  | 117/157 [13:07<05:34,  8.35s/it]Epoch [1/10]:  75%|███████▌  | 118/157 [13:16<05:27,  8.40s/it]Epoch [1/10]:  76%|███████▌  | 119/157 [13:24<05:20,  8.44s/it]Epoch [1/10]:  76%|███████▋  | 120/157 [13:33<05:13,  8.47s/it]Epoch [1/10]:  77%|███████▋  | 121/157 [13:41<04:58,  8.28s/it]Epoch [1/10]:  78%|███████▊  | 122/157 [13:49<04:52,  8.35s/it]Epoch [1/10]:  78%|███████▊  | 123/157 [13:58<04:46,  8.41s/it]Epoch [1/10]:  79%|███████▉  | 124/157 [14:06<04:38,  8.45s/it]Epoch [1/10]:  80%|███████▉  | 125/157 [14:15<04:30,  8.47s/it]Epoch [1/10]:  80%|████████  | 126/157 [14:23<04:22,  8.48s/it]Epoch [1/10]:  81%|████████  | 127/157 [14:32<04:14,  8.50s/it]Epoch [1/10]:  82%|████████▏ | 128/157 [14:41<04:06,  8.51s/it]Epoch [1/10]:  82%|████████▏ | 129/157 [14:48<03:52,  8.30s/it]Epoch [1/10]:  83%|████████▎ | 130/157 [14:56<03:41,  8.20s/it]Epoch [1/10]:  83%|████████▎ | 131/157 [15:05<03:35,  8.30s/it]Epoch [1/10]:  84%|████████▍ | 132/157 [15:13<03:23,  8.14s/it]Epoch [1/10]:  85%|████████▍ | 133/157 [15:21<03:18,  8.26s/it]Epoch [1/10]:  85%|████████▌ | 134/157 [15:30<03:12,  8.35s/it]Epoch [1/10]:  86%|████████▌ | 135/157 [15:38<03:05,  8.41s/it]Epoch [1/10]:  87%|████████▋ | 136/157 [15:47<02:57,  8.45s/it]Epoch [1/10]:  87%|████████▋ | 137/157 [15:55<02:49,  8.48s/it]Epoch [1/10]:  88%|████████▊ | 138/157 [16:04<02:41,  8.50s/it]Epoch [1/10]:  89%|████████▊ | 139/157 [16:12<02:33,  8.51s/it]Epoch [1/10]:  89%|████████▉ | 140/157 [16:21<02:24,  8.51s/it]Epoch [1/10]:  90%|████████▉ | 141/157 [16:29<02:16,  8.53s/it]Epoch [1/10]:  90%|█████████ | 142/157 [16:37<02:04,  8.29s/it]Epoch [1/10]:  91%|█████████ | 143/157 [16:46<01:57,  8.36s/it]Epoch [1/10]:  92%|█████████▏| 144/157 [16:54<01:49,  8.42s/it]Epoch [1/10]:  92%|█████████▏| 145/157 [17:03<01:41,  8.46s/it]Epoch [1/10]:  93%|█████████▎| 146/157 [17:11<01:33,  8.48s/it]Epoch [1/10]:  94%|█████████▎| 147/157 [17:20<01:23,  8.37s/it]Epoch [1/10]:  94%|█████████▍| 148/157 [17:27<01:13,  8.19s/it]Epoch [1/10]:  95%|█████████▍| 149/157 [17:36<01:06,  8.26s/it]Epoch [1/10]:  96%|█████████▌| 150/157 [17:43<00:55,  7.97s/it]Epoch [1/10]:  96%|█████████▌| 151/157 [17:48<00:42,  7.04s/it]Epoch [1/10]:  97%|█████████▋| 152/157 [17:52<00:30,  6.19s/it]Epoch [1/10]:  97%|█████████▋| 153/157 [17:55<00:20,  5.08s/it]Epoch [1/10]:  98%|█████████▊| 154/157 [18:03<00:17,  6.00s/it]Epoch [1/10]:  99%|█████████▊| 155/157 [18:11<00:13,  6.77s/it]Epoch [1/10]:  99%|█████████▉| 156/157 [18:20<00:07,  7.30s/it]Epoch [1/10]: 100%|██████████| 157/157 [18:22<00:00,  5.83s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:18<02:06, 18.09s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:34<01:44, 17.34s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:51<01:25, 17.08s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [01:05<01:02, 15.66s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [01:21<00:48, 16.06s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [01:38<00:32, 16.29s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [01:55<00:16, 16.38s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [02:07<00:00, 15.20s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 1 epochs: 0.00%

Epoch [2/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [2/10]:   1%|          | 1/157 [00:09<25:11,  9.69s/it]Epoch [2/10]:   1%|▏         | 2/157 [00:17<21:53,  8.48s/it]Epoch [2/10]:   2%|▏         | 3/157 [00:25<21:48,  8.50s/it]Epoch [2/10]:   3%|▎         | 4/157 [00:34<21:42,  8.51s/it]Epoch [2/10]:   3%|▎         | 5/157 [00:42<21:34,  8.52s/it]Epoch [2/10]:   4%|▍         | 6/157 [00:51<21:27,  8.53s/it]Epoch [2/10]:   4%|▍         | 7/157 [01:00<21:21,  8.54s/it]Epoch [2/10]:   5%|▌         | 8/157 [01:08<21:13,  8.55s/it]Epoch [2/10]:   6%|▌         | 9/157 [01:17<21:02,  8.53s/it]Epoch [2/10]:   6%|▋         | 10/157 [01:25<20:53,  8.52s/it]Epoch [2/10]:   7%|▋         | 11/157 [01:34<20:44,  8.52s/it]Epoch [2/10]:   8%|▊         | 12/157 [01:42<20:37,  8.53s/it]Epoch [2/10]:   8%|▊         | 13/157 [01:50<19:59,  8.33s/it]Epoch [2/10]:   9%|▉         | 14/157 [01:59<19:59,  8.39s/it]Epoch [2/10]:  10%|▉         | 15/157 [02:07<19:58,  8.44s/it]Epoch [2/10]:  10%|█         | 16/157 [02:16<19:53,  8.47s/it]Epoch [2/10]:  11%|█         | 17/157 [02:24<19:26,  8.33s/it]Epoch [2/10]:  11%|█▏        | 18/157 [02:31<18:53,  8.16s/it]Epoch [2/10]:  12%|█▏        | 19/157 [02:40<19:00,  8.26s/it]Epoch [2/10]:  13%|█▎        | 20/157 [02:48<19:02,  8.34s/it]Epoch [2/10]:  13%|█▎        | 21/157 [02:57<19:02,  8.40s/it]Epoch [2/10]:  14%|█▍        | 22/157 [03:06<19:00,  8.45s/it]Epoch [2/10]:  15%|█▍        | 23/157 [03:13<18:25,  8.25s/it]Epoch [2/10]:  15%|█▌        | 24/157 [03:22<18:28,  8.34s/it]Epoch [2/10]:  16%|█▌        | 25/157 [03:30<18:30,  8.41s/it]Epoch [2/10]:  17%|█▋        | 26/157 [03:39<18:25,  8.44s/it]Epoch [2/10]:  17%|█▋        | 27/157 [03:47<18:20,  8.47s/it]Epoch [2/10]:  18%|█▊        | 28/157 [03:56<18:15,  8.49s/it]Epoch [2/10]:  18%|█▊        | 29/157 [04:05<18:08,  8.50s/it]Epoch [2/10]:  19%|█▉        | 30/157 [04:13<18:02,  8.52s/it]Epoch [2/10]:  20%|█▉        | 31/157 [04:22<17:54,  8.52s/it]Epoch [2/10]:  20%|██        | 32/157 [04:30<17:46,  8.53s/it]Epoch [2/10]:  21%|██        | 33/157 [04:38<17:09,  8.30s/it]Epoch [2/10]:  22%|██▏       | 34/157 [04:47<17:09,  8.37s/it]Epoch [2/10]:  22%|██▏       | 35/157 [04:55<17:01,  8.38s/it]Epoch [2/10]:  23%|██▎       | 36/157 [05:03<16:31,  8.20s/it]Epoch [2/10]:  24%|██▎       | 37/157 [05:11<16:22,  8.19s/it]Epoch [2/10]:  24%|██▍       | 38/157 [05:19<16:27,  8.30s/it]Epoch [2/10]:  25%|██▍       | 39/157 [05:28<16:27,  8.37s/it]Epoch [2/10]:  25%|██▌       | 40/157 [05:36<16:25,  8.43s/it]Epoch [2/10]:  26%|██▌       | 41/157 [05:45<16:21,  8.46s/it]Epoch [2/10]:  27%|██▋       | 42/157 [05:54<16:15,  8.48s/it]Epoch [2/10]:  27%|██▋       | 43/157 [06:02<16:08,  8.49s/it]Epoch [2/10]:  28%|██▊       | 44/157 [06:07<13:52,  7.37s/it]Epoch [2/10]:  29%|██▊       | 45/157 [06:15<14:23,  7.71s/it]Epoch [2/10]:  29%|██▉       | 46/157 [06:24<14:44,  7.97s/it]Epoch [2/10]:  30%|██▉       | 47/157 [06:32<14:55,  8.14s/it]Epoch [2/10]:  31%|███       | 48/157 [06:41<14:59,  8.25s/it]Epoch [2/10]:  31%|███       | 49/157 [06:49<15:00,  8.34s/it]Epoch [2/10]:  32%|███▏      | 50/157 [06:58<14:59,  8.40s/it]Epoch [2/10]:  32%|███▏      | 51/157 [07:07<14:55,  8.45s/it]Epoch [2/10]:  33%|███▎      | 52/157 [07:15<14:50,  8.48s/it]Epoch [2/10]:  34%|███▍      | 53/157 [07:24<14:43,  8.49s/it]Epoch [2/10]:  34%|███▍      | 54/157 [07:32<14:20,  8.36s/it]Epoch [2/10]:  35%|███▌      | 55/157 [07:38<13:17,  7.82s/it]Epoch [2/10]:  36%|███▌      | 56/157 [07:47<13:30,  8.03s/it]Epoch [2/10]:  36%|███▋      | 57/157 [07:55<13:38,  8.18s/it]Epoch [2/10]:  37%|███▋      | 58/157 [08:04<13:40,  8.29s/it]Epoch [2/10]:  38%|███▊      | 59/157 [08:12<13:39,  8.36s/it]Epoch [2/10]:  38%|███▊      | 60/157 [08:21<13:36,  8.41s/it]Epoch [2/10]:  39%|███▉      | 61/157 [08:30<13:31,  8.46s/it]Epoch [2/10]:  39%|███▉      | 62/157 [08:38<13:26,  8.48s/it]Epoch [2/10]:  40%|████      | 63/157 [08:47<13:19,  8.50s/it]Epoch [2/10]:  41%|████      | 64/157 [08:55<13:12,  8.52s/it]Epoch [2/10]:  41%|████▏     | 65/157 [09:03<12:43,  8.30s/it]Epoch [2/10]:  42%|████▏     | 66/157 [09:12<12:42,  8.38s/it]Epoch [2/10]:  43%|████▎     | 67/157 [09:20<12:38,  8.43s/it]Epoch [2/10]:  43%|████▎     | 68/157 [09:29<12:33,  8.47s/it]Epoch [2/10]:  44%|████▍     | 69/157 [09:37<12:26,  8.48s/it]Epoch [2/10]:  45%|████▍     | 70/157 [09:46<12:20,  8.51s/it]Epoch [2/10]:  45%|████▌     | 71/157 [09:54<12:12,  8.52s/it]Epoch [2/10]:  46%|████▌     | 72/157 [10:03<12:00,  8.47s/it]Epoch [2/10]:  46%|████▋     | 73/157 [10:10<11:33,  8.25s/it]Epoch [2/10]:  47%|████▋     | 74/157 [10:16<10:29,  7.58s/it]Epoch [2/10]:  48%|████▊     | 75/157 [10:20<08:54,  6.52s/it]Epoch [2/10]:  48%|████▊     | 76/157 [10:23<07:05,  5.26s/it]Epoch [2/10]:  49%|████▉     | 77/157 [10:28<06:51,  5.15s/it]Epoch [2/10]:  50%|████▉     | 78/157 [10:32<06:40,  5.06s/it]Epoch [2/10]:  50%|█████     | 79/157 [10:37<06:31,  5.02s/it]Epoch [2/10]:  51%|█████     | 80/157 [10:42<06:22,  4.97s/it]Epoch [2/10]:  52%|█████▏    | 81/157 [10:47<06:15,  4.95s/it]Epoch [2/10]:  52%|█████▏    | 82/157 [10:52<06:09,  4.93s/it]Epoch [2/10]:  53%|█████▎    | 83/157 [10:57<06:03,  4.91s/it]Epoch [2/10]:  54%|█████▎    | 84/157 [11:02<05:58,  4.91s/it]Epoch [2/10]:  54%|█████▍    | 85/157 [11:07<05:52,  4.90s/it]Epoch [2/10]:  55%|█████▍    | 86/157 [11:11<05:33,  4.70s/it]Epoch [2/10]:  55%|█████▌    | 87/157 [11:13<04:37,  3.96s/it]Epoch [2/10]:  56%|█████▌    | 88/157 [11:18<04:52,  4.24s/it]Epoch [2/10]:  57%|█████▋    | 89/157 [11:23<05:01,  4.43s/it]Epoch [2/10]:  57%|█████▋    | 90/157 [11:28<05:06,  4.57s/it]Epoch [2/10]:  58%|█████▊    | 91/157 [11:33<05:08,  4.67s/it]Epoch [2/10]:  59%|█████▊    | 92/157 [11:38<05:07,  4.73s/it]Epoch [2/10]:  59%|█████▉    | 93/157 [11:42<05:05,  4.78s/it]Epoch [2/10]:  60%|█████▉    | 94/157 [11:47<05:03,  4.81s/it]Epoch [2/10]:  61%|██████    | 95/157 [11:52<04:59,  4.83s/it]Epoch [2/10]:  61%|██████    | 96/157 [11:57<04:55,  4.85s/it]Epoch [2/10]:  62%|██████▏   | 97/157 [12:01<04:36,  4.61s/it]Epoch [2/10]:  62%|██████▏   | 98/157 [12:03<03:44,  3.80s/it]Epoch [2/10]:  63%|██████▎   | 99/157 [12:04<02:51,  2.96s/it]Epoch [2/10]:  64%|██████▎   | 100/157 [12:06<02:31,  2.66s/it]Epoch [2/10]:  64%|██████▍   | 101/157 [12:11<03:06,  3.33s/it]Epoch [2/10]:  65%|██████▍   | 102/157 [12:16<03:28,  3.80s/it]Epoch [2/10]:  66%|██████▌   | 103/157 [12:21<03:42,  4.12s/it]Epoch [2/10]:  66%|██████▌   | 104/157 [12:26<03:50,  4.35s/it]Epoch [2/10]:  67%|██████▋   | 105/157 [12:30<03:54,  4.51s/it]Epoch [2/10]:  68%|██████▊   | 106/157 [12:35<03:55,  4.62s/it]Epoch [2/10]:  68%|██████▊   | 107/157 [12:40<03:55,  4.70s/it]Epoch [2/10]:  69%|██████▉   | 108/157 [12:45<03:53,  4.76s/it]Epoch [2/10]:  69%|██████▉   | 109/157 [12:50<03:50,  4.80s/it]Epoch [2/10]:  70%|███████   | 110/157 [12:54<03:35,  4.59s/it]Epoch [2/10]:  71%|███████   | 111/157 [12:56<03:00,  3.92s/it]Epoch [2/10]:  71%|███████▏  | 112/157 [13:01<03:09,  4.21s/it]Epoch [2/10]:  72%|███████▏  | 113/157 [13:06<03:14,  4.42s/it]Epoch [2/10]:  73%|███████▎  | 114/157 [13:11<03:16,  4.56s/it]Epoch [2/10]:  73%|███████▎  | 115/157 [13:16<03:15,  4.65s/it]Epoch [2/10]:  74%|███████▍  | 116/157 [13:21<03:13,  4.72s/it]Epoch [2/10]:  75%|███████▍  | 117/157 [13:26<03:10,  4.76s/it]Epoch [2/10]:  75%|███████▌  | 118/157 [13:31<03:07,  4.80s/it]Epoch [2/10]:  76%|███████▌  | 119/157 [13:36<03:03,  4.83s/it]Epoch [2/10]:  76%|███████▋  | 120/157 [13:40<02:59,  4.84s/it]Epoch [2/10]:  77%|███████▋  | 121/157 [13:45<02:46,  4.62s/it]Epoch [2/10]:  78%|███████▊  | 122/157 [13:47<02:18,  3.95s/it]Epoch [2/10]:  78%|███████▊  | 123/157 [13:52<02:23,  4.23s/it]Epoch [2/10]:  79%|███████▉  | 124/157 [13:57<02:26,  4.43s/it]Epoch [2/10]:  80%|███████▉  | 125/157 [14:02<02:26,  4.57s/it]Epoch [2/10]:  80%|████████  | 126/157 [14:06<02:24,  4.66s/it]Epoch [2/10]:  81%|████████  | 127/157 [14:11<02:21,  4.72s/it]Epoch [2/10]:  82%|████████▏ | 128/157 [14:16<02:18,  4.77s/it]Epoch [2/10]:  82%|████████▏ | 129/157 [14:21<02:14,  4.80s/it]Epoch [2/10]:  83%|████████▎ | 130/157 [14:26<02:10,  4.83s/it]Epoch [2/10]:  83%|████████▎ | 131/157 [14:31<02:06,  4.85s/it]Epoch [2/10]:  84%|████████▍ | 132/157 [14:35<01:55,  4.64s/it]Epoch [2/10]:  85%|████████▍ | 133/157 [14:37<01:35,  3.96s/it]Epoch [2/10]:  85%|████████▌ | 134/157 [14:42<01:37,  4.23s/it]Epoch [2/10]:  86%|████████▌ | 135/157 [14:47<01:37,  4.43s/it]Epoch [2/10]:  87%|████████▋ | 136/157 [14:52<01:35,  4.57s/it]Epoch [2/10]:  87%|████████▋ | 137/157 [14:57<01:33,  4.66s/it]Epoch [2/10]:  88%|████████▊ | 138/157 [15:02<01:29,  4.73s/it]Epoch [2/10]:  89%|████████▊ | 139/157 [15:07<01:25,  4.77s/it]Epoch [2/10]:  89%|████████▉ | 140/157 [15:12<01:21,  4.81s/it]Epoch [2/10]:  90%|████████▉ | 141/157 [15:16<01:17,  4.83s/it]Epoch [2/10]:  90%|█████████ | 142/157 [15:21<01:12,  4.85s/it]Epoch [2/10]:  91%|█████████ | 143/157 [15:25<01:04,  4.60s/it]Epoch [2/10]:  92%|█████████▏| 144/157 [15:28<00:50,  3.91s/it]Epoch [2/10]:  92%|█████████▏| 145/157 [15:33<00:50,  4.21s/it]Epoch [2/10]:  93%|█████████▎| 146/157 [15:37<00:48,  4.42s/it]Epoch [2/10]:  94%|█████████▎| 147/157 [15:42<00:45,  4.56s/it]Epoch [2/10]:  94%|█████████▍| 148/157 [15:47<00:41,  4.66s/it]Epoch [2/10]:  95%|█████████▍| 149/157 [15:52<00:37,  4.73s/it]Epoch [2/10]:  96%|█████████▌| 150/157 [15:57<00:33,  4.77s/it]Epoch [2/10]:  96%|█████████▌| 151/157 [16:02<00:28,  4.81s/it]Epoch [2/10]:  97%|█████████▋| 152/157 [16:07<00:24,  4.84s/it]Epoch [2/10]:  97%|█████████▋| 153/157 [16:12<00:19,  4.86s/it]Epoch [2/10]:  98%|█████████▊| 154/157 [16:16<00:13,  4.57s/it]Epoch [2/10]:  99%|█████████▊| 155/157 [16:18<00:07,  3.97s/it]Epoch [2/10]:  99%|█████████▉| 156/157 [16:19<00:03,  3.08s/it]Epoch [2/10]: 100%|██████████| 157/157 [16:19<00:00,  2.24s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:11<01:17, 11.08s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:20<01:01, 10.23s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:30<00:49,  9.95s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:39<00:39,  9.82s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:48<00:28,  9.39s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:55<00:17,  8.62s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [01:05<00:08,  8.93s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [01:13<00:00,  8.59s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 2 epochs: 0.00%

Epoch [3/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [3/10]:   1%|          | 1/157 [00:05<15:17,  5.88s/it]Epoch [3/10]:   1%|▏         | 2/157 [00:10<13:40,  5.29s/it]Epoch [3/10]:   2%|▏         | 3/157 [00:15<13:06,  5.11s/it]Epoch [3/10]:   3%|▎         | 4/157 [00:20<12:47,  5.02s/it]Epoch [3/10]:   3%|▎         | 5/157 [00:25<12:16,  4.85s/it]Epoch [3/10]:   4%|▍         | 6/157 [00:27<10:15,  4.07s/it]Epoch [3/10]:   4%|▍         | 7/157 [00:31<09:47,  3.92s/it]Epoch [3/10]:   5%|▌         | 8/157 [00:36<10:29,  4.23s/it]Epoch [3/10]:   6%|▌         | 9/157 [00:41<10:56,  4.44s/it]Epoch [3/10]:   6%|▋         | 10/157 [00:45<11:11,  4.57s/it]Epoch [3/10]:   7%|▋         | 11/157 [00:50<11:20,  4.66s/it]Epoch [3/10]:   8%|▊         | 12/157 [00:55<11:25,  4.73s/it]Epoch [3/10]:   8%|▊         | 13/157 [01:00<11:27,  4.77s/it]Epoch [3/10]:   9%|▉         | 14/157 [01:05<11:27,  4.81s/it]Epoch [3/10]:  10%|▉         | 15/157 [01:10<11:25,  4.83s/it]Epoch [3/10]:  10%|█         | 16/157 [01:15<11:22,  4.84s/it]Epoch [3/10]:  11%|█         | 17/157 [01:18<10:03,  4.31s/it]Epoch [3/10]:  11%|█▏        | 18/157 [01:21<09:28,  4.09s/it]Epoch [3/10]:  12%|█▏        | 19/157 [01:26<09:57,  4.33s/it]Epoch [3/10]:  13%|█▎        | 20/157 [01:31<10:16,  4.50s/it]Epoch [3/10]:  13%|█▎        | 21/157 [01:36<10:27,  4.62s/it]Epoch [3/10]:  14%|█▍        | 22/157 [01:41<10:33,  4.69s/it]Epoch [3/10]:  15%|█▍        | 23/157 [01:46<10:36,  4.75s/it]Epoch [3/10]:  15%|█▌        | 24/157 [01:51<10:36,  4.78s/it]Epoch [3/10]:  16%|█▌        | 25/157 [01:56<10:36,  4.82s/it]Epoch [3/10]:  17%|█▋        | 26/157 [02:00<10:33,  4.83s/it]Epoch [3/10]:  17%|█▋        | 27/157 [02:05<10:30,  4.85s/it]Epoch [3/10]:  18%|█▊        | 28/157 [02:08<09:17,  4.32s/it]Epoch [3/10]:  18%|█▊        | 29/157 [02:12<08:43,  4.09s/it]Epoch [3/10]:  19%|█▉        | 30/157 [02:17<09:09,  4.33s/it]Epoch [3/10]:  20%|█▉        | 31/157 [02:22<09:26,  4.50s/it]Epoch [3/10]:  20%|██        | 32/157 [02:27<09:36,  4.61s/it]Epoch [3/10]:  21%|██        | 33/157 [02:31<09:42,  4.70s/it]Epoch [3/10]:  22%|██▏       | 34/157 [02:36<09:44,  4.76s/it]Epoch [3/10]:  22%|██▏       | 35/157 [02:41<09:44,  4.79s/it]Epoch [3/10]:  23%|██▎       | 36/157 [02:46<09:43,  4.82s/it]Epoch [3/10]:  24%|██▎       | 37/157 [02:51<09:41,  4.84s/it]Epoch [3/10]:  24%|██▍       | 38/157 [02:56<09:37,  4.86s/it]Epoch [3/10]:  25%|██▍       | 39/157 [02:59<08:28,  4.31s/it]Epoch [3/10]:  25%|██▌       | 40/157 [03:00<06:27,  3.32s/it]Epoch [3/10]:  26%|██▌       | 41/157 [03:01<05:09,  2.67s/it]Epoch [3/10]:  27%|██▋       | 42/157 [03:05<05:54,  3.09s/it]Epoch [3/10]:  27%|██▋       | 43/157 [03:10<06:53,  3.62s/it]Epoch [3/10]:  28%|██▊       | 44/157 [03:15<07:33,  4.01s/it]Epoch [3/10]:  29%|██▊       | 45/157 [03:20<07:58,  4.27s/it]Epoch [3/10]:  29%|██▉       | 46/157 [03:25<08:13,  4.45s/it]Epoch [3/10]:  30%|██▉       | 47/157 [03:30<08:23,  4.58s/it]Epoch [3/10]:  31%|███       | 48/157 [03:34<08:28,  4.67s/it]Epoch [3/10]:  31%|███       | 49/157 [03:39<08:31,  4.73s/it]Epoch [3/10]:  32%|███▏      | 50/157 [03:44<08:31,  4.78s/it]Epoch [3/10]:  32%|███▏      | 51/157 [03:49<08:24,  4.76s/it]Epoch [3/10]:  33%|███▎      | 52/157 [03:52<07:11,  4.11s/it]Epoch [3/10]:  34%|███▍      | 53/157 [03:54<06:30,  3.75s/it]Epoch [3/10]:  34%|███▍      | 54/157 [03:59<07:00,  4.09s/it]Epoch [3/10]:  35%|███▌      | 55/157 [04:04<07:21,  4.33s/it]Epoch [3/10]:  36%|███▌      | 56/157 [04:09<07:34,  4.50s/it]Epoch [3/10]:  36%|███▋      | 57/157 [04:14<07:41,  4.61s/it]Epoch [3/10]:  37%|███▋      | 58/157 [04:19<07:44,  4.69s/it]Epoch [3/10]:  38%|███▊      | 59/157 [04:24<07:45,  4.75s/it]Epoch [3/10]:  38%|███▊      | 60/157 [04:29<07:44,  4.79s/it]Epoch [3/10]:  39%|███▉      | 61/157 [04:33<07:41,  4.81s/it]Epoch [3/10]:  39%|███▉      | 62/157 [04:38<07:39,  4.84s/it]Epoch [3/10]:  40%|████      | 63/157 [04:42<07:03,  4.51s/it]Epoch [3/10]:  41%|████      | 64/157 [04:45<06:06,  3.94s/it]Epoch [3/10]:  41%|████▏     | 65/157 [04:50<06:28,  4.22s/it]Epoch [3/10]:  42%|████▏     | 66/157 [04:54<06:42,  4.42s/it]Epoch [3/10]:  43%|████▎     | 67/157 [04:59<06:50,  4.57s/it]Epoch [3/10]:  43%|████▎     | 68/157 [05:04<06:54,  4.66s/it]Epoch [3/10]:  44%|████▍     | 69/157 [05:09<06:55,  4.73s/it]Epoch [3/10]:  45%|████▍     | 70/157 [05:14<06:54,  4.77s/it]Epoch [3/10]:  45%|████▌     | 71/157 [05:19<06:53,  4.81s/it]Epoch [3/10]:  46%|████▌     | 72/157 [05:24<06:50,  4.83s/it]Epoch [3/10]:  46%|████▋     | 73/157 [05:29<06:46,  4.84s/it]Epoch [3/10]:  47%|████▋     | 74/157 [05:33<06:20,  4.59s/it]Epoch [3/10]:  48%|████▊     | 75/157 [05:35<05:25,  3.96s/it]Epoch [3/10]:  48%|████▊     | 76/157 [05:40<05:43,  4.25s/it]Epoch [3/10]:  49%|████▉     | 77/157 [05:45<05:55,  4.44s/it]Epoch [3/10]:  50%|████▉     | 78/157 [05:50<06:01,  4.57s/it]Epoch [3/10]:  50%|█████     | 79/157 [05:55<06:03,  4.66s/it]Epoch [3/10]:  51%|█████     | 80/157 [06:00<06:03,  4.72s/it]Epoch [3/10]:  52%|█████▏    | 81/157 [06:04<06:02,  4.77s/it]Epoch [3/10]:  52%|█████▏    | 82/157 [06:09<06:00,  4.80s/it]Epoch [3/10]:  53%|█████▎    | 83/157 [06:14<05:56,  4.82s/it]Epoch [3/10]:  54%|█████▎    | 84/157 [06:19<05:53,  4.84s/it]Epoch [3/10]:  54%|█████▍    | 85/157 [06:23<05:28,  4.56s/it]Epoch [3/10]:  55%|█████▍    | 86/157 [06:25<04:26,  3.75s/it]Epoch [3/10]:  55%|█████▌    | 87/157 [06:30<04:46,  4.09s/it]Epoch [3/10]:  56%|█████▌    | 88/157 [06:35<04:58,  4.33s/it]Epoch [3/10]:  57%|█████▋    | 89/157 [06:40<05:05,  4.50s/it]Epoch [3/10]:  57%|█████▋    | 90/157 [06:44<05:09,  4.61s/it]Epoch [3/10]:  58%|█████▊    | 91/157 [06:49<05:09,  4.69s/it]Epoch [3/10]:  59%|█████▊    | 92/157 [06:54<05:08,  4.75s/it]Epoch [3/10]:  59%|█████▉    | 93/157 [06:59<05:06,  4.79s/it]Epoch [3/10]:  60%|█████▉    | 94/157 [07:04<05:04,  4.83s/it]Epoch [3/10]:  61%|██████    | 95/157 [07:09<05:00,  4.85s/it]Epoch [3/10]:  61%|██████    | 96/157 [07:13<04:42,  4.63s/it]Epoch [3/10]:  62%|██████▏   | 97/157 [07:15<03:47,  3.79s/it]Epoch [3/10]:  62%|██████▏   | 98/157 [07:16<02:53,  2.95s/it]Epoch [3/10]:  63%|██████▎   | 99/157 [07:17<02:23,  2.47s/it]Epoch [3/10]:  64%|██████▎   | 100/157 [07:22<02:56,  3.09s/it]Epoch [3/10]:  64%|██████▍   | 101/157 [07:27<03:23,  3.64s/it]Epoch [3/10]:  65%|██████▍   | 102/157 [07:32<03:41,  4.03s/it]Epoch [3/10]:  66%|██████▌   | 103/157 [07:36<03:52,  4.30s/it]Epoch [3/10]:  66%|██████▌   | 104/157 [07:41<03:57,  4.48s/it]Epoch [3/10]:  67%|██████▋   | 105/157 [07:46<03:59,  4.61s/it]Epoch [3/10]:  68%|██████▊   | 106/157 [07:51<03:59,  4.69s/it]Epoch [3/10]:  68%|██████▊   | 107/157 [07:56<03:57,  4.75s/it]Epoch [3/10]:  69%|██████▉   | 108/157 [08:01<03:54,  4.78s/it]Epoch [3/10]:  69%|██████▉   | 109/157 [08:06<03:51,  4.82s/it]Epoch [3/10]:  70%|███████   | 110/157 [08:10<03:37,  4.63s/it]Epoch [3/10]:  71%|███████   | 111/157 [08:12<02:59,  3.91s/it]Epoch [3/10]:  71%|███████▏  | 112/157 [08:17<03:08,  4.20s/it]Epoch [3/10]:  72%|███████▏  | 113/157 [08:22<03:14,  4.42s/it]Epoch [3/10]:  73%|███████▎  | 114/157 [08:27<03:16,  4.57s/it]Epoch [3/10]:  73%|███████▎  | 115/157 [08:32<03:16,  4.68s/it]Epoch [3/10]:  74%|███████▍  | 116/157 [08:37<03:15,  4.76s/it]Epoch [3/10]:  75%|███████▍  | 117/157 [08:42<03:12,  4.81s/it]Epoch [3/10]:  75%|███████▌  | 118/157 [08:47<03:09,  4.85s/it]Epoch [3/10]:  76%|███████▌  | 119/157 [08:52<03:05,  4.88s/it]Epoch [3/10]:  76%|███████▋  | 120/157 [08:57<03:00,  4.88s/it]Epoch [3/10]:  77%|███████▋  | 121/157 [09:01<02:55,  4.88s/it]Epoch [3/10]:  78%|███████▊  | 122/157 [09:05<02:33,  4.39s/it]Epoch [3/10]:  78%|███████▊  | 123/157 [09:08<02:16,  4.00s/it]Epoch [3/10]:  79%|███████▉  | 124/157 [09:13<02:20,  4.27s/it]Epoch [3/10]:  80%|███████▉  | 125/157 [09:18<02:22,  4.45s/it]Epoch [3/10]:  80%|████████  | 126/157 [09:22<02:22,  4.59s/it]Epoch [3/10]:  81%|████████  | 127/157 [09:27<02:20,  4.68s/it]Epoch [3/10]:  82%|████████▏ | 128/157 [09:32<02:18,  4.76s/it]Epoch [3/10]:  82%|████████▏ | 129/157 [09:37<02:14,  4.81s/it]Epoch [3/10]:  83%|████████▎ | 130/157 [09:42<02:11,  4.85s/it]Epoch [3/10]:  83%|████████▎ | 131/157 [09:47<02:06,  4.88s/it]Epoch [3/10]:  84%|████████▍ | 132/157 [09:52<02:02,  4.89s/it]Epoch [3/10]:  85%|████████▍ | 133/157 [09:56<01:53,  4.73s/it]Epoch [3/10]:  85%|████████▌ | 134/157 [09:59<01:35,  4.14s/it]Epoch [3/10]:  86%|████████▌ | 135/157 [10:03<01:30,  4.13s/it]Epoch [3/10]:  87%|████████▋ | 136/157 [10:08<01:31,  4.36s/it]Epoch [3/10]:  87%|████████▋ | 137/157 [10:13<01:30,  4.51s/it]Epoch [3/10]:  88%|████████▊ | 138/157 [10:18<01:27,  4.62s/it]Epoch [3/10]:  89%|████████▊ | 139/157 [10:23<01:24,  4.71s/it]Epoch [3/10]:  89%|████████▉ | 140/157 [10:28<01:21,  4.78s/it]Epoch [3/10]:  90%|████████▉ | 141/157 [10:33<01:16,  4.80s/it]Epoch [3/10]:  90%|█████████ | 142/157 [10:38<01:12,  4.83s/it]Epoch [3/10]:  91%|█████████ | 143/157 [10:42<01:07,  4.84s/it]Epoch [3/10]:  92%|█████████▏| 144/157 [10:47<01:03,  4.86s/it]Epoch [3/10]:  92%|█████████▏| 145/157 [10:51<00:54,  4.52s/it]Epoch [3/10]:  93%|█████████▎| 146/157 [10:54<00:43,  3.96s/it]Epoch [3/10]:  94%|█████████▎| 147/157 [10:58<00:39,  3.95s/it]Epoch [3/10]:  94%|█████████▍| 148/157 [11:03<00:38,  4.24s/it]Epoch [3/10]:  95%|█████████▍| 149/157 [11:07<00:35,  4.45s/it]Epoch [3/10]:  96%|█████████▌| 150/157 [11:12<00:32,  4.59s/it]Epoch [3/10]:  96%|█████████▌| 151/157 [11:17<00:28,  4.69s/it]Epoch [3/10]:  97%|█████████▋| 152/157 [11:22<00:23,  4.75s/it]Epoch [3/10]:  97%|█████████▋| 153/157 [11:27<00:19,  4.79s/it]Epoch [3/10]:  98%|█████████▊| 154/157 [11:32<00:14,  4.81s/it]Epoch [3/10]:  99%|█████████▊| 155/157 [11:37<00:09,  4.83s/it]Epoch [3/10]:  99%|█████████▉| 156/157 [11:42<00:04,  4.86s/it]Epoch [3/10]: 100%|██████████| 157/157 [11:43<00:00,  3.81s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:05<00:35,  5.09s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:08<00:26,  4.37s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:18<00:33,  6.72s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:27<00:31,  7.81s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:37<00:25,  8.44s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:46<00:17,  8.79s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:56<00:09,  9.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [01:01<00:00,  7.59s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 3 epochs: 0.00%

Epoch [4/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [4/10]:   1%|          | 1/157 [00:06<15:44,  6.05s/it]Epoch [4/10]:   1%|▏         | 2/157 [00:10<13:50,  5.36s/it]Epoch [4/10]:   2%|▏         | 3/157 [00:15<13:10,  5.13s/it]Epoch [4/10]:   3%|▎         | 4/157 [00:20<12:46,  5.01s/it]Epoch [4/10]:   3%|▎         | 5/157 [00:25<12:31,  4.94s/it]Epoch [4/10]:   4%|▍         | 6/157 [00:30<12:21,  4.91s/it]Epoch [4/10]:   4%|▍         | 7/157 [00:35<12:11,  4.88s/it]Epoch [4/10]:   5%|▌         | 8/157 [00:39<12:05,  4.87s/it]Epoch [4/10]:   6%|▌         | 9/157 [00:44<12:00,  4.87s/it]Epoch [4/10]:   6%|▋         | 10/157 [00:49<11:54,  4.86s/it]Epoch [4/10]:   7%|▋         | 11/157 [00:53<11:08,  4.58s/it]Epoch [4/10]:   8%|▊         | 12/157 [00:56<09:32,  3.95s/it]Epoch [4/10]:   8%|▊         | 13/157 [01:00<10:05,  4.21s/it]Epoch [4/10]:   9%|▉         | 14/157 [01:05<10:28,  4.40s/it]Epoch [4/10]:  10%|▉         | 15/157 [01:10<10:44,  4.54s/it]Epoch [4/10]:  10%|█         | 16/157 [01:15<10:51,  4.62s/it]Epoch [4/10]:  11%|█         | 17/157 [01:20<10:55,  4.68s/it]Epoch [4/10]:  11%|█▏        | 18/157 [01:25<10:58,  4.73s/it]Epoch [4/10]:  12%|█▏        | 19/157 [01:29<10:56,  4.76s/it]Epoch [4/10]:  13%|█▎        | 20/157 [01:34<10:55,  4.78s/it]Epoch [4/10]:  13%|█▎        | 21/157 [01:39<10:54,  4.81s/it]Epoch [4/10]:  14%|█▍        | 22/157 [01:44<10:50,  4.82s/it]Epoch [4/10]:  15%|█▍        | 23/157 [01:48<09:57,  4.46s/it]Epoch [4/10]:  15%|█▌        | 24/157 [01:50<08:49,  3.98s/it]Epoch [4/10]:  16%|█▌        | 25/157 [01:55<09:18,  4.23s/it]Epoch [4/10]:  17%|█▋        | 26/157 [02:00<09:37,  4.41s/it]Epoch [4/10]:  17%|█▋        | 27/157 [02:05<09:51,  4.55s/it]Epoch [4/10]:  18%|█▊        | 28/157 [02:10<09:56,  4.63s/it]Epoch [4/10]:  18%|█▊        | 29/157 [02:15<09:59,  4.68s/it]Epoch [4/10]:  19%|█▉        | 30/157 [02:19<10:01,  4.73s/it]Epoch [4/10]:  20%|█▉        | 31/157 [02:24<09:59,  4.76s/it]Epoch [4/10]:  20%|██        | 32/157 [02:29<09:58,  4.79s/it]Epoch [4/10]:  21%|██        | 33/157 [02:34<09:56,  4.81s/it]Epoch [4/10]:  22%|██▏       | 34/157 [02:39<09:52,  4.81s/it]Epoch [4/10]:  22%|██▏       | 35/157 [02:42<08:52,  4.36s/it]Epoch [4/10]:  23%|██▎       | 36/157 [02:45<07:41,  3.81s/it]Epoch [4/10]:  24%|██▎       | 37/157 [02:49<08:14,  4.12s/it]Epoch [4/10]:  24%|██▍       | 38/157 [02:54<08:35,  4.33s/it]Epoch [4/10]:  25%|██▍       | 39/157 [02:59<08:50,  4.49s/it]Epoch [4/10]:  25%|██▌       | 40/157 [03:04<08:57,  4.59s/it]Epoch [4/10]:  26%|██▌       | 41/157 [03:09<09:00,  4.66s/it]Epoch [4/10]:  27%|██▋       | 42/157 [03:14<09:03,  4.73s/it]Epoch [4/10]:  27%|██▋       | 43/157 [03:19<09:01,  4.75s/it]Epoch [4/10]:  28%|██▊       | 44/157 [03:23<08:59,  4.77s/it]Epoch [4/10]:  29%|██▊       | 45/157 [03:28<08:57,  4.80s/it]Epoch [4/10]:  29%|██▉       | 46/157 [03:33<08:53,  4.80s/it]Epoch [4/10]:  30%|██▉       | 47/157 [03:37<08:11,  4.46s/it]Epoch [4/10]:  31%|███       | 48/157 [03:38<06:12,  3.42s/it]Epoch [4/10]:  31%|███       | 49/157 [03:39<04:51,  2.69s/it]Epoch [4/10]:  32%|███▏      | 50/157 [03:43<05:37,  3.16s/it]Epoch [4/10]:  32%|███▏      | 51/157 [03:48<06:31,  3.69s/it]Epoch [4/10]:  33%|███▎      | 52/157 [03:53<07:05,  4.05s/it]Epoch [4/10]:  34%|███▍      | 53/157 [03:58<07:25,  4.28s/it]Epoch [4/10]:  34%|███▍      | 54/157 [04:02<07:38,  4.45s/it]Epoch [4/10]:  35%|███▌      | 55/157 [04:07<07:49,  4.60s/it]Epoch [4/10]:  36%|███▌      | 56/157 [04:12<07:52,  4.68s/it]Epoch [4/10]:  36%|███▋      | 57/157 [04:17<07:51,  4.72s/it]Epoch [4/10]:  37%|███▋      | 58/157 [04:22<07:51,  4.77s/it]Epoch [4/10]:  38%|███▊      | 59/157 [04:27<07:50,  4.80s/it]Epoch [4/10]:  38%|███▊      | 60/157 [04:31<07:14,  4.48s/it]Epoch [4/10]:  39%|███▉      | 61/157 [04:33<06:20,  3.97s/it]Epoch [4/10]:  39%|███▉      | 62/157 [04:37<06:07,  3.87s/it]Epoch [4/10]:  40%|████      | 63/157 [04:42<06:32,  4.17s/it]Epoch [4/10]:  41%|████      | 64/157 [04:47<06:49,  4.40s/it]Epoch [4/10]:  41%|████▏     | 65/157 [04:52<06:58,  4.55s/it]Epoch [4/10]:  42%|████▏     | 66/157 [04:56<07:00,  4.62s/it]Epoch [4/10]:  43%|████▎     | 67/157 [05:01<07:02,  4.70s/it]Epoch [4/10]:  43%|████▎     | 68/157 [05:06<07:03,  4.76s/it]Epoch [4/10]:  44%|████▍     | 69/157 [05:11<07:00,  4.78s/it]Epoch [4/10]:  45%|████▍     | 70/157 [05:16<06:57,  4.80s/it]Epoch [4/10]:  45%|████▌     | 71/157 [05:21<06:55,  4.84s/it]Epoch [4/10]:  46%|████▌     | 72/157 [05:25<06:38,  4.68s/it]Epoch [4/10]:  46%|████▋     | 73/157 [05:28<05:45,  4.12s/it]Epoch [4/10]:  47%|████▋     | 74/157 [05:32<05:39,  4.09s/it]Epoch [4/10]:  48%|████▊     | 75/157 [05:37<05:54,  4.32s/it]Epoch [4/10]:  48%|████▊     | 76/157 [05:42<06:04,  4.50s/it]Epoch [4/10]:  49%|████▉     | 77/157 [05:47<06:09,  4.62s/it]Epoch [4/10]:  50%|████▉     | 78/157 [05:51<06:09,  4.67s/it]Epoch [4/10]:  50%|█████     | 79/157 [05:56<06:08,  4.73s/it]Epoch [4/10]:  51%|█████     | 80/157 [06:01<06:08,  4.79s/it]Epoch [4/10]:  52%|█████▏    | 81/157 [06:06<06:05,  4.81s/it]Epoch [4/10]:  52%|█████▏    | 82/157 [06:11<06:00,  4.81s/it]Epoch [4/10]:  53%|█████▎    | 83/157 [06:16<05:58,  4.84s/it]Epoch [4/10]:  54%|█████▎    | 84/157 [06:20<05:34,  4.58s/it]Epoch [4/10]:  54%|█████▍    | 85/157 [06:23<04:50,  4.03s/it]Epoch [4/10]:  55%|█████▍    | 86/157 [06:27<04:46,  4.04s/it]Epoch [4/10]:  55%|█████▌    | 87/157 [06:31<04:59,  4.28s/it]Epoch [4/10]:  56%|█████▌    | 88/157 [06:36<05:08,  4.47s/it]Epoch [4/10]:  57%|█████▋    | 89/157 [06:41<05:13,  4.61s/it]Epoch [4/10]:  57%|█████▋    | 90/157 [06:46<05:13,  4.68s/it]Epoch [4/10]:  58%|█████▊    | 91/157 [06:51<05:11,  4.72s/it]Epoch [4/10]:  59%|█████▊    | 92/157 [06:56<05:10,  4.78s/it]Epoch [4/10]:  59%|█████▉    | 93/157 [07:01<05:07,  4.80s/it]Epoch [4/10]:  60%|█████▉    | 94/157 [07:06<05:02,  4.81s/it]Epoch [4/10]:  61%|██████    | 95/157 [07:10<04:59,  4.83s/it]Epoch [4/10]:  61%|██████    | 96/157 [07:15<04:43,  4.65s/it]Epoch [4/10]:  62%|██████▏   | 97/157 [07:17<04:00,  4.01s/it]Epoch [4/10]:  62%|██████▏   | 98/157 [07:22<04:08,  4.21s/it]Epoch [4/10]:  63%|██████▎   | 99/157 [07:27<04:15,  4.40s/it]Epoch [4/10]:  64%|██████▎   | 100/157 [07:32<04:20,  4.56s/it]Epoch [4/10]:  64%|██████▍   | 101/157 [07:36<04:21,  4.66s/it]Epoch [4/10]:  65%|██████▍   | 102/157 [07:41<04:19,  4.71s/it]Epoch [4/10]:  66%|██████▌   | 103/157 [07:46<04:16,  4.75s/it]Epoch [4/10]:  66%|██████▌   | 104/157 [07:51<04:14,  4.80s/it]Epoch [4/10]:  67%|██████▋   | 105/157 [07:56<04:11,  4.83s/it]Epoch [4/10]:  68%|██████▊   | 106/157 [08:01<04:06,  4.83s/it]Epoch [4/10]:  68%|██████▊   | 107/157 [08:06<04:01,  4.84s/it]Epoch [4/10]:  69%|██████▉   | 108/157 [08:10<03:48,  4.67s/it]Epoch [4/10]:  69%|██████▉   | 109/157 [08:12<03:02,  3.80s/it]Epoch [4/10]:  70%|███████   | 110/157 [08:13<02:19,  2.96s/it]Epoch [4/10]:  71%|███████   | 111/157 [08:14<01:48,  2.37s/it]Epoch [4/10]:  71%|███████▏  | 112/157 [08:15<01:27,  1.95s/it]Epoch [4/10]:  72%|███████▏  | 113/157 [08:16<01:13,  1.66s/it]Epoch [4/10]:  73%|███████▎  | 114/157 [08:17<01:02,  1.46s/it]Epoch [4/10]:  73%|███████▎  | 115/157 [08:18<00:55,  1.32s/it]Epoch [4/10]:  74%|███████▍  | 116/157 [08:19<00:49,  1.22s/it]Epoch [4/10]:  75%|███████▍  | 117/157 [08:20<00:45,  1.15s/it]Epoch [4/10]:  75%|███████▌  | 118/157 [08:21<00:42,  1.10s/it]Epoch [4/10]:  76%|███████▌  | 119/157 [08:22<00:40,  1.06s/it]Epoch [4/10]:  76%|███████▋  | 120/157 [08:23<00:38,  1.04s/it]Epoch [4/10]:  77%|███████▋  | 121/157 [08:24<00:36,  1.02s/it]Epoch [4/10]:  78%|███████▊  | 122/157 [08:25<00:35,  1.01s/it]Epoch [4/10]:  78%|███████▊  | 123/157 [08:25<00:34,  1.00s/it]Epoch [4/10]:  79%|███████▉  | 124/157 [08:26<00:32,  1.00it/s]Epoch [4/10]:  80%|███████▉  | 125/157 [08:27<00:31,  1.01it/s]Epoch [4/10]:  80%|████████  | 126/157 [08:28<00:30,  1.01it/s]Epoch [4/10]:  81%|████████  | 127/157 [08:29<00:29,  1.02it/s]Epoch [4/10]:  82%|████████▏ | 128/157 [08:30<00:28,  1.02it/s]Epoch [4/10]:  82%|████████▏ | 129/157 [08:31<00:27,  1.02it/s]Epoch [4/10]:  83%|████████▎ | 130/157 [08:32<00:26,  1.02it/s]Epoch [4/10]:  83%|████████▎ | 131/157 [08:33<00:25,  1.02it/s]Epoch [4/10]:  84%|████████▍ | 132/157 [08:34<00:24,  1.02it/s]Epoch [4/10]:  85%|████████▍ | 133/157 [08:35<00:23,  1.02it/s]Epoch [4/10]:  85%|████████▌ | 134/157 [08:36<00:22,  1.02it/s]Epoch [4/10]:  86%|████████▌ | 135/157 [08:37<00:21,  1.02it/s]Epoch [4/10]:  87%|████████▋ | 136/157 [08:38<00:20,  1.02it/s]Epoch [4/10]:  87%|████████▋ | 137/157 [08:39<00:19,  1.02it/s]Epoch [4/10]:  88%|████████▊ | 138/157 [08:40<00:18,  1.02it/s]Epoch [4/10]:  89%|████████▊ | 139/157 [08:41<00:17,  1.02it/s]Epoch [4/10]:  89%|████████▉ | 140/157 [08:42<00:16,  1.02it/s]Epoch [4/10]:  90%|████████▉ | 141/157 [08:43<00:15,  1.02it/s]Epoch [4/10]:  90%|█████████ | 142/157 [08:44<00:14,  1.02it/s]Epoch [4/10]:  91%|█████████ | 143/157 [08:45<00:13,  1.02it/s]Epoch [4/10]:  92%|█████████▏| 144/157 [08:46<00:12,  1.02it/s]Epoch [4/10]:  92%|█████████▏| 145/157 [08:47<00:11,  1.02it/s]Epoch [4/10]:  93%|█████████▎| 146/157 [08:48<00:10,  1.02it/s]Epoch [4/10]:  94%|█████████▎| 147/157 [08:49<00:09,  1.02it/s]Epoch [4/10]:  94%|█████████▍| 148/157 [08:50<00:08,  1.02it/s]Epoch [4/10]:  95%|█████████▍| 149/157 [08:51<00:07,  1.02it/s]Epoch [4/10]:  96%|█████████▌| 150/157 [08:52<00:06,  1.02it/s]Epoch [4/10]:  96%|█████████▌| 151/157 [08:53<00:05,  1.02it/s]Epoch [4/10]:  97%|█████████▋| 152/157 [08:54<00:04,  1.02it/s]Epoch [4/10]:  97%|█████████▋| 153/157 [08:55<00:03,  1.02it/s]Epoch [4/10]:  98%|█████████▊| 154/157 [08:56<00:02,  1.02it/s]Epoch [4/10]:  99%|█████████▊| 155/157 [08:57<00:01,  1.02it/s]Epoch [4/10]:  99%|█████████▉| 156/157 [08:58<00:00,  1.02it/s]Epoch [4/10]: 100%|██████████| 157/157 [08:58<00:00,  1.30it/s]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.40s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.56s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.28s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.15s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.07s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.03s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:15<00:01,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.86s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 4 epochs: 0.00%

Epoch [5/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [5/10]:   1%|          | 1/157 [00:02<05:45,  2.21s/it]Epoch [5/10]:   1%|▏         | 2/157 [00:03<03:49,  1.48s/it]Epoch [5/10]:   2%|▏         | 3/157 [00:04<03:12,  1.25s/it]Epoch [5/10]:   3%|▎         | 4/157 [00:05<02:55,  1.14s/it]Epoch [5/10]:   3%|▎         | 5/157 [00:06<02:45,  1.09s/it]Epoch [5/10]:   4%|▍         | 6/157 [00:07<02:38,  1.05s/it]Epoch [5/10]:   4%|▍         | 7/157 [00:08<02:33,  1.03s/it]Epoch [5/10]:   5%|▌         | 8/157 [00:09<02:30,  1.01s/it]Epoch [5/10]:   6%|▌         | 9/157 [00:10<02:28,  1.00s/it]Epoch [5/10]:   6%|▋         | 10/157 [00:11<02:26,  1.01it/s]Epoch [5/10]:   7%|▋         | 11/157 [00:11<02:24,  1.01it/s]Epoch [5/10]:   8%|▊         | 12/157 [00:12<02:23,  1.01it/s]Epoch [5/10]:   8%|▊         | 13/157 [00:13<02:21,  1.02it/s]Epoch [5/10]:   9%|▉         | 14/157 [00:14<02:21,  1.01it/s]Epoch [5/10]:  10%|▉         | 15/157 [00:15<02:20,  1.01it/s]Epoch [5/10]:  10%|█         | 16/157 [00:16<02:19,  1.01it/s]Epoch [5/10]:  11%|█         | 17/157 [00:17<02:18,  1.01it/s]Epoch [5/10]:  11%|█▏        | 18/157 [00:18<02:16,  1.02it/s]Epoch [5/10]:  12%|█▏        | 19/157 [00:19<02:15,  1.02it/s]Epoch [5/10]:  13%|█▎        | 20/157 [00:20<02:14,  1.02it/s]Epoch [5/10]:  13%|█▎        | 21/157 [00:21<02:13,  1.02it/s]Epoch [5/10]:  14%|█▍        | 22/157 [00:22<02:12,  1.02it/s]Epoch [5/10]:  15%|█▍        | 23/157 [00:23<02:11,  1.02it/s]Epoch [5/10]:  15%|█▌        | 24/157 [00:24<02:10,  1.02it/s]Epoch [5/10]:  16%|█▌        | 25/157 [00:25<02:09,  1.02it/s]Epoch [5/10]:  17%|█▋        | 26/157 [00:26<02:09,  1.01it/s]Epoch [5/10]:  17%|█▋        | 27/157 [00:27<02:08,  1.01it/s]Epoch [5/10]:  18%|█▊        | 28/157 [00:28<02:08,  1.01it/s]Epoch [5/10]:  18%|█▊        | 29/157 [00:29<02:07,  1.01it/s]Epoch [5/10]:  19%|█▉        | 30/157 [00:30<02:06,  1.01it/s]Epoch [5/10]:  20%|█▉        | 31/157 [00:31<02:05,  1.01it/s]Epoch [5/10]:  20%|██        | 32/157 [00:32<02:03,  1.01it/s]Epoch [5/10]:  21%|██        | 33/157 [00:33<02:02,  1.01it/s]Epoch [5/10]:  22%|██▏       | 34/157 [00:34<02:01,  1.01it/s]Epoch [5/10]:  22%|██▏       | 35/157 [00:35<02:00,  1.01it/s]Epoch [5/10]:  23%|██▎       | 36/157 [00:36<01:59,  1.01it/s]Epoch [5/10]:  24%|██▎       | 37/157 [00:37<01:58,  1.01it/s]Epoch [5/10]:  24%|██▍       | 38/157 [00:38<01:57,  1.01it/s]Epoch [5/10]:  25%|██▍       | 39/157 [00:39<01:56,  1.01it/s]Epoch [5/10]:  25%|██▌       | 40/157 [00:40<01:55,  1.01it/s]Epoch [5/10]:  26%|██▌       | 41/157 [00:41<01:54,  1.02it/s]Epoch [5/10]:  27%|██▋       | 42/157 [00:42<01:53,  1.01it/s]Epoch [5/10]:  27%|██▋       | 43/157 [00:43<01:52,  1.01it/s]Epoch [5/10]:  28%|██▊       | 44/157 [00:44<01:51,  1.02it/s]Epoch [5/10]:  29%|██▊       | 45/157 [00:45<01:50,  1.01it/s]Epoch [5/10]:  29%|██▉       | 46/157 [00:46<01:49,  1.01it/s]Epoch [5/10]:  30%|██▉       | 47/157 [00:47<01:48,  1.01it/s]Epoch [5/10]:  31%|███       | 48/157 [00:48<01:47,  1.01it/s]Epoch [5/10]:  31%|███       | 49/157 [00:49<01:46,  1.01it/s]Epoch [5/10]:  32%|███▏      | 50/157 [00:50<01:45,  1.01it/s]Epoch [5/10]:  32%|███▏      | 51/157 [00:51<01:44,  1.01it/s]Epoch [5/10]:  33%|███▎      | 52/157 [00:52<01:43,  1.01it/s]Epoch [5/10]:  34%|███▍      | 53/157 [00:53<01:42,  1.01it/s]Epoch [5/10]:  34%|███▍      | 54/157 [00:54<01:41,  1.01it/s]Epoch [5/10]:  35%|███▌      | 55/157 [00:55<01:40,  1.01it/s]Epoch [5/10]:  36%|███▌      | 56/157 [00:56<01:39,  1.01it/s]Epoch [5/10]:  36%|███▋      | 57/157 [00:57<01:38,  1.01it/s]Epoch [5/10]:  37%|███▋      | 58/157 [00:58<01:37,  1.01it/s]Epoch [5/10]:  38%|███▊      | 59/157 [00:59<01:36,  1.01it/s]Epoch [5/10]:  38%|███▊      | 60/157 [01:00<01:35,  1.01it/s]Epoch [5/10]:  39%|███▉      | 61/157 [01:01<01:34,  1.01it/s]Epoch [5/10]:  39%|███▉      | 62/157 [01:02<01:33,  1.01it/s]Epoch [5/10]:  40%|████      | 63/157 [01:03<01:32,  1.01it/s]Epoch [5/10]:  41%|████      | 64/157 [01:04<01:31,  1.01it/s]Epoch [5/10]:  41%|████▏     | 65/157 [01:05<01:30,  1.02it/s]Epoch [5/10]:  42%|████▏     | 66/157 [01:06<01:29,  1.01it/s]Epoch [5/10]:  43%|████▎     | 67/157 [01:07<01:28,  1.01it/s]Epoch [5/10]:  43%|████▎     | 68/157 [01:08<01:27,  1.02it/s]Epoch [5/10]:  44%|████▍     | 69/157 [01:09<01:26,  1.01it/s]Epoch [5/10]:  45%|████▍     | 70/157 [01:10<01:25,  1.01it/s]Epoch [5/10]:  45%|████▌     | 71/157 [01:11<01:24,  1.01it/s]Epoch [5/10]:  46%|████▌     | 72/157 [01:12<01:23,  1.01it/s]Epoch [5/10]:  46%|████▋     | 73/157 [01:13<01:22,  1.01it/s]Epoch [5/10]:  47%|████▋     | 74/157 [01:14<01:21,  1.01it/s]Epoch [5/10]:  48%|████▊     | 75/157 [01:15<01:20,  1.01it/s]Epoch [5/10]:  48%|████▊     | 76/157 [01:16<01:19,  1.01it/s]Epoch [5/10]:  49%|████▉     | 77/157 [01:17<01:19,  1.01it/s]Epoch [5/10]:  50%|████▉     | 78/157 [01:18<01:18,  1.01it/s]Epoch [5/10]:  50%|█████     | 79/157 [01:19<01:17,  1.01it/s]Epoch [5/10]:  51%|█████     | 80/157 [01:20<01:16,  1.01it/s]Epoch [5/10]:  52%|█████▏    | 81/157 [01:21<01:15,  1.01it/s]Epoch [5/10]:  52%|█████▏    | 82/157 [01:22<01:14,  1.01it/s]Epoch [5/10]:  53%|█████▎    | 83/157 [01:23<01:13,  1.01it/s]Epoch [5/10]:  54%|█████▎    | 84/157 [01:24<01:12,  1.01it/s]Epoch [5/10]:  54%|█████▍    | 85/157 [01:25<01:11,  1.01it/s]Epoch [5/10]:  55%|█████▍    | 86/157 [01:26<01:09,  1.02it/s]Epoch [5/10]:  55%|█████▌    | 87/157 [01:26<01:09,  1.01it/s]Epoch [5/10]:  56%|█████▌    | 88/157 [01:27<01:08,  1.01it/s]Epoch [5/10]:  57%|█████▋    | 89/157 [01:28<01:06,  1.02it/s]Epoch [5/10]:  57%|█████▋    | 90/157 [01:29<01:05,  1.02it/s]Epoch [5/10]:  58%|█████▊    | 91/157 [01:30<01:04,  1.02it/s]Epoch [5/10]:  59%|█████▊    | 92/157 [01:31<01:03,  1.02it/s]Epoch [5/10]:  59%|█████▉    | 93/157 [01:32<01:02,  1.02it/s]Epoch [5/10]:  60%|█████▉    | 94/157 [01:33<01:02,  1.02it/s]Epoch [5/10]:  61%|██████    | 95/157 [01:34<01:00,  1.02it/s]Epoch [5/10]:  61%|██████    | 96/157 [01:35<01:00,  1.02it/s]Epoch [5/10]:  62%|██████▏   | 97/157 [01:36<00:59,  1.02it/s]Epoch [5/10]:  62%|██████▏   | 98/157 [01:37<00:58,  1.02it/s]Epoch [5/10]:  63%|██████▎   | 99/157 [01:38<00:57,  1.02it/s]Epoch [5/10]:  64%|██████▎   | 100/157 [01:39<00:56,  1.02it/s]Epoch [5/10]:  64%|██████▍   | 101/157 [01:40<00:55,  1.01it/s]Epoch [5/10]:  65%|██████▍   | 102/157 [01:41<00:54,  1.02it/s]Epoch [5/10]:  66%|██████▌   | 103/157 [01:42<00:53,  1.02it/s]Epoch [5/10]:  66%|██████▌   | 104/157 [01:43<00:52,  1.02it/s]Epoch [5/10]:  67%|██████▋   | 105/157 [01:44<00:51,  1.02it/s]Epoch [5/10]:  68%|██████▊   | 106/157 [01:45<00:50,  1.02it/s]Epoch [5/10]:  68%|██████▊   | 107/157 [01:46<00:49,  1.02it/s]Epoch [5/10]:  69%|██████▉   | 108/157 [01:47<00:48,  1.02it/s]Epoch [5/10]:  69%|██████▉   | 109/157 [01:48<00:47,  1.01it/s]Epoch [5/10]:  70%|███████   | 110/157 [01:49<00:46,  1.02it/s]Epoch [5/10]:  71%|███████   | 111/157 [01:50<00:45,  1.02it/s]Epoch [5/10]:  71%|███████▏  | 112/157 [01:51<00:44,  1.02it/s]Epoch [5/10]:  72%|███████▏  | 113/157 [01:52<00:43,  1.02it/s]Epoch [5/10]:  73%|███████▎  | 114/157 [01:53<00:42,  1.02it/s]Epoch [5/10]:  73%|███████▎  | 115/157 [01:54<00:41,  1.02it/s]Epoch [5/10]:  74%|███████▍  | 116/157 [01:55<00:40,  1.02it/s]Epoch [5/10]:  75%|███████▍  | 117/157 [01:56<00:39,  1.02it/s]Epoch [5/10]:  75%|███████▌  | 118/157 [01:57<00:38,  1.02it/s]Epoch [5/10]:  76%|███████▌  | 119/157 [01:58<00:37,  1.02it/s]Epoch [5/10]:  76%|███████▋  | 120/157 [01:59<00:36,  1.02it/s]Epoch [5/10]:  77%|███████▋  | 121/157 [02:00<00:35,  1.02it/s]Epoch [5/10]:  78%|███████▊  | 122/157 [02:01<00:34,  1.02it/s]Epoch [5/10]:  78%|███████▊  | 123/157 [02:02<00:33,  1.02it/s]Epoch [5/10]:  79%|███████▉  | 124/157 [02:03<00:32,  1.02it/s]Epoch [5/10]:  80%|███████▉  | 125/157 [02:04<00:31,  1.02it/s]Epoch [5/10]:  80%|████████  | 126/157 [02:05<00:30,  1.02it/s]Epoch [5/10]:  81%|████████  | 127/157 [02:06<00:29,  1.02it/s]Epoch [5/10]:  82%|████████▏ | 128/157 [02:07<00:28,  1.02it/s]Epoch [5/10]:  82%|████████▏ | 129/157 [02:08<00:27,  1.02it/s]Epoch [5/10]:  83%|████████▎ | 130/157 [02:09<00:26,  1.03it/s]Epoch [5/10]:  83%|████████▎ | 131/157 [02:10<00:25,  1.03it/s]Epoch [5/10]:  84%|████████▍ | 132/157 [02:11<00:24,  1.03it/s]Epoch [5/10]:  85%|████████▍ | 133/157 [02:12<00:23,  1.03it/s]Epoch [5/10]:  85%|████████▌ | 134/157 [02:13<00:22,  1.03it/s]Epoch [5/10]:  86%|████████▌ | 135/157 [02:14<00:21,  1.03it/s]Epoch [5/10]:  87%|████████▋ | 136/157 [02:15<00:20,  1.03it/s]Epoch [5/10]:  87%|████████▋ | 137/157 [02:16<00:19,  1.03it/s]Epoch [5/10]:  88%|████████▊ | 138/157 [02:16<00:18,  1.03it/s]Epoch [5/10]:  89%|████████▊ | 139/157 [02:17<00:17,  1.03it/s]Epoch [5/10]:  89%|████████▉ | 140/157 [02:18<00:16,  1.03it/s]Epoch [5/10]:  90%|████████▉ | 141/157 [02:19<00:15,  1.03it/s]Epoch [5/10]:  90%|█████████ | 142/157 [02:20<00:14,  1.03it/s]Epoch [5/10]:  91%|█████████ | 143/157 [02:21<00:13,  1.03it/s]Epoch [5/10]:  92%|█████████▏| 144/157 [02:22<00:12,  1.03it/s]Epoch [5/10]:  92%|█████████▏| 145/157 [02:23<00:11,  1.02it/s]Epoch [5/10]:  93%|█████████▎| 146/157 [02:24<00:10,  1.03it/s]Epoch [5/10]:  94%|█████████▎| 147/157 [02:25<00:09,  1.03it/s]Epoch [5/10]:  94%|█████████▍| 148/157 [02:26<00:08,  1.03it/s]Epoch [5/10]:  95%|█████████▍| 149/157 [02:27<00:07,  1.03it/s]Epoch [5/10]:  96%|█████████▌| 150/157 [02:28<00:06,  1.03it/s]Epoch [5/10]:  96%|█████████▌| 151/157 [02:29<00:05,  1.03it/s]Epoch [5/10]:  97%|█████████▋| 152/157 [02:30<00:04,  1.03it/s]Epoch [5/10]:  97%|█████████▋| 153/157 [02:31<00:03,  1.03it/s]Epoch [5/10]:  98%|█████████▊| 154/157 [02:32<00:02,  1.02it/s]Epoch [5/10]:  99%|█████████▊| 155/157 [02:33<00:01,  1.02it/s]Epoch [5/10]:  99%|█████████▉| 156/157 [02:34<00:00,  1.03it/s]Epoch [5/10]: 100%|██████████| 157/157 [02:34<00:00,  1.31it/s]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.31s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.50s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.23s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.11s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:04,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.98s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 5 epochs: 0.00%

Epoch [6/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [6/10]:   1%|          | 1/157 [00:02<05:58,  2.30s/it]Epoch [6/10]:   1%|▏         | 2/157 [00:03<03:58,  1.54s/it]Epoch [6/10]:   2%|▏         | 3/157 [00:04<03:17,  1.29s/it]Epoch [6/10]:   3%|▎         | 4/157 [00:05<02:58,  1.16s/it]Epoch [6/10]:   3%|▎         | 5/157 [00:06<02:46,  1.10s/it]Epoch [6/10]:   4%|▍         | 6/157 [00:07<02:39,  1.06s/it]Epoch [6/10]:   4%|▍         | 7/157 [00:08<02:34,  1.03s/it]Epoch [6/10]:   5%|▌         | 8/157 [00:09<02:31,  1.01s/it]Epoch [6/10]:   6%|▌         | 9/157 [00:10<02:28,  1.00s/it]Epoch [6/10]:   6%|▋         | 10/157 [00:11<02:26,  1.00it/s]Epoch [6/10]:   7%|▋         | 11/157 [00:12<02:24,  1.01it/s]Epoch [6/10]:   8%|▊         | 12/157 [00:13<02:23,  1.01it/s]Epoch [6/10]:   8%|▊         | 13/157 [00:14<02:21,  1.02it/s]Epoch [6/10]:   9%|▉         | 14/157 [00:15<02:20,  1.02it/s]Epoch [6/10]:  10%|▉         | 15/157 [00:16<02:19,  1.02it/s]Epoch [6/10]:  10%|█         | 16/157 [00:16<02:17,  1.02it/s]Epoch [6/10]:  11%|█         | 17/157 [00:17<02:16,  1.02it/s]Epoch [6/10]:  11%|█▏        | 18/157 [00:18<02:16,  1.02it/s]Epoch [6/10]:  12%|█▏        | 19/157 [00:19<02:15,  1.02it/s]Epoch [6/10]:  13%|█▎        | 20/157 [00:20<02:14,  1.02it/s]Epoch [6/10]:  13%|█▎        | 21/157 [00:21<02:13,  1.02it/s]Epoch [6/10]:  14%|█▍        | 22/157 [00:22<02:12,  1.02it/s]Epoch [6/10]:  15%|█▍        | 23/157 [00:23<02:11,  1.02it/s]Epoch [6/10]:  15%|█▌        | 24/157 [00:24<02:10,  1.02it/s]Epoch [6/10]:  16%|█▌        | 25/157 [00:25<02:09,  1.02it/s]Epoch [6/10]:  17%|█▋        | 26/157 [00:26<02:08,  1.02it/s]Epoch [6/10]:  17%|█▋        | 27/157 [00:27<02:07,  1.02it/s]Epoch [6/10]:  18%|█▊        | 28/157 [00:28<02:06,  1.02it/s]Epoch [6/10]:  18%|█▊        | 29/157 [00:29<02:05,  1.02it/s]Epoch [6/10]:  19%|█▉        | 30/157 [00:30<02:04,  1.02it/s]Epoch [6/10]:  20%|█▉        | 31/157 [00:31<02:03,  1.02it/s]Epoch [6/10]:  20%|██        | 32/157 [00:32<02:02,  1.02it/s]Epoch [6/10]:  21%|██        | 33/157 [00:33<02:01,  1.02it/s]Epoch [6/10]:  22%|██▏       | 34/157 [00:34<02:00,  1.02it/s]Epoch [6/10]:  22%|██▏       | 35/157 [00:35<01:59,  1.02it/s]Epoch [6/10]:  23%|██▎       | 36/157 [00:36<01:58,  1.02it/s]Epoch [6/10]:  24%|██▎       | 37/157 [00:37<01:57,  1.02it/s]Epoch [6/10]:  24%|██▍       | 38/157 [00:38<01:56,  1.02it/s]Epoch [6/10]:  25%|██▍       | 39/157 [00:39<01:55,  1.02it/s]Epoch [6/10]:  25%|██▌       | 40/157 [00:40<01:54,  1.02it/s]Epoch [6/10]:  26%|██▌       | 41/157 [00:41<01:53,  1.02it/s]Epoch [6/10]:  27%|██▋       | 42/157 [00:42<01:52,  1.02it/s]Epoch [6/10]:  27%|██▋       | 43/157 [00:43<01:51,  1.02it/s]Epoch [6/10]:  28%|██▊       | 44/157 [00:44<01:50,  1.02it/s]Epoch [6/10]:  29%|██▊       | 45/157 [00:45<01:49,  1.02it/s]Epoch [6/10]:  29%|██▉       | 46/157 [00:46<01:48,  1.02it/s]Epoch [6/10]:  30%|██▉       | 47/157 [00:47<01:47,  1.02it/s]Epoch [6/10]:  31%|███       | 48/157 [00:48<01:46,  1.02it/s]Epoch [6/10]:  31%|███       | 49/157 [00:49<01:45,  1.02it/s]Epoch [6/10]:  32%|███▏      | 50/157 [00:50<01:44,  1.02it/s]Epoch [6/10]:  32%|███▏      | 51/157 [00:51<01:43,  1.02it/s]Epoch [6/10]:  33%|███▎      | 52/157 [00:52<01:42,  1.02it/s]Epoch [6/10]:  34%|███▍      | 53/157 [00:53<01:41,  1.02it/s]Epoch [6/10]:  34%|███▍      | 54/157 [00:54<01:40,  1.02it/s]Epoch [6/10]:  35%|███▌      | 55/157 [00:55<01:39,  1.02it/s]Epoch [6/10]:  36%|███▌      | 56/157 [00:56<01:38,  1.02it/s]Epoch [6/10]:  36%|███▋      | 57/157 [00:57<01:37,  1.02it/s]Epoch [6/10]:  37%|███▋      | 58/157 [00:58<01:36,  1.02it/s]Epoch [6/10]:  38%|███▊      | 59/157 [00:59<01:36,  1.02it/s]Epoch [6/10]:  38%|███▊      | 60/157 [01:00<01:35,  1.02it/s]Epoch [6/10]:  39%|███▉      | 61/157 [01:01<01:34,  1.02it/s]Epoch [6/10]:  39%|███▉      | 62/157 [01:02<01:33,  1.02it/s]Epoch [6/10]:  40%|████      | 63/157 [01:03<01:32,  1.02it/s]Epoch [6/10]:  41%|████      | 64/157 [01:04<01:31,  1.02it/s]Epoch [6/10]:  41%|████▏     | 65/157 [01:05<01:30,  1.02it/s]Epoch [6/10]:  42%|████▏     | 66/157 [01:06<01:29,  1.02it/s]Epoch [6/10]:  43%|████▎     | 67/157 [01:07<01:28,  1.02it/s]Epoch [6/10]:  43%|████▎     | 68/157 [01:07<01:27,  1.02it/s]Epoch [6/10]:  44%|████▍     | 69/157 [01:08<01:26,  1.02it/s]Epoch [6/10]:  45%|████▍     | 70/157 [01:09<01:25,  1.02it/s]Epoch [6/10]:  45%|████▌     | 71/157 [01:10<01:24,  1.02it/s]Epoch [6/10]:  46%|████▌     | 72/157 [01:11<01:23,  1.02it/s]Epoch [6/10]:  46%|████▋     | 73/157 [01:12<01:22,  1.02it/s]Epoch [6/10]:  47%|████▋     | 74/157 [01:13<01:21,  1.02it/s]Epoch [6/10]:  48%|████▊     | 75/157 [01:14<01:20,  1.02it/s]Epoch [6/10]:  48%|████▊     | 76/157 [01:15<01:19,  1.02it/s]Epoch [6/10]:  49%|████▉     | 77/157 [01:16<01:18,  1.02it/s]Epoch [6/10]:  50%|████▉     | 78/157 [01:17<01:17,  1.02it/s]Epoch [6/10]:  50%|█████     | 79/157 [01:18<01:16,  1.02it/s]Epoch [6/10]:  51%|█████     | 80/157 [01:19<01:15,  1.02it/s]Epoch [6/10]:  52%|█████▏    | 81/157 [01:20<01:14,  1.02it/s]Epoch [6/10]:  52%|█████▏    | 82/157 [01:21<01:13,  1.02it/s]Epoch [6/10]:  53%|█████▎    | 83/157 [01:22<01:12,  1.02it/s]Epoch [6/10]:  54%|█████▎    | 84/157 [01:23<01:11,  1.02it/s]Epoch [6/10]:  54%|█████▍    | 85/157 [01:24<01:10,  1.02it/s]Epoch [6/10]:  55%|█████▍    | 86/157 [01:25<01:09,  1.02it/s]Epoch [6/10]:  55%|█████▌    | 87/157 [01:26<01:08,  1.02it/s]Epoch [6/10]:  56%|█████▌    | 88/157 [01:27<01:07,  1.02it/s]Epoch [6/10]:  57%|█████▋    | 89/157 [01:28<01:06,  1.02it/s]Epoch [6/10]:  57%|█████▋    | 90/157 [01:29<01:05,  1.02it/s]Epoch [6/10]:  58%|█████▊    | 91/157 [01:30<01:04,  1.02it/s]Epoch [6/10]:  59%|█████▊    | 92/157 [01:31<01:03,  1.02it/s]Epoch [6/10]:  59%|█████▉    | 93/157 [01:32<01:02,  1.02it/s]Epoch [6/10]:  60%|█████▉    | 94/157 [01:33<01:01,  1.02it/s]Epoch [6/10]:  61%|██████    | 95/157 [01:34<01:00,  1.02it/s]Epoch [6/10]:  61%|██████    | 96/157 [01:35<00:59,  1.02it/s]Epoch [6/10]:  62%|██████▏   | 97/157 [01:36<00:58,  1.02it/s]Epoch [6/10]:  62%|██████▏   | 98/157 [01:37<00:57,  1.02it/s]Epoch [6/10]:  63%|██████▎   | 99/157 [01:38<00:56,  1.02it/s]Epoch [6/10]:  64%|██████▎   | 100/157 [01:39<00:55,  1.02it/s]Epoch [6/10]:  64%|██████▍   | 101/157 [01:40<00:54,  1.02it/s]Epoch [6/10]:  65%|██████▍   | 102/157 [01:41<00:53,  1.02it/s]Epoch [6/10]:  66%|██████▌   | 103/157 [01:42<00:52,  1.02it/s]Epoch [6/10]:  66%|██████▌   | 104/157 [01:43<00:51,  1.02it/s]Epoch [6/10]:  67%|██████▋   | 105/157 [01:44<00:50,  1.02it/s]Epoch [6/10]:  68%|██████▊   | 106/157 [01:45<00:49,  1.02it/s]Epoch [6/10]:  68%|██████▊   | 107/157 [01:46<00:49,  1.02it/s]Epoch [6/10]:  69%|██████▉   | 108/157 [01:47<00:47,  1.02it/s]Epoch [6/10]:  69%|██████▉   | 109/157 [01:48<00:46,  1.02it/s]Epoch [6/10]:  70%|███████   | 110/157 [01:49<00:46,  1.02it/s]Epoch [6/10]:  71%|███████   | 111/157 [01:50<00:45,  1.02it/s]Epoch [6/10]:  71%|███████▏  | 112/157 [01:51<00:44,  1.02it/s]Epoch [6/10]:  72%|███████▏  | 113/157 [01:52<00:43,  1.02it/s]Epoch [6/10]:  73%|███████▎  | 114/157 [01:53<00:42,  1.02it/s]Epoch [6/10]:  73%|███████▎  | 115/157 [01:54<00:41,  1.02it/s]Epoch [6/10]:  74%|███████▍  | 116/157 [01:55<00:40,  1.02it/s]Epoch [6/10]:  75%|███████▍  | 117/157 [01:56<00:39,  1.02it/s]Epoch [6/10]:  75%|███████▌  | 118/157 [01:57<00:38,  1.02it/s]Epoch [6/10]:  76%|███████▌  | 119/157 [01:58<00:37,  1.02it/s]Epoch [6/10]:  76%|███████▋  | 120/157 [01:58<00:36,  1.02it/s]Epoch [6/10]:  77%|███████▋  | 121/157 [01:59<00:35,  1.02it/s]Epoch [6/10]:  78%|███████▊  | 122/157 [02:00<00:34,  1.02it/s]Epoch [6/10]:  78%|███████▊  | 123/157 [02:01<00:33,  1.02it/s]Epoch [6/10]:  79%|███████▉  | 124/157 [02:02<00:32,  1.02it/s]Epoch [6/10]:  80%|███████▉  | 125/157 [02:03<00:31,  1.02it/s]Epoch [6/10]:  80%|████████  | 126/157 [02:04<00:30,  1.02it/s]Epoch [6/10]:  81%|████████  | 127/157 [02:05<00:29,  1.02it/s]Epoch [6/10]:  82%|████████▏ | 128/157 [02:06<00:28,  1.02it/s]Epoch [6/10]:  82%|████████▏ | 129/157 [02:07<00:27,  1.02it/s]Epoch [6/10]:  83%|████████▎ | 130/157 [02:08<00:26,  1.02it/s]Epoch [6/10]:  83%|████████▎ | 131/157 [02:09<00:25,  1.02it/s]Epoch [6/10]:  84%|████████▍ | 132/157 [02:10<00:24,  1.02it/s]Epoch [6/10]:  85%|████████▍ | 133/157 [02:11<00:23,  1.02it/s]Epoch [6/10]:  85%|████████▌ | 134/157 [02:12<00:22,  1.02it/s]Epoch [6/10]:  86%|████████▌ | 135/157 [02:13<00:21,  1.02it/s]Epoch [6/10]:  87%|████████▋ | 136/157 [02:14<00:20,  1.02it/s]Epoch [6/10]:  87%|████████▋ | 137/157 [02:15<00:19,  1.02it/s]Epoch [6/10]:  88%|████████▊ | 138/157 [02:16<00:18,  1.02it/s]Epoch [6/10]:  89%|████████▊ | 139/157 [02:17<00:17,  1.02it/s]Epoch [6/10]:  89%|████████▉ | 140/157 [02:18<00:16,  1.02it/s]Epoch [6/10]:  90%|████████▉ | 141/157 [02:19<00:15,  1.02it/s]Epoch [6/10]:  90%|█████████ | 142/157 [02:20<00:14,  1.02it/s]Epoch [6/10]:  91%|█████████ | 143/157 [02:21<00:13,  1.03it/s]Epoch [6/10]:  92%|█████████▏| 144/157 [02:22<00:12,  1.03it/s]Epoch [6/10]:  92%|█████████▏| 145/157 [02:23<00:11,  1.02it/s]Epoch [6/10]:  93%|█████████▎| 146/157 [02:24<00:10,  1.02it/s]Epoch [6/10]:  94%|█████████▎| 147/157 [02:25<00:09,  1.02it/s]Epoch [6/10]:  94%|█████████▍| 148/157 [02:26<00:08,  1.03it/s]Epoch [6/10]:  95%|█████████▍| 149/157 [02:27<00:07,  1.03it/s]Epoch [6/10]:  96%|█████████▌| 150/157 [02:28<00:06,  1.03it/s]Epoch [6/10]:  96%|█████████▌| 151/157 [02:29<00:05,  1.02it/s]Epoch [6/10]:  97%|█████████▋| 152/157 [02:30<00:04,  1.02it/s]Epoch [6/10]:  97%|█████████▋| 153/157 [02:31<00:03,  1.02it/s]Epoch [6/10]:  98%|█████████▊| 154/157 [02:32<00:02,  1.02it/s]Epoch [6/10]:  99%|█████████▊| 155/157 [02:33<00:01,  1.02it/s]Epoch [6/10]:  99%|█████████▉| 156/157 [02:34<00:00,  1.02it/s]Epoch [6/10]: 100%|██████████| 157/157 [02:34<00:00,  1.30it/s]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.41s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.53s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.25s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.12s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:03,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.97s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.84s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 6 epochs: 0.00%

Epoch [7/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [7/10]:   1%|          | 1/157 [00:02<06:10,  2.37s/it]Epoch [7/10]:   1%|▏         | 2/157 [00:03<04:00,  1.55s/it]Epoch [7/10]:   2%|▏         | 3/157 [00:04<03:18,  1.29s/it]Epoch [7/10]:   3%|▎         | 4/157 [00:05<02:58,  1.17s/it]Epoch [7/10]:   3%|▎         | 5/157 [00:06<02:47,  1.10s/it]Epoch [7/10]:   4%|▍         | 6/157 [00:07<02:39,  1.06s/it]Epoch [7/10]:   4%|▍         | 7/157 [00:08<02:34,  1.03s/it]Epoch [7/10]:   5%|▌         | 8/157 [00:09<02:31,  1.02s/it]Epoch [7/10]:   6%|▌         | 9/157 [00:10<02:28,  1.00s/it]Epoch [7/10]:   6%|▋         | 10/157 [00:11<02:26,  1.00it/s]Epoch [7/10]:   7%|▋         | 11/157 [00:12<02:24,  1.01it/s]Epoch [7/10]:   8%|▊         | 12/157 [00:13<02:23,  1.01it/s]Epoch [7/10]:   8%|▊         | 13/157 [00:14<02:21,  1.02it/s]Epoch [7/10]:   9%|▉         | 14/157 [00:15<02:20,  1.02it/s]Epoch [7/10]:  10%|▉         | 15/157 [00:16<02:19,  1.02it/s]Epoch [7/10]:  10%|█         | 16/157 [00:17<02:18,  1.02it/s]Epoch [7/10]:  11%|█         | 17/157 [00:18<02:17,  1.02it/s]Epoch [7/10]:  11%|█▏        | 18/157 [00:19<02:16,  1.02it/s]Epoch [7/10]:  12%|█▏        | 19/157 [00:19<02:15,  1.02it/s]Epoch [7/10]:  13%|█▎        | 20/157 [00:20<02:14,  1.02it/s]Epoch [7/10]:  13%|█▎        | 21/157 [00:21<02:13,  1.02it/s]Epoch [7/10]:  14%|█▍        | 22/157 [00:22<02:12,  1.02it/s]Epoch [7/10]:  15%|█▍        | 23/157 [00:23<02:11,  1.02it/s]Epoch [7/10]:  15%|█▌        | 24/157 [00:24<02:10,  1.02it/s]Epoch [7/10]:  16%|█▌        | 25/157 [00:25<02:09,  1.02it/s]Epoch [7/10]:  17%|█▋        | 26/157 [00:26<02:08,  1.02it/s]Epoch [7/10]:  17%|█▋        | 27/157 [00:27<02:07,  1.02it/s]Epoch [7/10]:  18%|█▊        | 28/157 [00:28<02:06,  1.02it/s]Epoch [7/10]:  18%|█▊        | 29/157 [00:29<02:05,  1.02it/s]Epoch [7/10]:  19%|█▉        | 30/157 [00:30<02:04,  1.02it/s]Epoch [7/10]:  20%|█▉        | 31/157 [00:31<02:03,  1.02it/s]Epoch [7/10]:  20%|██        | 32/157 [00:32<02:02,  1.02it/s]Epoch [7/10]:  21%|██        | 33/157 [00:33<02:01,  1.02it/s]Epoch [7/10]:  22%|██▏       | 34/157 [00:34<02:00,  1.02it/s]Epoch [7/10]:  22%|██▏       | 35/157 [00:35<01:59,  1.02it/s]Epoch [7/10]:  23%|██▎       | 36/157 [00:36<01:58,  1.02it/s]Epoch [7/10]:  24%|██▎       | 37/157 [00:37<01:57,  1.02it/s]Epoch [7/10]:  24%|██▍       | 38/157 [00:38<01:56,  1.02it/s]Epoch [7/10]:  25%|██▍       | 39/157 [00:39<01:55,  1.02it/s]Epoch [7/10]:  25%|██▌       | 40/157 [00:40<01:54,  1.02it/s]Epoch [7/10]:  26%|██▌       | 41/157 [00:41<01:53,  1.02it/s]Epoch [7/10]:  27%|██▋       | 42/157 [00:42<01:52,  1.02it/s]Epoch [7/10]:  27%|██▋       | 43/157 [00:43<01:51,  1.02it/s]Epoch [7/10]:  28%|██▊       | 44/157 [00:44<01:50,  1.02it/s]Epoch [7/10]:  29%|██▊       | 45/157 [00:45<01:49,  1.02it/s]Epoch [7/10]:  29%|██▉       | 46/157 [00:46<01:48,  1.02it/s]Epoch [7/10]:  30%|██▉       | 47/157 [00:47<01:47,  1.02it/s]Epoch [7/10]:  31%|███       | 48/157 [00:48<01:46,  1.02it/s]Epoch [7/10]:  31%|███       | 49/157 [00:49<01:45,  1.02it/s]Epoch [7/10]:  32%|███▏      | 50/157 [00:50<01:44,  1.02it/s]Epoch [7/10]:  32%|███▏      | 51/157 [00:51<01:43,  1.02it/s]Epoch [7/10]:  33%|███▎      | 52/157 [00:52<01:42,  1.02it/s]Epoch [7/10]:  34%|███▍      | 53/157 [00:53<01:41,  1.02it/s]Epoch [7/10]:  34%|███▍      | 54/157 [00:54<01:40,  1.02it/s]Epoch [7/10]:  35%|███▌      | 55/157 [00:55<01:39,  1.02it/s]Epoch [7/10]:  36%|███▌      | 56/157 [00:56<01:38,  1.02it/s]Epoch [7/10]:  36%|███▋      | 57/157 [00:57<01:37,  1.02it/s]Epoch [7/10]:  37%|███▋      | 58/157 [00:58<01:37,  1.02it/s]Epoch [7/10]:  38%|███▊      | 59/157 [00:59<01:36,  1.02it/s]Epoch [7/10]:  38%|███▊      | 60/157 [01:00<01:35,  1.02it/s]Epoch [7/10]:  39%|███▉      | 61/157 [01:01<01:34,  1.02it/s]Epoch [7/10]:  39%|███▉      | 62/157 [01:02<01:33,  1.02it/s]Epoch [7/10]:  40%|████      | 63/157 [01:03<01:32,  1.02it/s]Epoch [7/10]:  41%|████      | 64/157 [01:04<01:31,  1.02it/s]Epoch [7/10]:  41%|████▏     | 65/157 [01:05<01:30,  1.02it/s]Epoch [7/10]:  42%|████▏     | 66/157 [01:06<01:29,  1.02it/s]Epoch [7/10]:  43%|████▎     | 67/157 [01:07<01:28,  1.02it/s]Epoch [7/10]:  43%|████▎     | 68/157 [01:08<01:27,  1.02it/s]Epoch [7/10]:  44%|████▍     | 69/157 [01:09<01:26,  1.02it/s]Epoch [7/10]:  45%|████▍     | 70/157 [01:09<01:25,  1.02it/s]Epoch [7/10]:  45%|████▌     | 71/157 [01:10<01:24,  1.02it/s]Epoch [7/10]:  46%|████▌     | 72/157 [01:11<01:23,  1.02it/s]Epoch [7/10]:  46%|████▋     | 73/157 [01:12<01:22,  1.02it/s]Epoch [7/10]:  47%|████▋     | 74/157 [01:13<01:21,  1.02it/s]Epoch [7/10]:  48%|████▊     | 75/157 [01:14<01:20,  1.02it/s]Epoch [7/10]:  48%|████▊     | 76/157 [01:15<01:19,  1.02it/s]Epoch [7/10]:  49%|████▉     | 77/157 [01:16<01:18,  1.02it/s]Epoch [7/10]:  50%|████▉     | 78/157 [01:17<01:17,  1.02it/s]Epoch [7/10]:  50%|█████     | 79/157 [01:18<01:16,  1.02it/s]Epoch [7/10]:  51%|█████     | 80/157 [01:19<01:15,  1.02it/s]Epoch [7/10]:  52%|█████▏    | 81/157 [01:20<01:14,  1.02it/s]Epoch [7/10]:  52%|█████▏    | 82/157 [01:21<01:13,  1.02it/s]Epoch [7/10]:  53%|█████▎    | 83/157 [01:22<01:12,  1.02it/s]Epoch [7/10]:  54%|█████▎    | 84/157 [01:23<01:11,  1.02it/s]Epoch [7/10]:  54%|█████▍    | 85/157 [01:24<01:10,  1.02it/s]Epoch [7/10]:  55%|█████▍    | 86/157 [01:25<01:09,  1.02it/s]Epoch [7/10]:  55%|█████▌    | 87/157 [01:26<01:08,  1.02it/s]Epoch [7/10]:  56%|█████▌    | 88/157 [01:27<01:07,  1.02it/s]Epoch [7/10]:  57%|█████▋    | 89/157 [01:28<01:06,  1.02it/s]Epoch [7/10]:  57%|█████▋    | 90/157 [01:29<01:05,  1.02it/s]Epoch [7/10]:  58%|█████▊    | 91/157 [01:30<01:04,  1.02it/s]Epoch [7/10]:  59%|█████▊    | 92/157 [01:31<01:03,  1.02it/s]Epoch [7/10]:  59%|█████▉    | 93/157 [01:32<01:02,  1.02it/s]Epoch [7/10]:  60%|█████▉    | 94/157 [01:33<01:01,  1.02it/s]Epoch [7/10]:  61%|██████    | 95/157 [01:34<01:00,  1.02it/s]Epoch [7/10]:  61%|██████    | 96/157 [01:35<00:59,  1.02it/s]Epoch [7/10]:  62%|██████▏   | 97/157 [01:36<00:58,  1.02it/s]Epoch [7/10]:  62%|██████▏   | 98/157 [01:37<00:57,  1.02it/s]Epoch [7/10]:  63%|██████▎   | 99/157 [01:38<00:56,  1.02it/s]Epoch [7/10]:  64%|██████▎   | 100/157 [01:39<00:55,  1.02it/s]Epoch [7/10]:  64%|██████▍   | 101/157 [01:40<00:54,  1.02it/s]Epoch [7/10]:  65%|██████▍   | 102/157 [01:41<00:53,  1.02it/s]Epoch [7/10]:  66%|██████▌   | 103/157 [01:42<00:52,  1.02it/s]Epoch [7/10]:  66%|██████▌   | 104/157 [01:43<00:51,  1.02it/s]Epoch [7/10]:  67%|██████▋   | 105/157 [01:44<00:50,  1.02it/s]Epoch [7/10]:  68%|██████▊   | 106/157 [01:45<00:50,  1.02it/s]Epoch [7/10]:  68%|██████▊   | 107/157 [01:46<00:48,  1.02it/s]Epoch [7/10]:  69%|██████▉   | 108/157 [01:47<00:48,  1.02it/s]Epoch [7/10]:  69%|██████▉   | 109/157 [01:48<00:47,  1.02it/s]Epoch [7/10]:  70%|███████   | 110/157 [01:49<00:46,  1.02it/s]Epoch [7/10]:  71%|███████   | 111/157 [01:50<00:45,  1.02it/s]Epoch [7/10]:  71%|███████▏  | 112/157 [01:51<00:44,  1.02it/s]Epoch [7/10]:  72%|███████▏  | 113/157 [01:52<00:43,  1.02it/s]Epoch [7/10]:  73%|███████▎  | 114/157 [01:53<00:42,  1.02it/s]Epoch [7/10]:  73%|███████▎  | 115/157 [01:54<00:41,  1.02it/s]Epoch [7/10]:  74%|███████▍  | 116/157 [01:55<00:40,  1.02it/s]Epoch [7/10]:  75%|███████▍  | 117/157 [01:56<00:39,  1.02it/s]Epoch [7/10]:  75%|███████▌  | 118/157 [01:57<00:38,  1.02it/s]Epoch [7/10]:  76%|███████▌  | 119/157 [01:58<00:37,  1.02it/s]Epoch [7/10]:  76%|███████▋  | 120/157 [01:58<00:36,  1.02it/s]Epoch [7/10]:  77%|███████▋  | 121/157 [01:59<00:35,  1.02it/s]Epoch [7/10]:  78%|███████▊  | 122/157 [02:00<00:34,  1.02it/s]Epoch [7/10]:  78%|███████▊  | 123/157 [02:01<00:33,  1.02it/s]Epoch [7/10]:  79%|███████▉  | 124/157 [02:02<00:32,  1.02it/s]Epoch [7/10]:  80%|███████▉  | 125/157 [02:03<00:31,  1.02it/s]Epoch [7/10]:  80%|████████  | 126/157 [02:04<00:30,  1.02it/s]Epoch [7/10]:  81%|████████  | 127/157 [02:05<00:29,  1.02it/s]Epoch [7/10]:  82%|████████▏ | 128/157 [02:06<00:28,  1.02it/s]Epoch [7/10]:  82%|████████▏ | 129/157 [02:07<00:27,  1.02it/s]Epoch [7/10]:  83%|████████▎ | 130/157 [02:08<00:26,  1.02it/s]Epoch [7/10]:  83%|████████▎ | 131/157 [02:09<00:25,  1.02it/s]Epoch [7/10]:  84%|████████▍ | 132/157 [02:10<00:24,  1.03it/s]Epoch [7/10]:  85%|████████▍ | 133/157 [02:11<00:23,  1.03it/s]Epoch [7/10]:  85%|████████▌ | 134/157 [02:12<00:22,  1.03it/s]Epoch [7/10]:  86%|████████▌ | 135/157 [02:13<00:21,  1.03it/s]Epoch [7/10]:  87%|████████▋ | 136/157 [02:14<00:20,  1.03it/s]Epoch [7/10]:  87%|████████▋ | 137/157 [02:15<00:19,  1.03it/s]Epoch [7/10]:  88%|████████▊ | 138/157 [02:16<00:18,  1.03it/s]Epoch [7/10]:  89%|████████▊ | 139/157 [02:17<00:17,  1.03it/s]Epoch [7/10]:  89%|████████▉ | 140/157 [02:18<00:16,  1.02it/s]Epoch [7/10]:  90%|████████▉ | 141/157 [02:19<00:15,  1.02it/s]Epoch [7/10]:  90%|█████████ | 142/157 [02:20<00:14,  1.02it/s]Epoch [7/10]:  91%|█████████ | 143/157 [02:21<00:13,  1.02it/s]Epoch [7/10]:  92%|█████████▏| 144/157 [02:22<00:12,  1.02it/s]Epoch [7/10]:  92%|█████████▏| 145/157 [02:23<00:11,  1.03it/s]Epoch [7/10]:  93%|█████████▎| 146/157 [02:24<00:10,  1.03it/s]Epoch [7/10]:  94%|█████████▎| 147/157 [02:25<00:09,  1.03it/s]Epoch [7/10]:  94%|█████████▍| 148/157 [02:26<00:08,  1.03it/s]Epoch [7/10]:  95%|█████████▍| 149/157 [02:27<00:07,  1.03it/s]Epoch [7/10]:  96%|█████████▌| 150/157 [02:28<00:06,  1.03it/s]Epoch [7/10]:  96%|█████████▌| 151/157 [02:29<00:05,  1.02it/s]Epoch [7/10]:  97%|█████████▋| 152/157 [02:30<00:04,  1.03it/s]Epoch [7/10]:  97%|█████████▋| 153/157 [02:31<00:03,  1.03it/s]Epoch [7/10]:  98%|█████████▊| 154/157 [02:32<00:02,  1.03it/s]Epoch [7/10]:  99%|█████████▊| 155/157 [02:33<00:01,  1.02it/s]Epoch [7/10]:  99%|█████████▉| 156/157 [02:34<00:00,  1.02it/s]Epoch [7/10]: 100%|██████████| 157/157 [02:34<00:00,  1.30it/s]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:22,  3.21s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.45s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.21s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:08<00:08,  2.10s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:10<00:06,  2.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:03,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.97s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 7 epochs: 0.00%

Epoch [8/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [8/10]:   1%|          | 1/157 [00:02<05:57,  2.29s/it]Epoch [8/10]:   1%|▏         | 2/157 [00:03<03:55,  1.52s/it]Epoch [8/10]:   2%|▏         | 3/157 [00:04<03:15,  1.27s/it]Epoch [8/10]:   3%|▎         | 4/157 [00:05<02:56,  1.15s/it]Epoch [8/10]:   3%|▎         | 5/157 [00:06<02:45,  1.09s/it]Epoch [8/10]:   4%|▍         | 6/157 [00:07<02:38,  1.05s/it]Epoch [8/10]:   4%|▍         | 7/157 [00:08<02:34,  1.03s/it]Epoch [8/10]:   5%|▌         | 8/157 [00:09<02:30,  1.01s/it]Epoch [8/10]:   6%|▌         | 9/157 [00:10<02:28,  1.00s/it]Epoch [8/10]:   6%|▋         | 10/157 [00:11<02:26,  1.01it/s]Epoch [8/10]:   7%|▋         | 11/157 [00:12<02:24,  1.01it/s]Epoch [8/10]:   8%|▊         | 12/157 [00:13<02:23,  1.01it/s]Epoch [8/10]:   8%|▊         | 13/157 [00:14<02:21,  1.02it/s]Epoch [8/10]:   9%|▉         | 14/157 [00:15<02:20,  1.02it/s]Epoch [8/10]:  10%|▉         | 15/157 [00:15<02:19,  1.02it/s]Epoch [8/10]:  10%|█         | 16/157 [00:16<02:18,  1.02it/s]Epoch [8/10]:  11%|█         | 17/157 [00:17<02:17,  1.02it/s]Epoch [8/10]:  11%|█▏        | 18/157 [00:18<02:16,  1.02it/s]Epoch [8/10]:  12%|█▏        | 19/157 [00:19<02:14,  1.02it/s]Epoch [8/10]:  13%|█▎        | 20/157 [00:20<02:13,  1.02it/s]Epoch [8/10]:  13%|█▎        | 21/157 [00:21<02:13,  1.02it/s]Epoch [8/10]:  14%|█▍        | 22/157 [00:22<02:12,  1.02it/s]Epoch [8/10]:  15%|█▍        | 23/157 [00:23<02:11,  1.02it/s]Epoch [8/10]:  15%|█▌        | 24/157 [00:24<02:10,  1.02it/s]Epoch [8/10]:  16%|█▌        | 25/157 [00:25<02:09,  1.02it/s]Epoch [8/10]:  17%|█▋        | 26/157 [00:26<02:08,  1.02it/s]Epoch [8/10]:  17%|█▋        | 27/157 [00:27<02:07,  1.02it/s]Epoch [8/10]:  18%|█▊        | 28/157 [00:28<02:06,  1.02it/s]Epoch [8/10]:  18%|█▊        | 29/157 [00:29<02:05,  1.02it/s]Epoch [8/10]:  19%|█▉        | 30/157 [00:30<02:04,  1.02it/s]Epoch [8/10]:  20%|█▉        | 31/157 [00:31<02:03,  1.02it/s]Epoch [8/10]:  20%|██        | 32/157 [00:32<02:02,  1.02it/s]Epoch [8/10]:  21%|██        | 33/157 [00:33<02:01,  1.02it/s]Epoch [8/10]:  22%|██▏       | 34/157 [00:34<02:00,  1.02it/s]Epoch [8/10]:  22%|██▏       | 35/157 [00:35<01:59,  1.02it/s]Epoch [8/10]:  23%|██▎       | 36/157 [00:36<01:58,  1.02it/s]Epoch [8/10]:  24%|██▎       | 37/157 [00:37<01:57,  1.02it/s]Epoch [8/10]:  24%|██▍       | 38/157 [00:38<01:56,  1.02it/s]Epoch [8/10]:  25%|██▍       | 39/157 [00:39<01:56,  1.02it/s]Epoch [8/10]:  25%|██▌       | 40/157 [00:40<01:55,  1.02it/s]Epoch [8/10]:  26%|██▌       | 41/157 [00:41<01:53,  1.02it/s]Epoch [8/10]:  27%|██▋       | 42/157 [00:42<01:52,  1.02it/s]Epoch [8/10]:  27%|██▋       | 43/157 [00:43<01:51,  1.02it/s]Epoch [8/10]:  28%|██▊       | 44/157 [00:44<01:50,  1.02it/s]Epoch [8/10]:  29%|██▊       | 45/157 [00:45<01:49,  1.02it/s]Epoch [8/10]:  29%|██▉       | 46/157 [00:46<01:48,  1.02it/s]Epoch [8/10]:  30%|██▉       | 47/157 [00:47<01:47,  1.02it/s]Epoch [8/10]:  31%|███       | 48/157 [00:48<01:46,  1.02it/s]Epoch [8/10]:  31%|███       | 49/157 [00:49<01:45,  1.02it/s]Epoch [8/10]:  32%|███▏      | 50/157 [00:50<01:44,  1.02it/s]Epoch [8/10]:  32%|███▏      | 51/157 [00:51<01:44,  1.01it/s]Epoch [8/10]:  33%|███▎      | 52/157 [00:52<01:43,  1.01it/s]Epoch [8/10]:  34%|███▍      | 53/157 [00:53<01:42,  1.01it/s]Epoch [8/10]:  34%|███▍      | 54/157 [00:54<01:41,  1.01it/s]Epoch [8/10]:  35%|███▌      | 55/157 [00:55<01:40,  1.01it/s]Epoch [8/10]:  36%|███▌      | 56/157 [00:56<01:39,  1.01it/s]Epoch [8/10]:  36%|███▋      | 57/157 [00:57<01:39,  1.01it/s]Epoch [8/10]:  37%|███▋      | 58/157 [00:58<01:38,  1.01it/s]Epoch [8/10]:  38%|███▊      | 59/157 [00:59<01:36,  1.01it/s]Epoch [8/10]:  38%|███▊      | 60/157 [01:00<01:35,  1.01it/s]Epoch [8/10]:  39%|███▉      | 61/157 [01:01<01:34,  1.01it/s]Epoch [8/10]:  39%|███▉      | 62/157 [01:02<01:33,  1.01it/s]Epoch [8/10]:  40%|████      | 63/157 [01:03<01:32,  1.01it/s]Epoch [8/10]:  41%|████      | 64/157 [01:04<01:31,  1.01it/s]Epoch [8/10]:  41%|████▏     | 65/157 [01:05<01:31,  1.01it/s]Epoch [8/10]:  42%|████▏     | 66/157 [01:06<01:29,  1.01it/s]Epoch [8/10]:  43%|████▎     | 67/157 [01:07<01:28,  1.01it/s]Epoch [8/10]:  43%|████▎     | 68/157 [01:08<01:27,  1.01it/s]Epoch [8/10]:  44%|████▍     | 69/157 [01:09<01:26,  1.02it/s]Epoch [8/10]:  45%|████▍     | 70/157 [01:10<01:25,  1.02it/s]Epoch [8/10]:  45%|████▌     | 71/157 [01:10<01:24,  1.02it/s]Epoch [8/10]:  46%|████▌     | 72/157 [01:11<01:23,  1.02it/s]Epoch [8/10]:  46%|████▋     | 73/157 [01:12<01:22,  1.02it/s]Epoch [8/10]:  47%|████▋     | 74/157 [01:13<01:21,  1.02it/s]Epoch [8/10]:  48%|████▊     | 75/157 [01:14<01:20,  1.02it/s]Epoch [8/10]:  48%|████▊     | 76/157 [01:15<01:19,  1.02it/s]Epoch [8/10]:  49%|████▉     | 77/157 [01:16<01:18,  1.02it/s]Epoch [8/10]:  50%|████▉     | 78/157 [01:17<01:17,  1.02it/s]Epoch [8/10]:  50%|█████     | 79/157 [01:18<01:16,  1.02it/s]Epoch [8/10]:  51%|█████     | 80/157 [01:19<01:15,  1.02it/s]Epoch [8/10]:  52%|█████▏    | 81/157 [01:20<01:14,  1.02it/s]Epoch [8/10]:  52%|█████▏    | 82/157 [01:21<01:13,  1.02it/s]Epoch [8/10]:  53%|█████▎    | 83/157 [01:22<01:12,  1.02it/s]Epoch [8/10]:  54%|█████▎    | 84/157 [01:23<01:11,  1.02it/s]Epoch [8/10]:  54%|█████▍    | 85/157 [01:24<01:10,  1.02it/s]Epoch [8/10]:  55%|█████▍    | 86/157 [01:25<01:09,  1.02it/s]Epoch [8/10]:  55%|█████▌    | 87/157 [01:26<01:08,  1.02it/s]Epoch [8/10]:  56%|█████▌    | 88/157 [01:27<01:07,  1.02it/s]Epoch [8/10]:  57%|█████▋    | 89/157 [01:28<01:06,  1.02it/s]Epoch [8/10]:  57%|█████▋    | 90/157 [01:29<01:05,  1.02it/s]Epoch [8/10]:  58%|█████▊    | 91/157 [01:30<01:04,  1.02it/s]Epoch [8/10]:  59%|█████▊    | 92/157 [01:31<01:03,  1.02it/s]Epoch [8/10]:  59%|█████▉    | 93/157 [01:32<01:02,  1.02it/s]Epoch [8/10]:  60%|█████▉    | 94/157 [01:33<01:01,  1.02it/s]Epoch [8/10]:  61%|██████    | 95/157 [01:34<01:00,  1.02it/s]Epoch [8/10]:  61%|██████    | 96/157 [01:35<00:59,  1.02it/s]Epoch [8/10]:  62%|██████▏   | 97/157 [01:36<00:58,  1.02it/s]Epoch [8/10]:  62%|██████▏   | 98/157 [01:37<00:58,  1.02it/s]Epoch [8/10]:  63%|██████▎   | 99/157 [01:38<00:56,  1.02it/s]Epoch [8/10]:  64%|██████▎   | 100/157 [01:39<00:55,  1.02it/s]Epoch [8/10]:  64%|██████▍   | 101/157 [01:40<00:54,  1.02it/s]Epoch [8/10]:  65%|██████▍   | 102/157 [01:41<00:54,  1.02it/s]Epoch [8/10]:  66%|██████▌   | 103/157 [01:42<00:53,  1.02it/s]Epoch [8/10]:  66%|██████▌   | 104/157 [01:43<00:52,  1.02it/s]Epoch [8/10]:  67%|██████▋   | 105/157 [01:44<00:51,  1.02it/s]Epoch [8/10]:  68%|██████▊   | 106/157 [01:45<00:50,  1.02it/s]Epoch [8/10]:  68%|██████▊   | 107/157 [01:46<00:49,  1.02it/s]Epoch [8/10]:  69%|██████▉   | 108/157 [01:47<00:48,  1.02it/s]Epoch [8/10]:  69%|██████▉   | 109/157 [01:48<00:47,  1.02it/s]Epoch [8/10]:  70%|███████   | 110/157 [01:49<00:46,  1.02it/s]Epoch [8/10]:  71%|███████   | 111/157 [01:50<00:45,  1.02it/s]Epoch [8/10]:  71%|███████▏  | 112/157 [01:51<00:44,  1.02it/s]Epoch [8/10]:  72%|███████▏  | 113/157 [01:52<00:43,  1.02it/s]Epoch [8/10]:  73%|███████▎  | 114/157 [01:53<00:42,  1.02it/s]Epoch [8/10]:  73%|███████▎  | 115/157 [01:54<00:41,  1.02it/s]Epoch [8/10]:  74%|███████▍  | 116/157 [01:55<00:40,  1.02it/s]Epoch [8/10]:  75%|███████▍  | 117/157 [01:56<00:39,  1.02it/s]Epoch [8/10]:  75%|███████▌  | 118/157 [01:57<00:38,  1.02it/s]Epoch [8/10]:  76%|███████▌  | 119/157 [01:58<00:37,  1.02it/s]Epoch [8/10]:  76%|███████▋  | 120/157 [01:59<00:36,  1.02it/s]Epoch [8/10]:  77%|███████▋  | 121/157 [02:00<00:35,  1.02it/s]Epoch [8/10]:  78%|███████▊  | 122/157 [02:01<00:34,  1.02it/s]Epoch [8/10]:  78%|███████▊  | 123/157 [02:02<00:33,  1.02it/s]Epoch [8/10]:  79%|███████▉  | 124/157 [02:03<00:32,  1.02it/s]Epoch [8/10]:  80%|███████▉  | 125/157 [02:04<00:31,  1.02it/s]Epoch [8/10]:  80%|████████  | 126/157 [02:04<00:30,  1.02it/s]Epoch [8/10]:  81%|████████  | 127/157 [02:05<00:29,  1.02it/s]Epoch [8/10]:  82%|████████▏ | 128/157 [02:06<00:28,  1.02it/s]Epoch [8/10]:  82%|████████▏ | 129/157 [02:07<00:27,  1.02it/s]Epoch [8/10]:  83%|████████▎ | 130/157 [02:08<00:26,  1.02it/s]Epoch [8/10]:  83%|████████▎ | 131/157 [02:09<00:25,  1.02it/s]Epoch [8/10]:  84%|████████▍ | 132/157 [02:10<00:24,  1.02it/s]Epoch [8/10]:  85%|████████▍ | 133/157 [02:11<00:23,  1.02it/s]Epoch [8/10]:  85%|████████▌ | 134/157 [02:12<00:22,  1.02it/s]Epoch [8/10]:  86%|████████▌ | 135/157 [02:13<00:21,  1.02it/s]Epoch [8/10]:  87%|████████▋ | 136/157 [02:14<00:20,  1.02it/s]Epoch [8/10]:  87%|████████▋ | 137/157 [02:15<00:19,  1.02it/s]Epoch [8/10]:  88%|████████▊ | 138/157 [02:16<00:18,  1.02it/s]Epoch [8/10]:  89%|████████▊ | 139/157 [02:17<00:17,  1.02it/s]Epoch [8/10]:  89%|████████▉ | 140/157 [02:18<00:16,  1.02it/s]Epoch [8/10]:  90%|████████▉ | 141/157 [02:19<00:15,  1.02it/s]Epoch [8/10]:  90%|█████████ | 142/157 [02:20<00:14,  1.02it/s]Epoch [8/10]:  91%|█████████ | 143/157 [02:21<00:13,  1.02it/s]Epoch [8/10]:  92%|█████████▏| 144/157 [02:22<00:12,  1.02it/s]Epoch [8/10]:  92%|█████████▏| 145/157 [02:23<00:11,  1.02it/s]Epoch [8/10]:  93%|█████████▎| 146/157 [02:24<00:10,  1.02it/s]Epoch [8/10]:  94%|█████████▎| 147/157 [02:25<00:09,  1.02it/s]Epoch [8/10]:  94%|█████████▍| 148/157 [02:26<00:08,  1.02it/s]Epoch [8/10]:  95%|█████████▍| 149/157 [02:27<00:07,  1.02it/s]Epoch [8/10]:  96%|█████████▌| 150/157 [02:28<00:06,  1.02it/s]Epoch [8/10]:  96%|█████████▌| 151/157 [02:29<00:05,  1.02it/s]Epoch [8/10]:  97%|█████████▋| 152/157 [02:30<00:04,  1.02it/s]Epoch [8/10]:  97%|█████████▋| 153/157 [02:31<00:03,  1.02it/s]Epoch [8/10]:  98%|█████████▊| 154/157 [02:32<00:02,  1.02it/s]Epoch [8/10]:  99%|█████████▊| 155/157 [02:33<00:01,  1.02it/s]Epoch [8/10]:  99%|█████████▉| 156/157 [02:34<00:00,  1.02it/s]Epoch [8/10]: 100%|██████████| 157/157 [02:34<00:00,  1.30it/s]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.32s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.50s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.24s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.12s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.05s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:04,  2.01s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.98s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 8 epochs: 0.00%

Epoch [9/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [9/10]:   1%|          | 1/157 [00:02<05:44,  2.21s/it]Epoch [9/10]:   1%|▏         | 2/157 [00:03<03:50,  1.49s/it]Epoch [9/10]:   2%|▏         | 3/157 [00:04<03:13,  1.25s/it]Epoch [9/10]:   3%|▎         | 4/157 [00:05<02:55,  1.15s/it]Epoch [9/10]:   3%|▎         | 5/157 [00:06<02:45,  1.09s/it]Epoch [9/10]:   4%|▍         | 6/157 [00:07<02:39,  1.06s/it]Epoch [9/10]:   4%|▍         | 7/157 [00:08<02:34,  1.03s/it]Epoch [9/10]:   5%|▌         | 8/157 [00:09<02:31,  1.02s/it]Epoch [9/10]:   6%|▌         | 9/157 [00:10<02:28,  1.01s/it]Epoch [9/10]:   6%|▋         | 10/157 [00:11<02:26,  1.00it/s]Epoch [9/10]:   7%|▋         | 11/157 [00:12<02:24,  1.01it/s]Epoch [9/10]:   8%|▊         | 12/157 [00:13<02:23,  1.01it/s]Epoch [9/10]:   8%|▊         | 13/157 [00:13<02:21,  1.01it/s]Epoch [9/10]:   9%|▉         | 14/157 [00:14<02:20,  1.02it/s]Epoch [9/10]:  10%|▉         | 15/157 [00:15<02:19,  1.02it/s]Epoch [9/10]:  10%|█         | 16/157 [00:16<02:18,  1.02it/s]Epoch [9/10]:  11%|█         | 17/157 [00:17<02:17,  1.02it/s]Epoch [9/10]:  11%|█▏        | 18/157 [00:18<02:16,  1.02it/s]Epoch [9/10]:  12%|█▏        | 19/157 [00:19<02:15,  1.02it/s]Epoch [9/10]:  13%|█▎        | 20/157 [00:20<02:14,  1.02it/s]Epoch [9/10]:  13%|█▎        | 21/157 [00:21<02:13,  1.02it/s]Epoch [9/10]:  14%|█▍        | 22/157 [00:22<02:12,  1.02it/s]Epoch [9/10]:  15%|█▍        | 23/157 [00:23<02:11,  1.02it/s]Epoch [9/10]:  15%|█▌        | 24/157 [00:24<02:10,  1.02it/s]Epoch [9/10]:  16%|█▌        | 25/157 [00:25<02:09,  1.02it/s]Epoch [9/10]:  17%|█▋        | 26/157 [00:26<02:08,  1.02it/s]Epoch [9/10]:  17%|█▋        | 27/157 [00:27<02:07,  1.02it/s]Epoch [9/10]:  18%|█▊        | 28/157 [00:28<02:06,  1.02it/s]Epoch [9/10]:  18%|█▊        | 29/157 [00:29<02:05,  1.02it/s]Epoch [9/10]:  19%|█▉        | 30/157 [00:30<02:04,  1.02it/s]Epoch [9/10]:  20%|█▉        | 31/157 [00:31<02:03,  1.02it/s]Epoch [9/10]:  20%|██        | 32/157 [00:32<02:02,  1.02it/s]Epoch [9/10]:  21%|██        | 33/157 [00:33<02:01,  1.02it/s]Epoch [9/10]:  22%|██▏       | 34/157 [00:34<02:00,  1.02it/s]Epoch [9/10]:  22%|██▏       | 35/157 [00:35<01:59,  1.02it/s]Epoch [9/10]:  23%|██▎       | 36/157 [00:36<01:58,  1.02it/s]Epoch [9/10]:  24%|██▎       | 37/157 [00:37<01:57,  1.02it/s]Epoch [9/10]:  24%|██▍       | 38/157 [00:38<01:56,  1.02it/s]Epoch [9/10]:  25%|██▍       | 39/157 [00:39<01:55,  1.02it/s]Epoch [9/10]:  25%|██▌       | 40/157 [00:40<01:54,  1.02it/s]Epoch [9/10]:  26%|██▌       | 41/157 [00:41<01:53,  1.02it/s]Epoch [9/10]:  27%|██▋       | 42/157 [00:42<01:52,  1.02it/s]Epoch [9/10]:  27%|██▋       | 43/157 [00:43<01:51,  1.02it/s]Epoch [9/10]:  28%|██▊       | 44/157 [00:44<01:50,  1.02it/s]Epoch [9/10]:  29%|██▊       | 45/157 [00:45<01:49,  1.02it/s]Epoch [9/10]:  29%|██▉       | 46/157 [00:46<01:48,  1.02it/s]Epoch [9/10]:  30%|██▉       | 47/157 [00:47<01:47,  1.02it/s]Epoch [9/10]:  31%|███       | 48/157 [00:48<01:46,  1.02it/s]Epoch [9/10]:  31%|███       | 49/157 [00:49<01:45,  1.02it/s]Epoch [9/10]:  32%|███▏      | 50/157 [00:50<01:44,  1.02it/s]Epoch [9/10]:  32%|███▏      | 51/157 [00:51<01:43,  1.02it/s]Epoch [9/10]:  33%|███▎      | 52/157 [00:52<01:42,  1.02it/s]Epoch [9/10]:  34%|███▍      | 53/157 [00:53<01:42,  1.02it/s]Epoch [9/10]:  34%|███▍      | 54/157 [00:54<01:41,  1.02it/s]Epoch [9/10]:  35%|███▌      | 55/157 [00:55<01:40,  1.02it/s]Epoch [9/10]:  36%|███▌      | 56/157 [00:56<01:39,  1.02it/s]Epoch [9/10]:  36%|███▋      | 57/157 [00:57<01:38,  1.02it/s]Epoch [9/10]:  37%|███▋      | 58/157 [00:58<01:37,  1.02it/s]Epoch [9/10]:  38%|███▊      | 59/157 [00:59<01:36,  1.02it/s]Epoch [9/10]:  38%|███▊      | 60/157 [01:00<01:35,  1.02it/s]Epoch [9/10]:  39%|███▉      | 61/157 [01:01<01:34,  1.02it/s]Epoch [9/10]:  39%|███▉      | 62/157 [01:02<01:33,  1.02it/s]Epoch [9/10]:  40%|████      | 63/157 [01:03<01:32,  1.02it/s]Epoch [9/10]:  41%|████      | 64/157 [01:03<01:31,  1.02it/s]Epoch [9/10]:  41%|████▏     | 65/157 [01:04<01:30,  1.02it/s]Epoch [9/10]:  42%|████▏     | 66/157 [01:05<01:29,  1.02it/s]Epoch [9/10]:  43%|████▎     | 67/157 [01:06<01:28,  1.02it/s]Epoch [9/10]:  43%|████▎     | 68/157 [01:07<01:27,  1.02it/s]Epoch [9/10]:  44%|████▍     | 69/157 [01:08<01:26,  1.02it/s]Epoch [9/10]:  45%|████▍     | 70/157 [01:09<01:25,  1.02it/s]Epoch [9/10]:  45%|████▌     | 71/157 [01:10<01:24,  1.02it/s]Epoch [9/10]:  46%|████▌     | 72/157 [01:11<01:23,  1.02it/s]Epoch [9/10]:  46%|████▋     | 73/157 [01:12<01:22,  1.02it/s]Epoch [9/10]:  47%|████▋     | 74/157 [01:13<01:21,  1.02it/s]Epoch [9/10]:  48%|████▊     | 75/157 [01:14<01:20,  1.02it/s]Epoch [9/10]:  48%|████▊     | 76/157 [01:15<01:19,  1.02it/s]Epoch [9/10]:  49%|████▉     | 77/157 [01:16<01:18,  1.02it/s]Epoch [9/10]:  50%|████▉     | 78/157 [01:17<01:17,  1.02it/s]Epoch [9/10]:  50%|█████     | 79/157 [01:18<01:16,  1.02it/s]Epoch [9/10]:  51%|█████     | 80/157 [01:19<01:15,  1.02it/s]Epoch [9/10]:  52%|█████▏    | 81/157 [01:20<01:14,  1.02it/s]Epoch [9/10]:  52%|█████▏    | 82/157 [01:21<01:13,  1.02it/s]Epoch [9/10]:  53%|█████▎    | 83/157 [01:22<01:12,  1.02it/s]Epoch [9/10]:  54%|█████▎    | 84/157 [01:23<01:11,  1.02it/s]Epoch [9/10]:  54%|█████▍    | 85/157 [01:24<01:10,  1.02it/s]Epoch [9/10]:  55%|█████▍    | 86/157 [01:25<01:09,  1.02it/s]Epoch [9/10]:  55%|█████▌    | 87/157 [01:26<01:08,  1.02it/s]Epoch [9/10]:  56%|█████▌    | 88/157 [01:27<01:07,  1.02it/s]Epoch [9/10]:  57%|█████▋    | 89/157 [01:28<01:06,  1.02it/s]Epoch [9/10]:  57%|█████▋    | 90/157 [01:29<01:05,  1.02it/s]Epoch [9/10]:  58%|█████▊    | 91/157 [01:30<01:04,  1.02it/s]Epoch [9/10]:  59%|█████▊    | 92/157 [01:31<01:03,  1.02it/s]Epoch [9/10]:  59%|█████▉    | 93/157 [01:32<01:02,  1.02it/s]Epoch [9/10]:  60%|█████▉    | 94/157 [01:33<01:01,  1.02it/s]Epoch [9/10]:  61%|██████    | 95/157 [01:34<01:00,  1.02it/s]Epoch [9/10]:  61%|██████    | 96/157 [01:35<00:59,  1.02it/s]Epoch [9/10]:  62%|██████▏   | 97/157 [01:36<00:58,  1.02it/s]Epoch [9/10]:  62%|██████▏   | 98/157 [01:37<00:57,  1.02it/s]Epoch [9/10]:  63%|██████▎   | 99/157 [01:38<00:56,  1.02it/s]Epoch [9/10]:  64%|██████▎   | 100/157 [01:39<00:55,  1.02it/s]Epoch [9/10]:  64%|██████▍   | 101/157 [01:40<00:54,  1.02it/s]Epoch [9/10]:  65%|██████▍   | 102/157 [01:41<00:53,  1.02it/s]Epoch [9/10]:  66%|██████▌   | 103/157 [01:42<00:53,  1.02it/s]Epoch [9/10]:  66%|██████▌   | 104/157 [01:43<00:52,  1.02it/s]Epoch [9/10]:  67%|██████▋   | 105/157 [01:44<00:50,  1.02it/s]Epoch [9/10]:  68%|██████▊   | 106/157 [01:45<00:49,  1.02it/s]Epoch [9/10]:  68%|██████▊   | 107/157 [01:46<00:49,  1.02it/s]Epoch [9/10]:  69%|██████▉   | 108/157 [01:47<00:48,  1.02it/s]Epoch [9/10]:  69%|██████▉   | 109/157 [01:48<00:47,  1.02it/s]Epoch [9/10]:  70%|███████   | 110/157 [01:49<00:46,  1.02it/s]Epoch [9/10]:  71%|███████   | 111/157 [01:50<00:45,  1.02it/s]Epoch [9/10]:  71%|███████▏  | 112/157 [01:51<00:44,  1.02it/s]Epoch [9/10]:  72%|███████▏  | 113/157 [01:52<00:43,  1.02it/s]Epoch [9/10]:  73%|███████▎  | 114/157 [01:53<00:42,  1.02it/s]Epoch [9/10]:  73%|███████▎  | 115/157 [01:54<00:41,  1.02it/s]Epoch [9/10]:  74%|███████▍  | 116/157 [01:54<00:40,  1.02it/s]Epoch [9/10]:  75%|███████▍  | 117/157 [01:55<00:39,  1.02it/s]Epoch [9/10]:  75%|███████▌  | 118/157 [01:56<00:38,  1.02it/s]Epoch [9/10]:  76%|███████▌  | 119/157 [01:57<00:37,  1.02it/s]Epoch [9/10]:  76%|███████▋  | 120/157 [01:58<00:36,  1.02it/s]Epoch [9/10]:  77%|███████▋  | 121/157 [01:59<00:35,  1.02it/s]Epoch [9/10]:  78%|███████▊  | 122/157 [02:00<00:34,  1.02it/s]Epoch [9/10]:  78%|███████▊  | 123/157 [02:01<00:33,  1.02it/s]Epoch [9/10]:  79%|███████▉  | 124/157 [02:02<00:32,  1.02it/s]Epoch [9/10]:  80%|███████▉  | 125/157 [02:03<00:31,  1.02it/s]Epoch [9/10]:  80%|████████  | 126/157 [02:04<00:30,  1.02it/s]Epoch [9/10]:  81%|████████  | 127/157 [02:05<00:29,  1.02it/s]Epoch [9/10]:  82%|████████▏ | 128/157 [02:06<00:28,  1.02it/s]Epoch [9/10]:  82%|████████▏ | 129/157 [02:07<00:27,  1.02it/s]Epoch [9/10]:  83%|████████▎ | 130/157 [02:08<00:26,  1.02it/s]Epoch [9/10]:  83%|████████▎ | 131/157 [02:09<00:25,  1.02it/s]Epoch [9/10]:  84%|████████▍ | 132/157 [02:10<00:24,  1.02it/s]Epoch [9/10]:  85%|████████▍ | 133/157 [02:11<00:23,  1.02it/s]Epoch [9/10]:  85%|████████▌ | 134/157 [02:12<00:22,  1.02it/s]Epoch [9/10]:  86%|████████▌ | 135/157 [02:13<00:21,  1.02it/s]Epoch [9/10]:  87%|████████▋ | 136/157 [02:14<00:20,  1.02it/s]Epoch [9/10]:  87%|████████▋ | 137/157 [02:15<00:19,  1.02it/s]Epoch [9/10]:  88%|████████▊ | 138/157 [02:16<00:18,  1.02it/s]Epoch [9/10]:  89%|████████▊ | 139/157 [02:17<00:17,  1.02it/s]Epoch [9/10]:  89%|████████▉ | 140/157 [02:18<00:16,  1.02it/s]Epoch [9/10]:  90%|████████▉ | 141/157 [02:19<00:15,  1.02it/s]Epoch [9/10]:  90%|█████████ | 142/157 [02:20<00:14,  1.02it/s]Epoch [9/10]:  91%|█████████ | 143/157 [02:21<00:13,  1.02it/s]Epoch [9/10]:  92%|█████████▏| 144/157 [02:22<00:12,  1.02it/s]Epoch [9/10]:  92%|█████████▏| 145/157 [02:23<00:11,  1.02it/s]Epoch [9/10]:  93%|█████████▎| 146/157 [02:24<00:10,  1.02it/s]Epoch [9/10]:  94%|█████████▎| 147/157 [02:25<00:09,  1.02it/s]Epoch [9/10]:  94%|█████████▍| 148/157 [02:26<00:08,  1.02it/s]Epoch [9/10]:  95%|█████████▍| 149/157 [02:27<00:07,  1.02it/s]Epoch [9/10]:  96%|█████████▌| 150/157 [02:28<00:06,  1.02it/s]Epoch [9/10]:  96%|█████████▌| 151/157 [02:29<00:05,  1.02it/s]Epoch [9/10]:  97%|█████████▋| 152/157 [02:30<00:04,  1.02it/s]Epoch [9/10]:  97%|█████████▋| 153/157 [02:31<00:03,  1.02it/s]Epoch [9/10]:  98%|█████████▊| 154/157 [02:32<00:02,  1.02it/s]Epoch [9/10]:  99%|█████████▊| 155/157 [02:33<00:01,  1.02it/s]Epoch [9/10]:  99%|█████████▉| 156/157 [02:34<00:00,  1.02it/s]Epoch [9/10]: 100%|██████████| 157/157 [02:34<00:00,  1.30it/s]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:22,  3.25s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.47s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.22s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.10s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:10<00:06,  2.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:03,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.97s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 9 epochs: 0.00%

Epoch [10/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [10/10]:   1%|          | 1/157 [00:02<06:01,  2.32s/it]Epoch [10/10]:   1%|▏         | 2/157 [00:03<03:57,  1.53s/it]Epoch [10/10]:   2%|▏         | 3/157 [00:04<03:17,  1.28s/it]Epoch [10/10]:   3%|▎         | 4/157 [00:05<02:58,  1.16s/it]Epoch [10/10]:   3%|▎         | 5/157 [00:06<02:47,  1.10s/it]Epoch [10/10]:   4%|▍         | 6/157 [00:07<02:40,  1.06s/it]Epoch [10/10]:   4%|▍         | 7/157 [00:08<02:35,  1.04s/it]Epoch [10/10]:   5%|▌         | 8/157 [00:09<02:31,  1.02s/it]Epoch [10/10]:   6%|▌         | 9/157 [00:10<02:29,  1.01s/it]Epoch [10/10]:   6%|▋         | 10/157 [00:11<02:26,  1.00it/s]Epoch [10/10]:   7%|▋         | 11/157 [00:12<02:25,  1.01it/s]Epoch [10/10]:   8%|▊         | 12/157 [00:13<02:23,  1.01it/s]Epoch [10/10]:   8%|▊         | 13/157 [00:14<02:22,  1.01it/s]Epoch [10/10]:   9%|▉         | 14/157 [00:15<02:20,  1.01it/s]Epoch [10/10]:  10%|▉         | 15/157 [00:16<02:19,  1.02it/s]Epoch [10/10]:  10%|█         | 16/157 [00:17<02:18,  1.02it/s]Epoch [10/10]:  11%|█         | 17/157 [00:18<02:17,  1.02it/s]Epoch [10/10]:  11%|█▏        | 18/157 [00:19<02:17,  1.01it/s]Epoch [10/10]:  12%|█▏        | 19/157 [00:20<02:17,  1.01it/s]Epoch [10/10]:  13%|█▎        | 20/157 [00:21<02:16,  1.01it/s]Epoch [10/10]:  13%|█▎        | 21/157 [00:22<02:14,  1.01it/s]Epoch [10/10]:  14%|█▍        | 22/157 [00:23<02:13,  1.01it/s]Epoch [10/10]:  15%|█▍        | 23/157 [00:24<02:12,  1.01it/s]Epoch [10/10]:  15%|█▌        | 24/157 [00:24<02:11,  1.01it/s]Epoch [10/10]:  16%|█▌        | 25/157 [00:25<02:10,  1.01it/s]Epoch [10/10]:  17%|█▋        | 26/157 [00:26<02:09,  1.01it/s]Epoch [10/10]:  17%|█▋        | 27/157 [00:27<02:08,  1.01it/s]Epoch [10/10]:  18%|█▊        | 28/157 [00:28<02:07,  1.01it/s]Epoch [10/10]:  18%|█▊        | 29/157 [00:29<02:06,  1.01it/s]Epoch [10/10]:  19%|█▉        | 30/157 [00:30<02:05,  1.01it/s]Epoch [10/10]:  20%|█▉        | 31/157 [00:31<02:04,  1.01it/s]Epoch [10/10]:  20%|██        | 32/157 [00:32<02:03,  1.01it/s]Epoch [10/10]:  21%|██        | 33/157 [00:33<02:02,  1.01it/s]Epoch [10/10]:  22%|██▏       | 34/157 [00:34<02:01,  1.01it/s]Epoch [10/10]:  22%|██▏       | 35/157 [00:35<02:00,  1.01it/s]Epoch [10/10]:  23%|██▎       | 36/157 [00:36<01:59,  1.01it/s]Epoch [10/10]:  24%|██▎       | 37/157 [00:37<01:58,  1.01it/s]Epoch [10/10]:  24%|██▍       | 38/157 [00:38<01:57,  1.01it/s]Epoch [10/10]:  25%|██▍       | 39/157 [00:39<01:56,  1.01it/s]Epoch [10/10]:  25%|██▌       | 40/157 [00:40<01:55,  1.01it/s]Epoch [10/10]:  26%|██▌       | 41/157 [00:41<01:54,  1.01it/s]Epoch [10/10]:  27%|██▋       | 42/157 [00:42<01:53,  1.01it/s]Epoch [10/10]:  27%|██▋       | 43/157 [00:43<01:52,  1.01it/s]Epoch [10/10]:  28%|██▊       | 44/157 [00:44<01:51,  1.01it/s]Epoch [10/10]:  29%|██▊       | 45/157 [00:45<01:50,  1.01it/s]Epoch [10/10]:  29%|██▉       | 46/157 [00:46<01:49,  1.02it/s]Epoch [10/10]:  30%|██▉       | 47/157 [00:47<01:48,  1.02it/s]Epoch [10/10]:  31%|███       | 48/157 [00:48<01:47,  1.02it/s]Epoch [10/10]:  31%|███       | 49/157 [00:49<01:46,  1.02it/s]Epoch [10/10]:  32%|███▏      | 50/157 [00:50<01:45,  1.02it/s]Epoch [10/10]:  32%|███▏      | 51/157 [00:51<01:44,  1.01it/s]Epoch [10/10]:  33%|███▎      | 52/157 [00:52<01:43,  1.01it/s]Epoch [10/10]:  34%|███▍      | 53/157 [00:53<01:43,  1.01it/s]Epoch [10/10]:  34%|███▍      | 54/157 [00:54<01:42,  1.01it/s]Epoch [10/10]:  35%|███▌      | 55/157 [00:55<01:41,  1.01it/s]Epoch [10/10]:  36%|███▌      | 56/157 [00:56<01:39,  1.01it/s]Epoch [10/10]:  36%|███▋      | 57/157 [00:57<01:38,  1.01it/s]Epoch [10/10]:  37%|███▋      | 58/157 [00:58<01:37,  1.01it/s]Epoch [10/10]:  38%|███▊      | 59/157 [00:59<01:36,  1.01it/s]Epoch [10/10]:  38%|███▊      | 60/157 [01:00<01:35,  1.01it/s]Epoch [10/10]:  39%|███▉      | 61/157 [01:01<01:34,  1.01it/s]Epoch [10/10]:  39%|███▉      | 62/157 [01:02<01:33,  1.01it/s]Epoch [10/10]:  40%|████      | 63/157 [01:03<01:32,  1.02it/s]Epoch [10/10]:  41%|████      | 64/157 [01:04<01:31,  1.02it/s]Epoch [10/10]:  41%|████▏     | 65/157 [01:05<01:30,  1.02it/s]Epoch [10/10]:  42%|████▏     | 66/157 [01:06<01:29,  1.02it/s]Epoch [10/10]:  43%|████▎     | 67/157 [01:07<01:28,  1.02it/s]Epoch [10/10]:  43%|████▎     | 68/157 [01:08<01:27,  1.02it/s]Epoch [10/10]:  44%|████▍     | 69/157 [01:09<01:26,  1.02it/s]Epoch [10/10]:  45%|████▍     | 70/157 [01:10<01:25,  1.02it/s]Epoch [10/10]:  45%|████▌     | 71/157 [01:11<01:24,  1.02it/s]Epoch [10/10]:  46%|████▌     | 72/157 [01:12<01:24,  1.01it/s]Epoch [10/10]:  46%|████▋     | 73/157 [01:13<01:22,  1.01it/s]Epoch [10/10]:  47%|████▋     | 74/157 [01:14<01:21,  1.01it/s]Epoch [10/10]:  48%|████▊     | 75/157 [01:15<01:20,  1.01it/s]Epoch [10/10]:  48%|████▊     | 76/157 [01:16<01:20,  1.01it/s]Epoch [10/10]:  49%|████▉     | 77/157 [01:17<01:19,  1.01it/s]Epoch [10/10]:  50%|████▉     | 78/157 [01:18<01:18,  1.01it/s]Epoch [10/10]:  50%|█████     | 79/157 [01:19<01:17,  1.01it/s]Epoch [10/10]:  51%|█████     | 80/157 [01:20<01:16,  1.00it/s]Epoch [10/10]:  52%|█████▏    | 81/157 [01:21<01:15,  1.01it/s]Epoch [10/10]:  52%|█████▏    | 82/157 [01:22<01:14,  1.01it/s]Epoch [10/10]:  53%|█████▎    | 83/157 [01:23<01:13,  1.01it/s]Epoch [10/10]:  54%|█████▎    | 84/157 [01:24<01:12,  1.01it/s]Epoch [10/10]:  54%|█████▍    | 85/157 [01:25<01:10,  1.01it/s]Epoch [10/10]:  55%|█████▍    | 86/157 [01:26<01:09,  1.01it/s]Epoch [10/10]:  55%|█████▌    | 87/157 [01:27<01:08,  1.02it/s]Epoch [10/10]:  56%|█████▌    | 88/157 [01:28<01:07,  1.02it/s]Epoch [10/10]:  57%|█████▋    | 89/157 [01:29<01:06,  1.02it/s]Epoch [10/10]:  57%|█████▋    | 90/157 [01:30<01:05,  1.02it/s]Epoch [10/10]:  58%|█████▊    | 91/157 [01:31<01:04,  1.02it/s]Epoch [10/10]:  59%|█████▊    | 92/157 [01:32<01:03,  1.02it/s]Epoch [10/10]:  59%|█████▉    | 93/157 [01:33<01:03,  1.02it/s]Epoch [10/10]:  60%|█████▉    | 94/157 [01:34<01:02,  1.02it/s]Epoch [10/10]:  61%|██████    | 95/157 [01:35<01:01,  1.02it/s]Epoch [10/10]:  61%|██████    | 96/157 [01:36<01:00,  1.02it/s]Epoch [10/10]:  62%|██████▏   | 97/157 [01:37<00:59,  1.02it/s]Epoch [10/10]:  62%|██████▏   | 98/157 [01:38<00:57,  1.02it/s]Epoch [10/10]:  63%|██████▎   | 99/157 [01:38<00:56,  1.02it/s]Epoch [10/10]:  64%|██████▎   | 100/157 [01:39<00:55,  1.02it/s]Epoch [10/10]:  64%|██████▍   | 101/157 [01:40<00:54,  1.02it/s]Epoch [10/10]:  65%|██████▍   | 102/157 [01:41<00:53,  1.02it/s]Epoch [10/10]:  66%|██████▌   | 103/157 [01:42<00:52,  1.02it/s]Epoch [10/10]:  66%|██████▌   | 104/157 [01:43<00:52,  1.02it/s]Epoch [10/10]:  67%|██████▋   | 105/157 [01:44<00:51,  1.02it/s]Epoch [10/10]:  68%|██████▊   | 106/157 [01:45<00:50,  1.02it/s]Epoch [10/10]:  68%|██████▊   | 107/157 [01:46<00:49,  1.02it/s]Epoch [10/10]:  69%|██████▉   | 108/157 [01:47<00:48,  1.02it/s]Epoch [10/10]:  69%|██████▉   | 109/157 [01:48<00:47,  1.02it/s]Epoch [10/10]:  70%|███████   | 110/157 [01:49<00:46,  1.02it/s]Epoch [10/10]:  71%|███████   | 111/157 [01:50<00:45,  1.02it/s]Epoch [10/10]:  71%|███████▏  | 112/157 [01:51<00:44,  1.02it/s]Epoch [10/10]:  72%|███████▏  | 113/157 [01:52<00:43,  1.02it/s]Epoch [10/10]:  73%|███████▎  | 114/157 [01:53<00:42,  1.02it/s]Epoch [10/10]:  73%|███████▎  | 115/157 [01:54<00:41,  1.02it/s]Epoch [10/10]:  74%|███████▍  | 116/157 [01:55<00:40,  1.02it/s]Epoch [10/10]:  75%|███████▍  | 117/157 [01:56<00:39,  1.02it/s]Epoch [10/10]:  75%|███████▌  | 118/157 [01:57<00:38,  1.02it/s]Epoch [10/10]:  76%|███████▌  | 119/157 [01:58<00:37,  1.02it/s]Epoch [10/10]:  76%|███████▋  | 120/157 [01:59<00:36,  1.02it/s]Epoch [10/10]:  77%|███████▋  | 121/157 [02:00<00:35,  1.02it/s]Epoch [10/10]:  78%|███████▊  | 122/157 [02:01<00:34,  1.02it/s]Epoch [10/10]:  78%|███████▊  | 123/157 [02:02<00:33,  1.02it/s]Epoch [10/10]:  79%|███████▉  | 124/157 [02:03<00:32,  1.02it/s]Epoch [10/10]:  80%|███████▉  | 125/157 [02:04<00:31,  1.02it/s]Epoch [10/10]:  80%|████████  | 126/157 [02:05<00:30,  1.02it/s]Epoch [10/10]:  81%|████████  | 127/157 [02:06<00:29,  1.02it/s]Epoch [10/10]:  82%|████████▏ | 128/157 [02:07<00:28,  1.02it/s]Epoch [10/10]:  82%|████████▏ | 129/157 [02:08<00:27,  1.02it/s]Epoch [10/10]:  83%|████████▎ | 130/157 [02:09<00:26,  1.02it/s]Epoch [10/10]:  83%|████████▎ | 131/157 [02:10<00:25,  1.02it/s]Epoch [10/10]:  84%|████████▍ | 132/157 [02:11<00:24,  1.02it/s]Epoch [10/10]:  85%|████████▍ | 133/157 [02:12<00:23,  1.02it/s]Epoch [10/10]:  85%|████████▌ | 134/157 [02:13<00:22,  1.02it/s]Epoch [10/10]:  86%|████████▌ | 135/157 [02:14<00:21,  1.02it/s]Epoch [10/10]:  87%|████████▋ | 136/157 [02:15<00:20,  1.02it/s]Epoch [10/10]:  87%|████████▋ | 137/157 [02:16<00:19,  1.02it/s]Epoch [10/10]:  88%|████████▊ | 138/157 [02:17<00:18,  1.02it/s]Epoch [10/10]:  89%|████████▊ | 139/157 [02:18<00:17,  1.02it/s]Epoch [10/10]:  89%|████████▉ | 140/157 [02:19<00:16,  1.02it/s]Epoch [10/10]:  90%|████████▉ | 141/157 [02:20<00:15,  1.02it/s]Epoch [10/10]:  90%|█████████ | 142/157 [02:21<00:14,  1.02it/s]Epoch [10/10]:  91%|█████████ | 143/157 [02:22<00:13,  1.02it/s]Epoch [10/10]:  92%|█████████▏| 144/157 [02:23<00:12,  1.02it/s]Epoch [10/10]:  92%|█████████▏| 145/157 [02:24<00:11,  1.02it/s]Epoch [10/10]:  93%|█████████▎| 146/157 [02:25<00:10,  1.02it/s]Epoch [10/10]:  94%|█████████▎| 147/157 [02:26<00:09,  1.02it/s]Epoch [10/10]:  94%|█████████▍| 148/157 [02:27<00:08,  1.02it/s]Epoch [10/10]:  95%|█████████▍| 149/157 [02:28<00:07,  1.02it/s]Epoch [10/10]:  96%|█████████▌| 150/157 [02:28<00:06,  1.02it/s]Epoch [10/10]:  96%|█████████▌| 151/157 [02:29<00:05,  1.02it/s]Epoch [10/10]:  97%|█████████▋| 152/157 [02:30<00:04,  1.02it/s]Epoch [10/10]:  97%|█████████▋| 153/157 [02:31<00:03,  1.02it/s]Epoch [10/10]:  98%|█████████▊| 154/157 [02:32<00:02,  1.02it/s]Epoch [10/10]:  99%|█████████▊| 155/157 [02:33<00:01,  1.02it/s]Epoch [10/10]:  99%|█████████▉| 156/157 [02:34<00:00,  1.02it/s]Epoch [10/10]: 100%|██████████| 157/157 [02:35<00:00,  1.30it/s]                                                                Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:22,  3.28s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.50s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.24s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.12s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.06s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.03s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:02,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.87s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05, 7.6531e-04, 3.0969e-03,
        5.0199e-02, 9.2474e-02, 1.1109e-01, 9.0597e-02, 5.2980e-02, 1.3714e-01])
Skip %: 4.49%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 4:
[[0.0008, 0.0], [0.0, 0.9992]]	100.00%

Correct prediction ratio for layer 5:
[[0.0031, 0.0], [0.0, 0.9969]]	100.00%

Correct prediction ratio for layer 6:
[[0.0502, 0.0], [0.0, 0.9498]]	100.00%

Correct prediction ratio for layer 7:
[[0.0925, 0.0], [0.0, 0.9075]]	100.00%

Correct prediction ratio for layer 8:
[[0.1111, 0.0], [0.0, 0.8889]]	100.00%

Correct prediction ratio for layer 9:
[[0.0906, 0.0], [0.0, 0.9094]]	100.00%

Correct prediction ratio for layer 10:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Correct prediction ratio for layer 11:
[[0.1371, 0.0], [0.0, 0.8629]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 10 epochs: 0.00%

Best accuracy: 0.0%

Epoch [1/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [1/10]:   1%|          | 1/157 [00:04<12:43,  4.89s/it]Epoch [1/10]:   1%|▏         | 2/157 [00:07<09:35,  3.71s/it]Epoch [1/10]:   2%|▏         | 3/157 [00:10<08:06,  3.16s/it]Epoch [1/10]:   3%|▎         | 4/157 [00:12<07:21,  2.88s/it]Epoch [1/10]:   3%|▎         | 5/157 [00:15<06:54,  2.73s/it]Epoch [1/10]:   4%|▍         | 6/157 [00:17<06:39,  2.65s/it]Epoch [1/10]:   4%|▍         | 7/157 [00:20<06:26,  2.58s/it]Epoch [1/10]:   5%|▌         | 8/157 [00:22<06:17,  2.53s/it]Epoch [1/10]:   6%|▌         | 9/157 [00:25<06:11,  2.51s/it]Epoch [1/10]:   6%|▋         | 10/157 [00:27<06:09,  2.51s/it]Epoch [1/10]:   7%|▋         | 11/157 [00:29<06:04,  2.49s/it]Epoch [1/10]:   8%|▊         | 12/157 [00:32<06:00,  2.48s/it]Epoch [1/10]:   8%|▊         | 13/157 [00:34<05:56,  2.47s/it]Epoch [1/10]:   9%|▉         | 14/157 [00:37<05:53,  2.47s/it]Epoch [1/10]:  10%|▉         | 15/157 [00:40<06:32,  2.76s/it]Epoch [1/10]:  10%|█         | 16/157 [00:43<06:16,  2.67s/it]Epoch [1/10]:  11%|█         | 17/157 [00:45<06:03,  2.60s/it]Epoch [1/10]:  11%|█▏        | 18/157 [00:48<05:55,  2.55s/it]Epoch [1/10]:  12%|█▏        | 19/157 [00:50<05:48,  2.52s/it]Epoch [1/10]:  13%|█▎        | 20/157 [00:53<05:42,  2.50s/it]Epoch [1/10]:  13%|█▎        | 21/157 [00:55<05:38,  2.49s/it]Epoch [1/10]:  14%|█▍        | 22/157 [00:57<05:34,  2.48s/it]Epoch [1/10]:  15%|█▍        | 23/157 [01:00<05:30,  2.47s/it]Epoch [1/10]:  15%|█▌        | 24/157 [01:02<05:28,  2.47s/it]Epoch [1/10]:  16%|█▌        | 25/157 [01:05<05:24,  2.46s/it]Epoch [1/10]:  17%|█▋        | 26/157 [01:07<05:21,  2.45s/it]Epoch [1/10]:  17%|█▋        | 27/157 [01:10<05:18,  2.45s/it]Epoch [1/10]:  18%|█▊        | 28/157 [01:12<05:16,  2.45s/it]Epoch [1/10]:  18%|█▊        | 29/157 [01:15<05:13,  2.45s/it]Epoch [1/10]:  19%|█▉        | 30/157 [01:17<05:10,  2.44s/it]Epoch [1/10]:  20%|█▉        | 31/157 [01:19<05:08,  2.45s/it]Epoch [1/10]:  20%|██        | 32/157 [01:22<05:07,  2.46s/it]Epoch [1/10]:  21%|██        | 33/157 [01:24<05:04,  2.46s/it]Epoch [1/10]:  22%|██▏       | 34/157 [01:27<05:02,  2.46s/it]Epoch [1/10]:  22%|██▏       | 35/157 [01:29<05:00,  2.46s/it]Epoch [1/10]:  23%|██▎       | 36/157 [01:32<04:58,  2.46s/it]Epoch [1/10]:  24%|██▎       | 37/157 [01:34<04:57,  2.48s/it]Epoch [1/10]:  24%|██▍       | 38/157 [01:37<04:53,  2.47s/it]Epoch [1/10]:  25%|██▍       | 39/157 [01:39<04:50,  2.46s/it]Epoch [1/10]:  25%|██▌       | 40/157 [01:42<04:47,  2.45s/it]Epoch [1/10]:  26%|██▌       | 41/157 [01:44<04:44,  2.45s/it]Epoch [1/10]:  27%|██▋       | 42/157 [01:47<04:50,  2.52s/it]Epoch [1/10]:  27%|██▋       | 43/157 [01:49<04:44,  2.49s/it]Epoch [1/10]:  28%|██▊       | 44/157 [01:52<04:39,  2.47s/it]Epoch [1/10]:  29%|██▊       | 45/157 [01:54<04:35,  2.46s/it]Epoch [1/10]:  29%|██▉       | 46/157 [01:57<04:32,  2.45s/it]Epoch [1/10]:  30%|██▉       | 47/157 [01:59<04:29,  2.45s/it]Epoch [1/10]:  31%|███       | 48/157 [02:01<04:25,  2.44s/it]Epoch [1/10]:  31%|███       | 49/157 [02:04<04:23,  2.44s/it]Epoch [1/10]:  32%|███▏      | 50/157 [02:06<04:20,  2.43s/it]Epoch [1/10]:  32%|███▏      | 51/157 [02:09<04:17,  2.43s/it]Epoch [1/10]:  33%|███▎      | 52/157 [02:11<04:15,  2.43s/it]Epoch [1/10]:  34%|███▍      | 53/157 [02:14<04:12,  2.43s/it]Epoch [1/10]:  34%|███▍      | 54/157 [02:16<04:10,  2.43s/it]Epoch [1/10]:  35%|███▌      | 55/157 [02:18<04:07,  2.42s/it]Epoch [1/10]:  36%|███▌      | 56/157 [02:21<04:04,  2.42s/it]Epoch [1/10]:  36%|███▋      | 57/157 [02:23<04:01,  2.42s/it]Epoch [1/10]:  37%|███▋      | 58/157 [02:26<03:59,  2.42s/it]Epoch [1/10]:  38%|███▊      | 59/157 [02:28<03:57,  2.42s/it]Epoch [1/10]:  38%|███▊      | 60/157 [02:30<03:54,  2.42s/it]Epoch [1/10]:  39%|███▉      | 61/157 [02:33<03:52,  2.42s/it]Epoch [1/10]:  39%|███▉      | 62/157 [02:35<03:50,  2.42s/it]Epoch [1/10]:  40%|████      | 63/157 [02:38<03:47,  2.42s/it]Epoch [1/10]:  41%|████      | 64/157 [02:40<03:45,  2.42s/it]Epoch [1/10]:  41%|████▏     | 65/157 [02:43<03:42,  2.42s/it]Epoch [1/10]:  42%|████▏     | 66/157 [02:45<03:40,  2.42s/it]Epoch [1/10]:  43%|████▎     | 67/157 [02:47<03:37,  2.42s/it]Epoch [1/10]:  43%|████▎     | 68/157 [02:50<03:35,  2.42s/it]Epoch [1/10]:  44%|████▍     | 69/157 [02:52<03:32,  2.42s/it]Epoch [1/10]:  45%|████▍     | 70/157 [02:55<03:37,  2.50s/it]Epoch [1/10]:  45%|████▌     | 71/157 [02:57<03:33,  2.48s/it]Epoch [1/10]:  46%|████▌     | 72/157 [03:00<03:28,  2.46s/it]Epoch [1/10]:  46%|████▋     | 73/157 [03:02<03:25,  2.44s/it]Epoch [1/10]:  47%|████▋     | 74/157 [03:05<03:22,  2.44s/it]Epoch [1/10]:  48%|████▊     | 75/157 [03:07<03:19,  2.43s/it]Epoch [1/10]:  48%|████▊     | 76/157 [03:09<03:16,  2.43s/it]Epoch [1/10]:  49%|████▉     | 77/157 [03:12<03:14,  2.43s/it]Epoch [1/10]:  50%|████▉     | 78/157 [03:14<03:12,  2.43s/it]Epoch [1/10]:  50%|█████     | 79/157 [03:17<03:09,  2.43s/it]Epoch [1/10]:  51%|█████     | 80/157 [03:19<03:07,  2.43s/it]Epoch [1/10]:  52%|█████▏    | 81/157 [03:22<03:04,  2.43s/it]Epoch [1/10]:  52%|█████▏    | 82/157 [03:24<03:02,  2.43s/it]Epoch [1/10]:  53%|█████▎    | 83/157 [03:26<02:59,  2.43s/it]Epoch [1/10]:  54%|█████▎    | 84/157 [03:29<02:57,  2.43s/it]Epoch [1/10]:  54%|█████▍    | 85/157 [03:31<02:54,  2.43s/it]Epoch [1/10]:  55%|█████▍    | 86/157 [03:34<02:52,  2.43s/it]Epoch [1/10]:  55%|█████▌    | 87/157 [03:36<02:49,  2.43s/it]Epoch [1/10]:  56%|█████▌    | 88/157 [03:39<02:47,  2.43s/it]Epoch [1/10]:  57%|█████▋    | 89/157 [03:41<02:44,  2.42s/it]Epoch [1/10]:  57%|█████▋    | 90/157 [03:43<02:42,  2.42s/it]Epoch [1/10]:  58%|█████▊    | 91/157 [03:46<02:39,  2.42s/it]Epoch [1/10]:  59%|█████▊    | 92/157 [03:48<02:37,  2.42s/it]Epoch [1/10]:  59%|█████▉    | 93/157 [03:51<02:34,  2.42s/it]Epoch [1/10]:  60%|█████▉    | 94/157 [03:53<02:32,  2.42s/it]Epoch [1/10]:  61%|██████    | 95/157 [03:55<02:29,  2.42s/it]Epoch [1/10]:  61%|██████    | 96/157 [03:58<02:27,  2.41s/it]Epoch [1/10]:  62%|██████▏   | 97/157 [04:00<02:24,  2.41s/it]Epoch [1/10]:  62%|██████▏   | 98/157 [04:03<02:22,  2.41s/it]Epoch [1/10]:  63%|██████▎   | 99/157 [04:05<02:24,  2.49s/it]Epoch [1/10]:  64%|██████▎   | 100/157 [04:08<02:20,  2.46s/it]Epoch [1/10]:  64%|██████▍   | 101/157 [04:10<02:17,  2.45s/it]Epoch [1/10]:  65%|██████▍   | 102/157 [04:13<02:13,  2.44s/it]Epoch [1/10]:  66%|██████▌   | 103/157 [04:15<02:11,  2.43s/it]Epoch [1/10]:  66%|██████▌   | 104/157 [04:17<02:08,  2.42s/it]Epoch [1/10]:  67%|██████▋   | 105/157 [04:20<02:06,  2.43s/it]Epoch [1/10]:  68%|██████▊   | 106/157 [04:22<02:03,  2.42s/it]Epoch [1/10]:  68%|██████▊   | 107/157 [04:25<02:00,  2.42s/it]Epoch [1/10]:  69%|██████▉   | 108/157 [04:27<01:58,  2.41s/it]Epoch [1/10]:  69%|██████▉   | 109/157 [04:30<01:55,  2.41s/it]Epoch [1/10]:  70%|███████   | 110/157 [04:32<01:53,  2.41s/it]Epoch [1/10]:  71%|███████   | 111/157 [04:34<01:50,  2.41s/it]Epoch [1/10]:  71%|███████▏  | 112/157 [04:37<01:48,  2.41s/it]Epoch [1/10]:  72%|███████▏  | 113/157 [04:39<01:46,  2.41s/it]Epoch [1/10]:  73%|███████▎  | 114/157 [04:42<01:43,  2.41s/it]Epoch [1/10]:  73%|███████▎  | 115/157 [04:44<01:41,  2.42s/it]Epoch [1/10]:  74%|███████▍  | 116/157 [04:46<01:39,  2.42s/it]Epoch [1/10]:  75%|███████▍  | 117/157 [04:49<01:36,  2.42s/it]Epoch [1/10]:  75%|███████▌  | 118/157 [04:51<01:34,  2.42s/it]Epoch [1/10]:  76%|███████▌  | 119/157 [04:54<01:31,  2.42s/it]Epoch [1/10]:  76%|███████▋  | 120/157 [04:56<01:29,  2.42s/it]Epoch [1/10]:  77%|███████▋  | 121/157 [04:59<01:26,  2.42s/it]Epoch [1/10]:  78%|███████▊  | 122/157 [05:01<01:24,  2.42s/it]Epoch [1/10]:  78%|███████▊  | 123/157 [05:03<01:22,  2.41s/it]Epoch [1/10]:  79%|███████▉  | 124/157 [05:06<01:19,  2.41s/it]Epoch [1/10]:  80%|███████▉  | 125/157 [05:08<01:17,  2.42s/it]Epoch [1/10]:  80%|████████  | 126/157 [05:11<01:14,  2.42s/it]Epoch [1/10]:  81%|████████  | 127/157 [05:13<01:12,  2.42s/it]Epoch [1/10]:  82%|████████▏ | 128/157 [05:16<01:12,  2.50s/it]Epoch [1/10]:  82%|████████▏ | 129/157 [05:18<01:09,  2.48s/it]Epoch [1/10]:  83%|████████▎ | 130/157 [05:21<01:06,  2.46s/it]Epoch [1/10]:  83%|████████▎ | 131/157 [05:23<01:03,  2.45s/it]Epoch [1/10]:  84%|████████▍ | 132/157 [05:25<01:00,  2.44s/it]Epoch [1/10]:  85%|████████▍ | 133/157 [05:28<00:58,  2.43s/it]Epoch [1/10]:  85%|████████▌ | 134/157 [05:30<00:55,  2.43s/it]Epoch [1/10]:  86%|████████▌ | 135/157 [05:33<00:53,  2.42s/it]Epoch [1/10]:  87%|████████▋ | 136/157 [05:35<00:50,  2.42s/it]Epoch [1/10]:  87%|████████▋ | 137/157 [05:37<00:48,  2.42s/it]Epoch [1/10]:  88%|████████▊ | 138/157 [05:40<00:45,  2.41s/it]Epoch [1/10]:  89%|████████▊ | 139/157 [05:42<00:43,  2.41s/it]Epoch [1/10]:  89%|████████▉ | 140/157 [05:45<00:40,  2.40s/it]Epoch [1/10]:  90%|████████▉ | 141/157 [05:47<00:38,  2.41s/it]Epoch [1/10]:  90%|█████████ | 142/157 [05:50<00:36,  2.42s/it]Epoch [1/10]:  91%|█████████ | 143/157 [05:52<00:33,  2.42s/it]Epoch [1/10]:  92%|█████████▏| 144/157 [05:54<00:31,  2.42s/it]Epoch [1/10]:  92%|█████████▏| 145/157 [05:57<00:29,  2.42s/it]Epoch [1/10]:  93%|█████████▎| 146/157 [05:59<00:26,  2.42s/it]Epoch [1/10]:  94%|█████████▎| 147/157 [06:02<00:24,  2.43s/it]Epoch [1/10]:  94%|█████████▍| 148/157 [06:04<00:21,  2.43s/it]Epoch [1/10]:  95%|█████████▍| 149/157 [06:06<00:19,  2.42s/it]Epoch [1/10]:  96%|█████████▌| 150/157 [06:09<00:16,  2.43s/it]Epoch [1/10]:  96%|█████████▌| 151/157 [06:11<00:14,  2.43s/it]Epoch [1/10]:  97%|█████████▋| 152/157 [06:14<00:12,  2.43s/it]Epoch [1/10]:  97%|█████████▋| 153/157 [06:16<00:09,  2.43s/it]Epoch [1/10]:  98%|█████████▊| 154/157 [06:19<00:07,  2.43s/it]Epoch [1/10]:  99%|█████████▊| 155/157 [06:21<00:04,  2.43s/it]Epoch [1/10]:  99%|█████████▉| 156/157 [06:24<00:02,  2.51s/it]Epoch [1/10]: 100%|██████████| 157/157 [06:24<00:00,  1.95s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:24,  3.43s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.55s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.27s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.13s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.06s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.01s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:15<00:01,  1.99s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.86s/it]                                                      Skip ratio: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0290, 0.1138, 0.0975,
        0.0949, 0.0398, 0.0390])
Skip %: 3.45%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.029, 0.0], [0.0, 0.971]]	100.00%

Correct prediction ratio for layer 7:
[[0.1138, 0.0], [0.0, 0.8862]]	100.00%

Correct prediction ratio for layer 8:
[[0.0975, 0.0], [0.0, 0.9025]]	100.00%

Correct prediction ratio for layer 9:
[[0.0949, 0.0], [0.0, 0.9051]]	100.00%

Correct prediction ratio for layer 10:
[[0.0398, 0.0], [0.0, 0.9602]]	100.00%

Correct prediction ratio for layer 11:
[[0.039, 0.0], [0.0, 0.961]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 1 epochs: 0.00%

Epoch [2/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [2/10]:   1%|          | 1/157 [00:03<09:36,  3.70s/it]Epoch [2/10]:   1%|▏         | 2/157 [00:06<07:37,  2.95s/it]Epoch [2/10]:   2%|▏         | 3/157 [00:08<06:56,  2.70s/it]Epoch [2/10]:   3%|▎         | 4/157 [00:10<06:35,  2.59s/it]Epoch [2/10]:   3%|▎         | 5/157 [00:13<06:23,  2.52s/it]Epoch [2/10]:   4%|▍         | 6/157 [00:15<06:15,  2.48s/it]Epoch [2/10]:   4%|▍         | 7/157 [00:18<06:08,  2.46s/it]Epoch [2/10]:   5%|▌         | 8/157 [00:20<06:04,  2.44s/it]Epoch [2/10]:   6%|▌         | 9/157 [00:22<06:00,  2.43s/it]Epoch [2/10]:   6%|▋         | 10/157 [00:25<05:56,  2.43s/it]Epoch [2/10]:   7%|▋         | 11/157 [00:27<05:54,  2.43s/it]Epoch [2/10]:   8%|▊         | 12/157 [00:30<05:51,  2.42s/it]Epoch [2/10]:   8%|▊         | 13/157 [00:32<05:48,  2.42s/it]Epoch [2/10]:   9%|▉         | 14/157 [00:35<05:45,  2.42s/it]Epoch [2/10]:  10%|▉         | 15/157 [00:37<05:42,  2.42s/it]Epoch [2/10]:  10%|█         | 16/157 [00:39<05:40,  2.41s/it]Epoch [2/10]:  11%|█         | 17/157 [00:42<05:37,  2.41s/it]Epoch [2/10]:  11%|█▏        | 18/157 [00:44<05:35,  2.41s/it]Epoch [2/10]:  12%|█▏        | 19/157 [00:47<05:33,  2.41s/it]Epoch [2/10]:  13%|█▎        | 20/157 [00:49<05:30,  2.41s/it]Epoch [2/10]:  13%|█▎        | 21/157 [00:51<05:27,  2.41s/it]Epoch [2/10]:  14%|█▍        | 22/157 [00:54<05:25,  2.41s/it]Epoch [2/10]:  15%|█▍        | 23/157 [00:56<05:22,  2.41s/it]Epoch [2/10]:  15%|█▌        | 24/157 [00:59<05:20,  2.41s/it]Epoch [2/10]:  16%|█▌        | 25/157 [01:01<05:18,  2.41s/it]Epoch [2/10]:  17%|█▋        | 26/157 [01:04<05:17,  2.43s/it]Epoch [2/10]:  17%|█▋        | 27/157 [01:06<05:16,  2.43s/it]Epoch [2/10]:  18%|█▊        | 28/157 [01:09<05:26,  2.53s/it]Epoch [2/10]:  18%|█▊        | 29/157 [01:11<05:19,  2.50s/it]Epoch [2/10]:  19%|█▉        | 30/157 [01:14<05:14,  2.48s/it]Epoch [2/10]:  20%|█▉        | 31/157 [01:16<05:09,  2.46s/it]Epoch [2/10]:  20%|██        | 32/157 [01:18<05:05,  2.45s/it]Epoch [2/10]:  21%|██        | 33/157 [01:21<05:02,  2.44s/it]Epoch [2/10]:  22%|██▏       | 34/157 [01:23<04:58,  2.43s/it]Epoch [2/10]:  22%|██▏       | 35/157 [01:26<04:56,  2.43s/it]Epoch [2/10]:  23%|██▎       | 36/157 [01:28<04:53,  2.43s/it]Epoch [2/10]:  24%|██▎       | 37/157 [01:31<04:50,  2.42s/it]Epoch [2/10]:  24%|██▍       | 38/157 [01:33<04:48,  2.43s/it]Epoch [2/10]:  25%|██▍       | 39/157 [01:35<04:45,  2.42s/it]Epoch [2/10]:  25%|██▌       | 40/157 [01:38<04:42,  2.42s/it]Epoch [2/10]:  26%|██▌       | 41/157 [01:40<04:40,  2.42s/it]Epoch [2/10]:  27%|██▋       | 42/157 [01:43<04:38,  2.42s/it]Epoch [2/10]:  27%|██▋       | 43/157 [01:45<04:35,  2.42s/it]Epoch [2/10]:  28%|██▊       | 44/157 [01:47<04:33,  2.42s/it]Epoch [2/10]:  29%|██▊       | 45/157 [01:50<04:30,  2.42s/it]Epoch [2/10]:  29%|██▉       | 46/157 [01:52<04:28,  2.42s/it]Epoch [2/10]:  30%|██▉       | 47/157 [01:55<04:25,  2.42s/it]Epoch [2/10]:  31%|███       | 48/157 [01:57<04:23,  2.42s/it]Epoch [2/10]:  31%|███       | 49/157 [02:00<04:22,  2.43s/it]Epoch [2/10]:  32%|███▏      | 50/157 [02:02<04:19,  2.43s/it]Epoch [2/10]:  32%|███▏      | 51/157 [02:04<04:16,  2.42s/it]Epoch [2/10]:  33%|███▎      | 52/157 [02:07<04:14,  2.42s/it]Epoch [2/10]:  34%|███▍      | 53/157 [02:09<04:11,  2.42s/it]Epoch [2/10]:  34%|███▍      | 54/157 [02:12<04:09,  2.42s/it]Epoch [2/10]:  35%|███▌      | 55/157 [02:14<04:06,  2.42s/it]Epoch [2/10]:  36%|███▌      | 56/157 [02:17<04:12,  2.50s/it]Epoch [2/10]:  36%|███▋      | 57/157 [02:19<04:07,  2.47s/it]Epoch [2/10]:  37%|███▋      | 58/157 [02:22<04:02,  2.45s/it]Epoch [2/10]:  38%|███▊      | 59/157 [02:24<03:59,  2.45s/it]Epoch [2/10]:  38%|███▊      | 60/157 [02:26<03:56,  2.44s/it]Epoch [2/10]:  39%|███▉      | 61/157 [02:29<03:53,  2.43s/it]Epoch [2/10]:  39%|███▉      | 62/157 [02:31<03:50,  2.43s/it]Epoch [2/10]:  40%|████      | 63/157 [02:34<03:47,  2.42s/it]Epoch [2/10]:  41%|████      | 64/157 [02:36<03:45,  2.42s/it]Epoch [2/10]:  41%|████▏     | 65/157 [02:39<03:42,  2.42s/it]Epoch [2/10]:  42%|████▏     | 66/157 [02:41<03:40,  2.42s/it]Epoch [2/10]:  43%|████▎     | 67/157 [02:43<03:37,  2.42s/it]Epoch [2/10]:  43%|████▎     | 68/157 [02:46<03:35,  2.42s/it]Epoch [2/10]:  44%|████▍     | 69/157 [02:48<03:32,  2.42s/it]Epoch [2/10]:  45%|████▍     | 70/157 [02:51<03:30,  2.41s/it]Epoch [2/10]:  45%|████▌     | 71/157 [02:53<03:27,  2.42s/it]Epoch [2/10]:  46%|████▌     | 72/157 [02:55<03:25,  2.41s/it]Epoch [2/10]:  46%|████▋     | 73/157 [02:58<03:23,  2.42s/it]Epoch [2/10]:  47%|████▋     | 74/157 [03:00<03:20,  2.42s/it]Epoch [2/10]:  48%|████▊     | 75/157 [03:03<03:18,  2.42s/it]Epoch [2/10]:  48%|████▊     | 76/157 [03:05<03:15,  2.42s/it]Epoch [2/10]:  49%|████▉     | 77/157 [03:08<03:13,  2.42s/it]Epoch [2/10]:  50%|████▉     | 78/157 [03:10<03:11,  2.43s/it]Epoch [2/10]:  50%|█████     | 79/157 [03:12<03:09,  2.43s/it]Epoch [2/10]:  51%|█████     | 80/157 [03:15<03:07,  2.43s/it]Epoch [2/10]:  52%|█████▏    | 81/157 [03:17<03:04,  2.43s/it]Epoch [2/10]:  52%|█████▏    | 82/157 [03:20<03:02,  2.43s/it]Epoch [2/10]:  53%|█████▎    | 83/157 [03:22<03:00,  2.43s/it]Epoch [2/10]:  54%|█████▎    | 84/157 [03:25<03:03,  2.51s/it]Epoch [2/10]:  54%|█████▍    | 85/157 [03:27<02:59,  2.49s/it]Epoch [2/10]:  55%|█████▍    | 86/157 [03:30<02:55,  2.47s/it]Epoch [2/10]:  55%|█████▌    | 87/157 [03:32<02:52,  2.46s/it]Epoch [2/10]:  56%|█████▌    | 88/157 [03:35<02:49,  2.45s/it]Epoch [2/10]:  57%|█████▋    | 89/157 [03:37<02:46,  2.45s/it]Epoch [2/10]:  57%|█████▋    | 90/157 [03:39<02:43,  2.44s/it]Epoch [2/10]:  58%|█████▊    | 91/157 [03:42<02:40,  2.43s/it]Epoch [2/10]:  59%|█████▊    | 92/157 [03:44<02:37,  2.43s/it]Epoch [2/10]:  59%|█████▉    | 93/157 [03:47<02:34,  2.42s/it]Epoch [2/10]:  60%|█████▉    | 94/157 [03:49<02:32,  2.42s/it]Epoch [2/10]:  61%|██████    | 95/157 [03:52<02:30,  2.42s/it]Epoch [2/10]:  61%|██████    | 96/157 [03:54<02:27,  2.42s/it]Epoch [2/10]:  62%|██████▏   | 97/157 [03:56<02:25,  2.42s/it]Epoch [2/10]:  62%|██████▏   | 98/157 [03:59<02:23,  2.42s/it]Epoch [2/10]:  63%|██████▎   | 99/157 [04:01<02:20,  2.42s/it]Epoch [2/10]:  64%|██████▎   | 100/157 [04:04<02:18,  2.42s/it]Epoch [2/10]:  64%|██████▍   | 101/157 [04:06<02:15,  2.42s/it]Epoch [2/10]:  65%|██████▍   | 102/157 [04:08<02:13,  2.42s/it]Epoch [2/10]:  66%|██████▌   | 103/157 [04:11<02:10,  2.42s/it]Epoch [2/10]:  66%|██████▌   | 104/157 [04:13<02:08,  2.42s/it]Epoch [2/10]:  67%|██████▋   | 105/157 [04:16<02:05,  2.42s/it]Epoch [2/10]:  68%|██████▊   | 106/157 [04:18<02:03,  2.41s/it]Epoch [2/10]:  68%|██████▊   | 107/157 [04:21<02:01,  2.42s/it]Epoch [2/10]:  69%|██████▉   | 108/157 [04:23<01:58,  2.42s/it]Epoch [2/10]:  69%|██████▉   | 109/157 [04:25<01:56,  2.42s/it]Epoch [2/10]:  70%|███████   | 110/157 [04:28<01:53,  2.41s/it]Epoch [2/10]:  71%|███████   | 111/157 [04:30<01:54,  2.49s/it]Epoch [2/10]:  71%|███████▏  | 112/157 [04:33<01:51,  2.47s/it]Epoch [2/10]:  72%|███████▏  | 113/157 [04:35<01:47,  2.45s/it]Epoch [2/10]:  73%|███████▎  | 114/157 [04:38<01:44,  2.44s/it]Epoch [2/10]:  73%|███████▎  | 115/157 [04:40<01:42,  2.43s/it]Epoch [2/10]:  74%|███████▍  | 116/157 [04:43<01:39,  2.43s/it]Epoch [2/10]:  75%|███████▍  | 117/157 [04:45<01:36,  2.42s/it]Epoch [2/10]:  75%|███████▌  | 118/157 [04:47<01:34,  2.42s/it]Epoch [2/10]:  76%|███████▌  | 119/157 [04:50<01:31,  2.42s/it]Epoch [2/10]:  76%|███████▋  | 120/157 [04:52<01:29,  2.42s/it]Epoch [2/10]:  77%|███████▋  | 121/157 [04:55<01:27,  2.43s/it]Epoch [2/10]:  78%|███████▊  | 122/157 [04:57<01:24,  2.42s/it]Epoch [2/10]:  78%|███████▊  | 123/157 [04:59<01:22,  2.42s/it]Epoch [2/10]:  79%|███████▉  | 124/157 [05:02<01:19,  2.42s/it]Epoch [2/10]:  80%|███████▉  | 125/157 [05:04<01:17,  2.42s/it]Epoch [2/10]:  80%|████████  | 126/157 [05:07<01:14,  2.41s/it]Epoch [2/10]:  81%|████████  | 127/157 [05:09<01:12,  2.41s/it]Epoch [2/10]:  82%|████████▏ | 128/157 [05:12<01:09,  2.41s/it]Epoch [2/10]:  82%|████████▏ | 129/157 [05:14<01:07,  2.41s/it]Epoch [2/10]:  83%|████████▎ | 130/157 [05:16<01:05,  2.41s/it]Epoch [2/10]:  83%|████████▎ | 131/157 [05:19<01:02,  2.41s/it]Epoch [2/10]:  84%|████████▍ | 132/157 [05:21<01:00,  2.41s/it]Epoch [2/10]:  85%|████████▍ | 133/157 [05:24<00:57,  2.41s/it]Epoch [2/10]:  85%|████████▌ | 134/157 [05:26<00:55,  2.41s/it]Epoch [2/10]:  86%|████████▌ | 135/157 [05:28<00:53,  2.41s/it]Epoch [2/10]:  87%|████████▋ | 136/157 [05:31<00:50,  2.41s/it]Epoch [2/10]:  87%|████████▋ | 137/157 [05:33<00:48,  2.41s/it]Epoch [2/10]:  88%|████████▊ | 138/157 [05:36<00:45,  2.41s/it]Epoch [2/10]:  89%|████████▊ | 139/157 [05:38<00:43,  2.41s/it]Epoch [2/10]:  89%|████████▉ | 140/157 [05:40<00:40,  2.41s/it]Epoch [2/10]:  90%|████████▉ | 141/157 [05:43<00:39,  2.49s/it]Epoch [2/10]:  90%|█████████ | 142/157 [05:45<00:36,  2.46s/it]Epoch [2/10]:  91%|█████████ | 143/157 [05:48<00:34,  2.44s/it]Epoch [2/10]:  92%|█████████▏| 144/157 [05:50<00:31,  2.44s/it]Epoch [2/10]:  92%|█████████▏| 145/157 [05:53<00:29,  2.43s/it]Epoch [2/10]:  93%|█████████▎| 146/157 [05:55<00:26,  2.43s/it]Epoch [2/10]:  94%|█████████▎| 147/157 [05:58<00:24,  2.42s/it]Epoch [2/10]:  94%|█████████▍| 148/157 [06:00<00:21,  2.42s/it]Epoch [2/10]:  95%|█████████▍| 149/157 [06:02<00:19,  2.42s/it]Epoch [2/10]:  96%|█████████▌| 150/157 [06:05<00:16,  2.42s/it]Epoch [2/10]:  96%|█████████▌| 151/157 [06:07<00:14,  2.41s/it]Epoch [2/10]:  97%|█████████▋| 152/157 [06:10<00:12,  2.41s/it]Epoch [2/10]:  97%|█████████▋| 153/157 [06:12<00:09,  2.41s/it]Epoch [2/10]:  98%|█████████▊| 154/157 [06:14<00:07,  2.41s/it]Epoch [2/10]:  99%|█████████▊| 155/157 [06:17<00:04,  2.41s/it]Epoch [2/10]:  99%|█████████▉| 156/157 [06:19<00:02,  2.41s/it]Epoch [2/10]: 100%|██████████| 157/157 [06:20<00:00,  1.87s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:24,  3.44s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.56s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.28s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.14s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.07s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.02s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:15<00:01,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.87s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 1.0204e-05, 1.7347e-04,
        2.8556e-02, 9.4505e-02, 5.6760e-02, 8.9582e-02, 4.0857e-02, 3.9903e-02])
Skip %: 2.92%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0002, 0.0], [0.0, 0.9998]]	100.00%

Correct prediction ratio for layer 6:
[[0.0286, 0.0], [0.0, 0.9714]]	100.00%

Correct prediction ratio for layer 7:
[[0.0945, 0.0], [0.0, 0.9055]]	100.00%

Correct prediction ratio for layer 8:
[[0.0568, 0.0], [0.0, 0.9432]]	100.00%

Correct prediction ratio for layer 9:
[[0.0896, 0.0], [0.0, 0.9104]]	100.00%

Correct prediction ratio for layer 10:
[[0.0409, 0.0], [0.0, 0.9591]]	100.00%

Correct prediction ratio for layer 11:
[[0.0399, 0.0], [0.0, 0.9601]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 2 epochs: 0.70%

Epoch [3/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [3/10]:   1%|          | 1/157 [00:03<10:00,  3.85s/it]Epoch [3/10]:   1%|▏         | 2/157 [00:06<07:45,  3.00s/it]Epoch [3/10]:   2%|▏         | 3/157 [00:08<07:00,  2.73s/it]Epoch [3/10]:   3%|▎         | 4/157 [00:11<06:38,  2.61s/it]Epoch [3/10]:   3%|▎         | 5/157 [00:13<06:25,  2.53s/it]Epoch [3/10]:   4%|▍         | 6/157 [00:15<06:16,  2.49s/it]Epoch [3/10]:   4%|▍         | 7/157 [00:18<06:10,  2.47s/it]Epoch [3/10]:   5%|▌         | 8/157 [00:20<06:05,  2.45s/it]Epoch [3/10]:   6%|▌         | 9/157 [00:23<06:00,  2.44s/it]Epoch [3/10]:   6%|▋         | 10/157 [00:25<05:57,  2.43s/it]Epoch [3/10]:   7%|▋         | 11/157 [00:27<05:54,  2.43s/it]Epoch [3/10]:   8%|▊         | 12/157 [00:30<05:51,  2.42s/it]Epoch [3/10]:   8%|▊         | 13/157 [00:33<06:04,  2.53s/it]Epoch [3/10]:   9%|▉         | 14/157 [00:35<05:56,  2.49s/it]Epoch [3/10]:  10%|▉         | 15/157 [00:37<05:50,  2.47s/it]Epoch [3/10]:  10%|█         | 16/157 [00:40<05:45,  2.45s/it]Epoch [3/10]:  11%|█         | 17/157 [00:42<05:41,  2.44s/it]Epoch [3/10]:  11%|█▏        | 18/157 [00:45<05:37,  2.43s/it]Epoch [3/10]:  12%|█▏        | 19/157 [00:47<05:35,  2.43s/it]Epoch [3/10]:  13%|█▎        | 20/157 [00:50<05:31,  2.42s/it]Epoch [3/10]:  13%|█▎        | 21/157 [00:52<05:29,  2.42s/it]Epoch [3/10]:  14%|█▍        | 22/157 [00:54<05:26,  2.42s/it]Epoch [3/10]:  15%|█▍        | 23/157 [00:57<05:23,  2.41s/it]Epoch [3/10]:  15%|█▌        | 24/157 [00:59<05:20,  2.41s/it]Epoch [3/10]:  16%|█▌        | 25/157 [01:02<05:18,  2.41s/it]Epoch [3/10]:  17%|█▋        | 26/157 [01:04<05:16,  2.41s/it]Epoch [3/10]:  17%|█▋        | 27/157 [01:06<05:14,  2.42s/it]Epoch [3/10]:  18%|█▊        | 28/157 [01:09<05:11,  2.41s/it]Epoch [3/10]:  18%|█▊        | 29/157 [01:11<05:08,  2.41s/it]Epoch [3/10]:  19%|█▉        | 30/157 [01:14<05:06,  2.41s/it]Epoch [3/10]:  20%|█▉        | 31/157 [01:16<05:03,  2.41s/it]Epoch [3/10]:  20%|██        | 32/157 [01:18<05:01,  2.41s/it]Epoch [3/10]:  21%|██        | 33/157 [01:21<04:59,  2.41s/it]Epoch [3/10]:  22%|██▏       | 34/157 [01:23<04:57,  2.42s/it]Epoch [3/10]:  22%|██▏       | 35/157 [01:26<04:55,  2.42s/it]Epoch [3/10]:  23%|██▎       | 36/157 [01:28<04:52,  2.42s/it]Epoch [3/10]:  24%|██▎       | 37/157 [01:31<04:50,  2.42s/it]Epoch [3/10]:  24%|██▍       | 38/157 [01:33<04:47,  2.42s/it]Epoch [3/10]:  25%|██▍       | 39/157 [01:35<04:45,  2.42s/it]Epoch [3/10]:  25%|██▌       | 40/157 [01:38<04:42,  2.41s/it]Epoch [3/10]:  26%|██▌       | 41/157 [01:41<04:49,  2.50s/it]Epoch [3/10]:  27%|██▋       | 42/157 [01:43<04:44,  2.47s/it]Epoch [3/10]:  27%|██▋       | 43/157 [01:45<04:39,  2.45s/it]Epoch [3/10]:  28%|██▊       | 44/157 [01:48<04:35,  2.44s/it]Epoch [3/10]:  29%|██▊       | 45/157 [01:50<04:32,  2.43s/it]Epoch [3/10]:  29%|██▉       | 46/157 [01:53<04:29,  2.42s/it]Epoch [3/10]:  30%|██▉       | 47/157 [01:55<04:26,  2.42s/it]Epoch [3/10]:  31%|███       | 48/157 [01:57<04:23,  2.42s/it]Epoch [3/10]:  31%|███       | 49/157 [02:00<04:21,  2.42s/it]Epoch [3/10]:  32%|███▏      | 50/157 [02:02<04:18,  2.42s/it]Epoch [3/10]:  32%|███▏      | 51/157 [02:05<04:16,  2.42s/it]Epoch [3/10]:  33%|███▎      | 52/157 [02:07<04:13,  2.41s/it]Epoch [3/10]:  34%|███▍      | 53/157 [02:09<04:11,  2.41s/it]Epoch [3/10]:  34%|███▍      | 54/157 [02:12<04:08,  2.41s/it]Epoch [3/10]:  35%|███▌      | 55/157 [02:14<04:06,  2.41s/it]Epoch [3/10]:  36%|███▌      | 56/157 [02:17<04:03,  2.41s/it]Epoch [3/10]:  36%|███▋      | 57/157 [02:19<04:01,  2.41s/it]Epoch [3/10]:  37%|███▋      | 58/157 [02:22<03:58,  2.41s/it]Epoch [3/10]:  38%|███▊      | 59/157 [02:24<03:56,  2.42s/it]Epoch [3/10]:  38%|███▊      | 60/157 [02:26<03:54,  2.42s/it]Epoch [3/10]:  39%|███▉      | 61/157 [02:29<03:52,  2.42s/it]Epoch [3/10]:  39%|███▉      | 62/157 [02:31<03:49,  2.42s/it]Epoch [3/10]:  40%|████      | 63/157 [02:34<03:47,  2.42s/it]Epoch [3/10]:  41%|████      | 64/157 [02:36<03:44,  2.42s/it]Epoch [3/10]:  41%|████▏     | 65/157 [02:38<03:42,  2.41s/it]Epoch [3/10]:  42%|████▏     | 66/157 [02:41<03:39,  2.41s/it]Epoch [3/10]:  43%|████▎     | 67/157 [02:43<03:37,  2.41s/it]Epoch [3/10]:  43%|████▎     | 68/157 [02:46<03:41,  2.49s/it]Epoch [3/10]:  44%|████▍     | 69/157 [02:48<03:37,  2.47s/it]Epoch [3/10]:  45%|████▍     | 70/157 [02:51<03:33,  2.45s/it]Epoch [3/10]:  45%|████▌     | 71/157 [02:53<03:29,  2.44s/it]Epoch [3/10]:  46%|████▌     | 72/157 [02:56<03:26,  2.43s/it]Epoch [3/10]:  46%|████▋     | 73/157 [02:58<03:24,  2.43s/it]Epoch [3/10]:  47%|████▋     | 74/157 [03:00<03:21,  2.42s/it]Epoch [3/10]:  48%|████▊     | 75/157 [03:03<03:18,  2.42s/it]Epoch [3/10]:  48%|████▊     | 76/157 [03:05<03:15,  2.41s/it]Epoch [3/10]:  49%|████▉     | 77/157 [03:08<03:12,  2.41s/it]Epoch [3/10]:  50%|████▉     | 78/157 [03:10<03:10,  2.41s/it]Epoch [3/10]:  50%|█████     | 79/157 [03:12<03:08,  2.41s/it]Epoch [3/10]:  51%|█████     | 80/157 [03:15<03:05,  2.41s/it]Epoch [3/10]:  52%|█████▏    | 81/157 [03:17<03:03,  2.41s/it]Epoch [3/10]:  52%|█████▏    | 82/157 [03:20<03:00,  2.41s/it]Epoch [3/10]:  53%|█████▎    | 83/157 [03:22<02:58,  2.42s/it]Epoch [3/10]:  54%|█████▎    | 84/157 [03:25<02:56,  2.42s/it]Epoch [3/10]:  54%|█████▍    | 85/157 [03:27<02:54,  2.42s/it]Epoch [3/10]:  55%|█████▍    | 86/157 [03:29<02:51,  2.42s/it]Epoch [3/10]:  55%|█████▌    | 87/157 [03:32<02:49,  2.42s/it]Epoch [3/10]:  56%|█████▌    | 88/157 [03:34<02:46,  2.42s/it]Epoch [3/10]:  57%|█████▋    | 89/157 [03:37<02:44,  2.41s/it]Epoch [3/10]:  57%|█████▋    | 90/157 [03:39<02:41,  2.41s/it]Epoch [3/10]:  58%|█████▊    | 91/157 [03:41<02:39,  2.41s/it]Epoch [3/10]:  59%|█████▊    | 92/157 [03:44<02:36,  2.41s/it]Epoch [3/10]:  59%|█████▉    | 93/157 [03:46<02:34,  2.41s/it]Epoch [3/10]:  60%|█████▉    | 94/157 [03:49<02:31,  2.41s/it]Epoch [3/10]:  61%|██████    | 95/157 [03:51<02:29,  2.42s/it]Epoch [3/10]:  61%|██████    | 96/157 [03:54<02:27,  2.41s/it]Epoch [3/10]:  62%|██████▏   | 97/157 [03:56<02:30,  2.50s/it]Epoch [3/10]:  62%|██████▏   | 98/157 [03:59<02:25,  2.47s/it]Epoch [3/10]:  63%|██████▎   | 99/157 [04:01<02:22,  2.46s/it]Epoch [3/10]:  64%|██████▎   | 100/157 [04:03<02:19,  2.44s/it]Epoch [3/10]:  64%|██████▍   | 101/157 [04:06<02:16,  2.43s/it]Epoch [3/10]:  65%|██████▍   | 102/157 [04:08<02:13,  2.43s/it]Epoch [3/10]:  66%|██████▌   | 103/157 [04:11<02:10,  2.42s/it]Epoch [3/10]:  66%|██████▌   | 104/157 [04:13<02:08,  2.42s/it]Epoch [3/10]:  67%|██████▋   | 105/157 [04:16<02:05,  2.42s/it]Epoch [3/10]:  68%|██████▊   | 106/157 [04:18<02:03,  2.42s/it]Epoch [3/10]:  68%|██████▊   | 107/157 [04:20<02:00,  2.41s/it]Epoch [3/10]:  69%|██████▉   | 108/157 [04:23<01:58,  2.41s/it]Epoch [3/10]:  69%|██████▉   | 109/157 [04:25<01:56,  2.42s/it]Epoch [3/10]:  70%|███████   | 110/157 [04:28<01:53,  2.42s/it]Epoch [3/10]:  71%|███████   | 111/157 [04:30<01:51,  2.41s/it]Epoch [3/10]:  71%|███████▏  | 112/157 [04:32<01:48,  2.41s/it]Epoch [3/10]:  72%|███████▏  | 113/157 [04:35<01:46,  2.41s/it]Epoch [3/10]:  73%|███████▎  | 114/157 [04:37<01:43,  2.41s/it]Epoch [3/10]:  73%|███████▎  | 115/157 [04:40<01:41,  2.41s/it]Epoch [3/10]:  74%|███████▍  | 116/157 [04:42<01:38,  2.41s/it]Epoch [3/10]:  75%|███████▍  | 117/157 [04:44<01:36,  2.41s/it]Epoch [3/10]:  75%|███████▌  | 118/157 [04:47<01:34,  2.41s/it]Epoch [3/10]:  76%|███████▌  | 119/157 [04:49<01:31,  2.41s/it]Epoch [3/10]:  76%|███████▋  | 120/157 [04:52<01:29,  2.42s/it]Epoch [3/10]:  77%|███████▋  | 121/157 [04:54<01:26,  2.42s/it]Epoch [3/10]:  78%|███████▊  | 122/157 [04:57<01:24,  2.41s/it]Epoch [3/10]:  78%|███████▊  | 123/157 [04:59<01:21,  2.41s/it]Epoch [3/10]:  79%|███████▉  | 124/157 [05:01<01:19,  2.41s/it]Epoch [3/10]:  80%|███████▉  | 125/157 [05:04<01:17,  2.41s/it]Epoch [3/10]:  80%|████████  | 126/157 [05:06<01:14,  2.41s/it]Epoch [3/10]:  81%|████████  | 127/157 [05:09<01:14,  2.49s/it]Epoch [3/10]:  82%|████████▏ | 128/157 [05:11<01:11,  2.46s/it]Epoch [3/10]:  82%|████████▏ | 129/157 [05:14<01:08,  2.45s/it]Epoch [3/10]:  83%|████████▎ | 130/157 [05:16<01:05,  2.43s/it]Epoch [3/10]:  83%|████████▎ | 131/157 [05:18<01:03,  2.43s/it]Epoch [3/10]:  84%|████████▍ | 132/157 [05:21<01:00,  2.43s/it]Epoch [3/10]:  85%|████████▍ | 133/157 [05:23<00:58,  2.42s/it]Epoch [3/10]:  85%|████████▌ | 134/157 [05:26<00:55,  2.42s/it]Epoch [3/10]:  86%|████████▌ | 135/157 [05:28<00:53,  2.42s/it]Epoch [3/10]:  87%|████████▋ | 136/157 [05:31<00:50,  2.42s/it]Epoch [3/10]:  87%|████████▋ | 137/157 [05:33<00:48,  2.41s/it]Epoch [3/10]:  88%|████████▊ | 138/157 [05:35<00:45,  2.41s/it]Epoch [3/10]:  89%|████████▊ | 139/157 [05:38<00:43,  2.41s/it]Epoch [3/10]:  89%|████████▉ | 140/157 [05:40<00:40,  2.41s/it]Epoch [3/10]:  90%|████████▉ | 141/157 [05:43<00:38,  2.41s/it]Epoch [3/10]:  90%|█████████ | 142/157 [05:45<00:36,  2.40s/it]Epoch [3/10]:  91%|█████████ | 143/157 [05:47<00:33,  2.40s/it]Epoch [3/10]:  92%|█████████▏| 144/157 [05:50<00:31,  2.41s/it]Epoch [3/10]:  92%|█████████▏| 145/157 [05:52<00:28,  2.41s/it]Epoch [3/10]:  93%|█████████▎| 146/157 [05:55<00:26,  2.41s/it]Epoch [3/10]:  94%|█████████▎| 147/157 [05:57<00:24,  2.41s/it]Epoch [3/10]:  94%|█████████▍| 148/157 [05:59<00:21,  2.41s/it]Epoch [3/10]:  95%|█████████▍| 149/157 [06:02<00:19,  2.40s/it]Epoch [3/10]:  96%|█████████▌| 150/157 [06:04<00:16,  2.40s/it]Epoch [3/10]:  96%|█████████▌| 151/157 [06:07<00:14,  2.40s/it]Epoch [3/10]:  97%|█████████▋| 152/157 [06:09<00:12,  2.40s/it]Epoch [3/10]:  97%|█████████▋| 153/157 [06:11<00:09,  2.40s/it]Epoch [3/10]:  98%|█████████▊| 154/157 [06:14<00:07,  2.49s/it]Epoch [3/10]:  99%|█████████▊| 155/157 [06:17<00:04,  2.46s/it]Epoch [3/10]:  99%|█████████▉| 156/157 [06:19<00:02,  2.45s/it]Epoch [3/10]: 100%|██████████| 157/157 [06:20<00:00,  1.90s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:22,  3.26s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.48s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.23s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.11s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:10<00:06,  2.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:04,  2.01s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.98s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0327, 0.0901, 0.0558,
        0.0600, 0.0459, 0.0450])
Skip %: 2.75%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.0327, 0.0], [0.0, 0.9673]]	100.00%

Correct prediction ratio for layer 7:
[[0.0901, 0.0], [0.0, 0.9099]]	100.00%

Correct prediction ratio for layer 8:
[[0.0558, 0.0], [0.0, 0.9442]]	100.00%

Correct prediction ratio for layer 9:
[[0.06, 0.0], [0.0, 0.94]]	100.00%

Correct prediction ratio for layer 10:
[[0.0459, 0.0], [0.0, 0.9541]]	100.00%

Correct prediction ratio for layer 11:
[[0.045, 0.0], [0.0, 0.955]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 3 epochs: 0.30%

Epoch [4/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [4/10]:   1%|          | 1/157 [00:03<10:07,  3.89s/it]Epoch [4/10]:   1%|▏         | 2/157 [00:06<07:48,  3.02s/it]Epoch [4/10]:   2%|▏         | 3/157 [00:08<07:01,  2.74s/it]Epoch [4/10]:   3%|▎         | 4/157 [00:11<06:38,  2.60s/it]Epoch [4/10]:   3%|▎         | 5/157 [00:13<06:25,  2.54s/it]Epoch [4/10]:   4%|▍         | 6/157 [00:15<06:16,  2.49s/it]Epoch [4/10]:   4%|▍         | 7/157 [00:18<06:09,  2.46s/it]Epoch [4/10]:   5%|▌         | 8/157 [00:20<06:04,  2.45s/it]Epoch [4/10]:   6%|▌         | 9/157 [00:23<06:00,  2.44s/it]Epoch [4/10]:   6%|▋         | 10/157 [00:25<05:57,  2.43s/it]Epoch [4/10]:   7%|▋         | 11/157 [00:27<05:53,  2.42s/it]Epoch [4/10]:   8%|▊         | 12/157 [00:30<05:51,  2.42s/it]Epoch [4/10]:   8%|▊         | 13/157 [00:32<05:48,  2.42s/it]Epoch [4/10]:   9%|▉         | 14/157 [00:35<05:45,  2.42s/it]Epoch [4/10]:  10%|▉         | 15/157 [00:37<05:44,  2.42s/it]Epoch [4/10]:  10%|█         | 16/157 [00:40<05:41,  2.42s/it]Epoch [4/10]:  11%|█         | 17/157 [00:42<05:38,  2.42s/it]Epoch [4/10]:  11%|█▏        | 18/157 [00:44<05:37,  2.43s/it]Epoch [4/10]:  12%|█▏        | 19/157 [00:47<05:35,  2.43s/it]Epoch [4/10]:  13%|█▎        | 20/157 [00:49<05:32,  2.43s/it]Epoch [4/10]:  13%|█▎        | 21/157 [00:52<05:31,  2.44s/it]Epoch [4/10]:  14%|█▍        | 22/157 [00:54<05:28,  2.43s/it]Epoch [4/10]:  15%|█▍        | 23/157 [00:57<05:26,  2.44s/it]Epoch [4/10]:  15%|█▌        | 24/157 [00:59<05:23,  2.43s/it]Epoch [4/10]:  16%|█▌        | 25/157 [01:01<05:20,  2.43s/it]Epoch [4/10]:  17%|█▋        | 26/157 [01:04<05:30,  2.52s/it]Epoch [4/10]:  17%|█▋        | 27/157 [01:07<05:24,  2.50s/it]Epoch [4/10]:  18%|█▊        | 28/157 [01:09<05:18,  2.47s/it]Epoch [4/10]:  18%|█▊        | 29/157 [01:12<05:15,  2.46s/it]Epoch [4/10]:  19%|█▉        | 30/157 [01:14<05:10,  2.45s/it]Epoch [4/10]:  20%|█▉        | 31/157 [01:16<05:07,  2.44s/it]Epoch [4/10]:  20%|██        | 32/157 [01:19<05:03,  2.43s/it]Epoch [4/10]:  21%|██        | 33/157 [01:21<05:01,  2.43s/it]Epoch [4/10]:  22%|██▏       | 34/157 [01:24<04:58,  2.43s/it]Epoch [4/10]:  22%|██▏       | 35/157 [01:26<04:55,  2.42s/it]Epoch [4/10]:  23%|██▎       | 36/157 [01:28<04:52,  2.42s/it]Epoch [4/10]:  24%|██▎       | 37/157 [01:31<04:51,  2.43s/it]Epoch [4/10]:  24%|██▍       | 38/157 [01:33<04:48,  2.42s/it]Epoch [4/10]:  25%|██▍       | 39/157 [01:36<04:45,  2.42s/it]Epoch [4/10]:  25%|██▌       | 40/157 [01:38<04:42,  2.42s/it]Epoch [4/10]:  26%|██▌       | 41/157 [01:41<04:41,  2.43s/it]Epoch [4/10]:  27%|██▋       | 42/157 [01:43<04:38,  2.42s/it]Epoch [4/10]:  27%|██▋       | 43/157 [01:45<04:35,  2.42s/it]Epoch [4/10]:  28%|██▊       | 44/157 [01:48<04:33,  2.42s/it]Epoch [4/10]:  29%|██▊       | 45/157 [01:50<04:30,  2.42s/it]Epoch [4/10]:  29%|██▉       | 46/157 [01:53<04:28,  2.42s/it]Epoch [4/10]:  30%|██▉       | 47/157 [01:55<04:26,  2.42s/it]Epoch [4/10]:  31%|███       | 48/157 [01:57<04:23,  2.42s/it]Epoch [4/10]:  31%|███       | 49/157 [02:00<04:21,  2.42s/it]Epoch [4/10]:  32%|███▏      | 50/157 [02:02<04:18,  2.42s/it]Epoch [4/10]:  32%|███▏      | 51/157 [02:05<04:16,  2.42s/it]Epoch [4/10]:  33%|███▎      | 52/157 [02:07<04:13,  2.42s/it]Epoch [4/10]:  34%|███▍      | 53/157 [02:10<04:11,  2.42s/it]Epoch [4/10]:  34%|███▍      | 54/157 [02:12<04:09,  2.42s/it]Epoch [4/10]:  35%|███▌      | 55/157 [02:15<04:15,  2.50s/it]Epoch [4/10]:  36%|███▌      | 56/157 [02:17<04:09,  2.47s/it]Epoch [4/10]:  36%|███▋      | 57/157 [02:20<04:05,  2.46s/it]Epoch [4/10]:  37%|███▋      | 58/157 [02:22<04:02,  2.44s/it]Epoch [4/10]:  38%|███▊      | 59/157 [02:24<03:59,  2.44s/it]Epoch [4/10]:  38%|███▊      | 60/157 [02:27<03:55,  2.43s/it]Epoch [4/10]:  39%|███▉      | 61/157 [02:29<03:53,  2.43s/it]Epoch [4/10]:  39%|███▉      | 62/157 [02:32<03:50,  2.42s/it]Epoch [4/10]:  40%|████      | 63/157 [02:34<03:47,  2.42s/it]Epoch [4/10]:  41%|████      | 64/157 [02:36<03:44,  2.42s/it]Epoch [4/10]:  41%|████▏     | 65/157 [02:39<03:42,  2.42s/it]Epoch [4/10]:  42%|████▏     | 66/157 [02:41<03:40,  2.42s/it]Epoch [4/10]:  43%|████▎     | 67/157 [02:44<03:37,  2.42s/it]Epoch [4/10]:  43%|████▎     | 68/157 [02:46<03:35,  2.42s/it]Epoch [4/10]:  44%|████▍     | 69/157 [02:49<03:32,  2.42s/it]Epoch [4/10]:  45%|████▍     | 70/157 [02:51<03:29,  2.41s/it]Epoch [4/10]:  45%|████▌     | 71/157 [02:53<03:27,  2.41s/it]Epoch [4/10]:  46%|████▌     | 72/157 [02:56<03:24,  2.41s/it]Epoch [4/10]:  46%|████▋     | 73/157 [02:58<03:22,  2.41s/it]Epoch [4/10]:  47%|████▋     | 74/157 [03:01<03:20,  2.42s/it]Epoch [4/10]:  48%|████▊     | 75/157 [03:03<03:17,  2.41s/it]Epoch [4/10]:  48%|████▊     | 76/157 [03:05<03:15,  2.41s/it]Epoch [4/10]:  49%|████▉     | 77/157 [03:08<03:12,  2.41s/it]Epoch [4/10]:  50%|████▉     | 78/157 [03:10<03:10,  2.41s/it]Epoch [4/10]:  50%|█████     | 79/157 [03:13<03:07,  2.41s/it]Epoch [4/10]:  51%|█████     | 80/157 [03:15<03:05,  2.41s/it]Epoch [4/10]:  52%|█████▏    | 81/157 [03:17<03:03,  2.42s/it]Epoch [4/10]:  52%|█████▏    | 82/157 [03:20<03:01,  2.42s/it]Epoch [4/10]:  53%|█████▎    | 83/157 [03:22<02:58,  2.42s/it]Epoch [4/10]:  54%|█████▎    | 84/157 [03:25<02:56,  2.41s/it]Epoch [4/10]:  54%|█████▍    | 85/157 [03:27<02:59,  2.49s/it]Epoch [4/10]:  55%|█████▍    | 86/157 [03:30<02:55,  2.47s/it]Epoch [4/10]:  55%|█████▌    | 87/157 [03:32<02:51,  2.45s/it]Epoch [4/10]:  56%|█████▌    | 88/157 [03:35<02:47,  2.43s/it]Epoch [4/10]:  57%|█████▋    | 89/157 [03:37<02:44,  2.42s/it]Epoch [4/10]:  57%|█████▋    | 90/157 [03:39<02:42,  2.42s/it]Epoch [4/10]:  58%|█████▊    | 91/157 [03:42<02:39,  2.42s/it]Epoch [4/10]:  59%|█████▊    | 92/157 [03:44<02:37,  2.42s/it]Epoch [4/10]:  59%|█████▉    | 93/157 [03:47<02:34,  2.42s/it]Epoch [4/10]:  60%|█████▉    | 94/157 [03:49<02:32,  2.42s/it]Epoch [4/10]:  61%|██████    | 95/157 [03:51<02:29,  2.41s/it]Epoch [4/10]:  61%|██████    | 96/157 [03:54<02:27,  2.41s/it]Epoch [4/10]:  62%|██████▏   | 97/157 [03:56<02:24,  2.41s/it]Epoch [4/10]:  62%|██████▏   | 98/157 [03:59<02:22,  2.41s/it]Epoch [4/10]:  63%|██████▎   | 99/157 [04:01<02:19,  2.41s/it]Epoch [4/10]:  64%|██████▎   | 100/157 [04:03<02:17,  2.41s/it]Epoch [4/10]:  64%|██████▍   | 101/157 [04:06<02:14,  2.41s/it]Epoch [4/10]:  65%|██████▍   | 102/157 [04:08<02:12,  2.41s/it]Epoch [4/10]:  66%|██████▌   | 103/157 [04:11<02:10,  2.42s/it]Epoch [4/10]:  66%|██████▌   | 104/157 [04:13<02:08,  2.42s/it]Epoch [4/10]:  67%|██████▋   | 105/157 [04:16<02:05,  2.42s/it]Epoch [4/10]:  68%|██████▊   | 106/157 [04:18<02:03,  2.42s/it]Epoch [4/10]:  68%|██████▊   | 107/157 [04:20<02:00,  2.41s/it]Epoch [4/10]:  69%|██████▉   | 108/157 [04:23<01:58,  2.41s/it]Epoch [4/10]:  69%|██████▉   | 109/157 [04:25<01:56,  2.43s/it]Epoch [4/10]:  70%|███████   | 110/157 [04:28<01:54,  2.44s/it]Epoch [4/10]:  71%|███████   | 111/157 [04:30<01:53,  2.46s/it]Epoch [4/10]:  71%|███████▏  | 112/157 [04:33<01:50,  2.46s/it]Epoch [4/10]:  72%|███████▏  | 113/157 [04:35<01:51,  2.53s/it]Epoch [4/10]:  73%|███████▎  | 114/157 [04:38<01:47,  2.50s/it]Epoch [4/10]:  73%|███████▎  | 115/157 [04:40<01:44,  2.48s/it]Epoch [4/10]:  74%|███████▍  | 116/157 [04:43<01:41,  2.46s/it]Epoch [4/10]:  75%|███████▍  | 117/157 [04:45<01:38,  2.45s/it]Epoch [4/10]:  75%|███████▌  | 118/157 [04:48<01:35,  2.45s/it]Epoch [4/10]:  76%|███████▌  | 119/157 [04:50<01:32,  2.44s/it]Epoch [4/10]:  76%|███████▋  | 120/157 [04:52<01:30,  2.43s/it]Epoch [4/10]:  77%|███████▋  | 121/157 [04:55<01:27,  2.43s/it]Epoch [4/10]:  78%|███████▊  | 122/157 [04:57<01:24,  2.43s/it]Epoch [4/10]:  78%|███████▊  | 123/157 [05:00<01:22,  2.43s/it]Epoch [4/10]:  79%|███████▉  | 124/157 [05:02<01:20,  2.43s/it]Epoch [4/10]:  80%|███████▉  | 125/157 [05:05<01:17,  2.42s/it]Epoch [4/10]:  80%|████████  | 126/157 [05:07<01:15,  2.42s/it]Epoch [4/10]:  81%|████████  | 127/157 [05:09<01:12,  2.42s/it]Epoch [4/10]:  82%|████████▏ | 128/157 [05:12<01:10,  2.42s/it]Epoch [4/10]:  82%|████████▏ | 129/157 [05:14<01:07,  2.42s/it]Epoch [4/10]:  83%|████████▎ | 130/157 [05:17<01:05,  2.42s/it]Epoch [4/10]:  83%|████████▎ | 131/157 [05:19<01:02,  2.42s/it]Epoch [4/10]:  84%|████████▍ | 132/157 [05:21<01:00,  2.42s/it]Epoch [4/10]:  85%|████████▍ | 133/157 [05:24<00:58,  2.42s/it]Epoch [4/10]:  85%|████████▌ | 134/157 [05:26<00:55,  2.42s/it]Epoch [4/10]:  86%|████████▌ | 135/157 [05:29<00:53,  2.42s/it]Epoch [4/10]:  87%|████████▋ | 136/157 [05:31<00:50,  2.42s/it]Epoch [4/10]:  87%|████████▋ | 137/157 [05:34<00:48,  2.41s/it]Epoch [4/10]:  88%|████████▊ | 138/157 [05:36<00:45,  2.41s/it]Epoch [4/10]:  89%|████████▊ | 139/157 [05:39<00:44,  2.50s/it]Epoch [4/10]:  89%|████████▉ | 140/157 [05:41<00:42,  2.47s/it]Epoch [4/10]:  90%|████████▉ | 141/157 [05:43<00:39,  2.46s/it]Epoch [4/10]:  90%|█████████ | 142/157 [05:46<00:36,  2.45s/it]Epoch [4/10]:  91%|█████████ | 143/157 [05:48<00:34,  2.43s/it]Epoch [4/10]:  92%|█████████▏| 144/157 [05:51<00:31,  2.42s/it]Epoch [4/10]:  92%|█████████▏| 145/157 [05:53<00:28,  2.42s/it]Epoch [4/10]:  93%|█████████▎| 146/157 [05:56<00:26,  2.41s/it]Epoch [4/10]:  94%|█████████▎| 147/157 [05:58<00:24,  2.41s/it]Epoch [4/10]:  94%|█████████▍| 148/157 [06:00<00:21,  2.41s/it]Epoch [4/10]:  95%|█████████▍| 149/157 [06:03<00:19,  2.41s/it]Epoch [4/10]:  96%|█████████▌| 150/157 [06:05<00:16,  2.41s/it]Epoch [4/10]:  96%|█████████▌| 151/157 [06:08<00:14,  2.41s/it]Epoch [4/10]:  97%|█████████▋| 152/157 [06:10<00:12,  2.41s/it]Epoch [4/10]:  97%|█████████▋| 153/157 [06:12<00:09,  2.41s/it]Epoch [4/10]:  98%|█████████▊| 154/157 [06:15<00:07,  2.41s/it]Epoch [4/10]:  99%|█████████▊| 155/157 [06:17<00:04,  2.41s/it]Epoch [4/10]:  99%|█████████▉| 156/157 [06:20<00:02,  2.42s/it]Epoch [4/10]: 100%|██████████| 157/157 [06:20<00:00,  1.88s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:22,  3.26s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.47s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.22s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.10s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:10<00:06,  2.03s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:03,  1.99s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.97s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.84s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 8.6735e-05,
        3.6321e-02, 7.5617e-02, 5.7189e-02, 5.8005e-02, 4.9750e-02, 4.9077e-02])
Skip %: 2.72%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.0363, 0.0], [0.0, 0.9637]]	100.00%

Correct prediction ratio for layer 7:
[[0.0756, 0.0], [0.0, 0.9244]]	100.00%

Correct prediction ratio for layer 8:
[[0.0572, 0.0], [0.0, 0.9428]]	100.00%

Correct prediction ratio for layer 9:
[[0.058, 0.0], [0.0, 0.942]]	100.00%

Correct prediction ratio for layer 10:
[[0.0498, 0.0], [0.0, 0.9503]]	100.00%

Correct prediction ratio for layer 11:
[[0.0491, 0.0], [0.0, 0.9509]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 4 epochs: 0.70%

Epoch [5/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [5/10]:   1%|          | 1/157 [00:03<09:51,  3.79s/it]Epoch [5/10]:   1%|▏         | 2/157 [00:06<07:40,  2.97s/it]Epoch [5/10]:   2%|▏         | 3/157 [00:08<07:01,  2.74s/it]Epoch [5/10]:   3%|▎         | 4/157 [00:11<06:40,  2.62s/it]Epoch [5/10]:   3%|▎         | 5/157 [00:13<06:27,  2.55s/it]Epoch [5/10]:   4%|▍         | 6/157 [00:15<06:19,  2.51s/it]Epoch [5/10]:   4%|▍         | 7/157 [00:18<06:13,  2.49s/it]Epoch [5/10]:   5%|▌         | 8/157 [00:20<06:06,  2.46s/it]Epoch [5/10]:   6%|▌         | 9/157 [00:23<06:02,  2.45s/it]Epoch [5/10]:   6%|▋         | 10/157 [00:25<05:57,  2.44s/it]Epoch [5/10]:   7%|▋         | 11/157 [00:28<05:53,  2.42s/it]Epoch [5/10]:   8%|▊         | 12/157 [00:30<06:04,  2.52s/it]Epoch [5/10]:   8%|▊         | 13/157 [00:33<05:57,  2.48s/it]Epoch [5/10]:   9%|▉         | 14/157 [00:35<05:51,  2.46s/it]Epoch [5/10]:  10%|▉         | 15/157 [00:37<05:46,  2.44s/it]Epoch [5/10]:  10%|█         | 16/157 [00:40<05:42,  2.43s/it]Epoch [5/10]:  11%|█         | 17/157 [00:42<05:39,  2.43s/it]Epoch [5/10]:  11%|█▏        | 18/157 [00:45<05:36,  2.42s/it]Epoch [5/10]:  12%|█▏        | 19/157 [00:47<05:33,  2.41s/it]Epoch [5/10]:  13%|█▎        | 20/157 [00:49<05:30,  2.42s/it]Epoch [5/10]:  13%|█▎        | 21/157 [00:52<05:29,  2.42s/it]Epoch [5/10]:  14%|█▍        | 22/157 [00:54<05:27,  2.43s/it]Epoch [5/10]:  15%|█▍        | 23/157 [00:57<05:24,  2.42s/it]Epoch [5/10]:  15%|█▌        | 24/157 [00:59<05:22,  2.42s/it]Epoch [5/10]:  16%|█▌        | 25/157 [01:02<05:19,  2.42s/it]Epoch [5/10]:  17%|█▋        | 26/157 [01:04<05:17,  2.42s/it]Epoch [5/10]:  17%|█▋        | 27/157 [01:06<05:14,  2.42s/it]Epoch [5/10]:  18%|█▊        | 28/157 [01:09<05:11,  2.41s/it]Epoch [5/10]:  18%|█▊        | 29/157 [01:11<05:08,  2.41s/it]Epoch [5/10]:  19%|█▉        | 30/157 [01:14<05:05,  2.41s/it]Epoch [5/10]:  20%|█▉        | 31/157 [01:16<05:03,  2.41s/it]Epoch [5/10]:  20%|██        | 32/157 [01:18<05:00,  2.41s/it]Epoch [5/10]:  21%|██        | 33/157 [01:21<04:59,  2.41s/it]Epoch [5/10]:  22%|██▏       | 34/157 [01:23<04:56,  2.41s/it]Epoch [5/10]:  22%|██▏       | 35/157 [01:26<04:54,  2.41s/it]Epoch [5/10]:  23%|██▎       | 36/157 [01:28<04:51,  2.41s/it]Epoch [5/10]:  24%|██▎       | 37/157 [01:31<04:48,  2.41s/it]Epoch [5/10]:  24%|██▍       | 38/157 [01:33<04:46,  2.41s/it]Epoch [5/10]:  25%|██▍       | 39/157 [01:35<04:44,  2.41s/it]Epoch [5/10]:  25%|██▌       | 40/157 [01:38<04:42,  2.41s/it]Epoch [5/10]:  26%|██▌       | 41/157 [01:40<04:49,  2.49s/it]Epoch [5/10]:  27%|██▋       | 42/157 [01:43<04:43,  2.47s/it]Epoch [5/10]:  27%|██▋       | 43/157 [01:45<04:39,  2.45s/it]Epoch [5/10]:  28%|██▊       | 44/157 [01:48<04:35,  2.44s/it]Epoch [5/10]:  29%|██▊       | 45/157 [01:50<04:32,  2.43s/it]Epoch [5/10]:  29%|██▉       | 46/157 [01:52<04:29,  2.43s/it]Epoch [5/10]:  30%|██▉       | 47/157 [01:55<04:26,  2.42s/it]Epoch [5/10]:  31%|███       | 48/157 [01:57<04:23,  2.41s/it]Epoch [5/10]:  31%|███       | 49/157 [02:00<04:20,  2.41s/it]Epoch [5/10]:  32%|███▏      | 50/157 [02:02<04:18,  2.41s/it]Epoch [5/10]:  32%|███▏      | 51/157 [02:05<04:16,  2.42s/it]Epoch [5/10]:  33%|███▎      | 52/157 [02:07<04:13,  2.42s/it]Epoch [5/10]:  34%|███▍      | 53/157 [02:09<04:11,  2.42s/it]Epoch [5/10]:  34%|███▍      | 54/157 [02:12<04:08,  2.41s/it]Epoch [5/10]:  35%|███▌      | 55/157 [02:14<04:06,  2.41s/it]Epoch [5/10]:  36%|███▌      | 56/157 [02:17<04:03,  2.41s/it]Epoch [5/10]:  36%|███▋      | 57/157 [02:19<04:01,  2.42s/it]Epoch [5/10]:  37%|███▋      | 58/157 [02:21<03:59,  2.42s/it]Epoch [5/10]:  38%|███▊      | 59/157 [02:24<03:56,  2.42s/it]Epoch [5/10]:  38%|███▊      | 60/157 [02:26<03:54,  2.41s/it]Epoch [5/10]:  39%|███▉      | 61/157 [02:29<03:51,  2.41s/it]Epoch [5/10]:  39%|███▉      | 62/157 [02:31<03:48,  2.41s/it]Epoch [5/10]:  40%|████      | 63/157 [02:34<03:46,  2.41s/it]Epoch [5/10]:  41%|████      | 64/157 [02:36<03:43,  2.41s/it]Epoch [5/10]:  41%|████▏     | 65/157 [02:38<03:41,  2.41s/it]Epoch [5/10]:  42%|████▏     | 66/157 [02:41<03:39,  2.41s/it]Epoch [5/10]:  43%|████▎     | 67/157 [02:43<03:36,  2.41s/it]Epoch [5/10]:  43%|████▎     | 68/157 [02:46<03:34,  2.41s/it]Epoch [5/10]:  44%|████▍     | 69/157 [02:48<03:39,  2.49s/it]Epoch [5/10]:  45%|████▍     | 70/157 [02:51<03:34,  2.46s/it]Epoch [5/10]:  45%|████▌     | 71/157 [02:53<03:30,  2.45s/it]Epoch [5/10]:  46%|████▌     | 72/157 [02:55<03:26,  2.43s/it]Epoch [5/10]:  46%|████▋     | 73/157 [02:58<03:24,  2.43s/it]Epoch [5/10]:  47%|████▋     | 74/157 [03:00<03:21,  2.42s/it]Epoch [5/10]:  48%|████▊     | 75/157 [03:03<03:18,  2.42s/it]Epoch [5/10]:  48%|████▊     | 76/157 [03:05<03:15,  2.42s/it]Epoch [5/10]:  49%|████▉     | 77/157 [03:08<03:13,  2.42s/it]Epoch [5/10]:  50%|████▉     | 78/157 [03:10<03:10,  2.41s/it]Epoch [5/10]:  50%|█████     | 79/157 [03:12<03:08,  2.41s/it]Epoch [5/10]:  51%|█████     | 80/157 [03:15<03:05,  2.41s/it]Epoch [5/10]:  52%|█████▏    | 81/157 [03:17<03:03,  2.41s/it]Epoch [5/10]:  52%|█████▏    | 82/157 [03:20<03:00,  2.41s/it]Epoch [5/10]:  53%|█████▎    | 83/157 [03:22<02:58,  2.41s/it]Epoch [5/10]:  54%|█████▎    | 84/157 [03:24<02:55,  2.41s/it]Epoch [5/10]:  54%|█████▍    | 85/157 [03:27<02:53,  2.41s/it]Epoch [5/10]:  55%|█████▍    | 86/157 [03:29<02:51,  2.41s/it]Epoch [5/10]:  55%|█████▌    | 87/157 [03:32<02:48,  2.41s/it]Epoch [5/10]:  56%|█████▌    | 88/157 [03:34<02:46,  2.41s/it]Epoch [5/10]:  57%|█████▋    | 89/157 [03:36<02:43,  2.41s/it]Epoch [5/10]:  57%|█████▋    | 90/157 [03:39<02:41,  2.41s/it]Epoch [5/10]:  58%|█████▊    | 91/157 [03:41<02:38,  2.41s/it]Epoch [5/10]:  59%|█████▊    | 92/157 [03:44<02:36,  2.40s/it]Epoch [5/10]:  59%|█████▉    | 93/157 [03:46<02:33,  2.40s/it]Epoch [5/10]:  60%|█████▉    | 94/157 [03:48<02:31,  2.40s/it]Epoch [5/10]:  61%|██████    | 95/157 [03:51<02:29,  2.41s/it]Epoch [5/10]:  61%|██████    | 96/157 [03:53<02:26,  2.41s/it]Epoch [5/10]:  62%|██████▏   | 97/157 [03:56<02:24,  2.41s/it]Epoch [5/10]:  62%|██████▏   | 98/157 [03:58<02:26,  2.49s/it]Epoch [5/10]:  63%|██████▎   | 99/157 [04:01<02:22,  2.46s/it]Epoch [5/10]:  64%|██████▎   | 100/157 [04:03<02:19,  2.44s/it]Epoch [5/10]:  64%|██████▍   | 101/157 [04:06<02:16,  2.43s/it]Epoch [5/10]:  65%|██████▍   | 102/157 [04:08<02:13,  2.43s/it]Epoch [5/10]:  66%|██████▌   | 103/157 [04:10<02:10,  2.42s/it]Epoch [5/10]:  66%|██████▌   | 104/157 [04:13<02:08,  2.42s/it]Epoch [5/10]:  67%|██████▋   | 105/157 [04:15<02:05,  2.42s/it]Epoch [5/10]:  68%|██████▊   | 106/157 [04:18<02:03,  2.41s/it]Epoch [5/10]:  68%|██████▊   | 107/157 [04:20<02:00,  2.42s/it]Epoch [5/10]:  69%|██████▉   | 108/157 [04:22<01:58,  2.41s/it]Epoch [5/10]:  69%|██████▉   | 109/157 [04:25<01:55,  2.41s/it]Epoch [5/10]:  70%|███████   | 110/157 [04:27<01:53,  2.41s/it]Epoch [5/10]:  71%|███████   | 111/157 [04:30<01:50,  2.41s/it]Epoch [5/10]:  71%|███████▏  | 112/157 [04:32<01:48,  2.41s/it]Epoch [5/10]:  72%|███████▏  | 113/157 [04:34<01:45,  2.41s/it]Epoch [5/10]:  73%|███████▎  | 114/157 [04:37<01:43,  2.41s/it]Epoch [5/10]:  73%|███████▎  | 115/157 [04:39<01:41,  2.41s/it]Epoch [5/10]:  74%|███████▍  | 116/157 [04:42<01:38,  2.40s/it]Epoch [5/10]:  75%|███████▍  | 117/157 [04:44<01:36,  2.41s/it]Epoch [5/10]:  75%|███████▌  | 118/157 [04:47<01:33,  2.41s/it]Epoch [5/10]:  76%|███████▌  | 119/157 [04:49<01:31,  2.41s/it]Epoch [5/10]:  76%|███████▋  | 120/157 [04:51<01:29,  2.41s/it]Epoch [5/10]:  77%|███████▋  | 121/157 [04:54<01:26,  2.41s/it]Epoch [5/10]:  78%|███████▊  | 122/157 [04:56<01:24,  2.41s/it]Epoch [5/10]:  78%|███████▊  | 123/157 [04:59<01:21,  2.41s/it]Epoch [5/10]:  79%|███████▉  | 124/157 [05:01<01:19,  2.41s/it]Epoch [5/10]:  80%|███████▉  | 125/157 [05:03<01:16,  2.40s/it]Epoch [5/10]:  80%|████████  | 126/157 [05:06<01:16,  2.48s/it]Epoch [5/10]:  81%|████████  | 127/157 [05:08<01:13,  2.46s/it]Epoch [5/10]:  82%|████████▏ | 128/157 [05:11<01:10,  2.44s/it]Epoch [5/10]:  82%|████████▏ | 129/157 [05:13<01:08,  2.43s/it]Epoch [5/10]:  83%|████████▎ | 130/157 [05:16<01:05,  2.42s/it]Epoch [5/10]:  83%|████████▎ | 131/157 [05:18<01:02,  2.42s/it]Epoch [5/10]:  84%|████████▍ | 132/157 [05:20<01:00,  2.42s/it]Epoch [5/10]:  85%|████████▍ | 133/157 [05:23<00:57,  2.41s/it]Epoch [5/10]:  85%|████████▌ | 134/157 [05:25<00:55,  2.41s/it]Epoch [5/10]:  86%|████████▌ | 135/157 [05:28<00:53,  2.41s/it]Epoch [5/10]:  87%|████████▋ | 136/157 [05:30<00:50,  2.42s/it]Epoch [5/10]:  87%|████████▋ | 137/157 [05:33<00:48,  2.42s/it]Epoch [5/10]:  88%|████████▊ | 138/157 [05:35<00:46,  2.43s/it]Epoch [5/10]:  89%|████████▊ | 139/157 [05:37<00:43,  2.43s/it]Epoch [5/10]:  89%|████████▉ | 140/157 [05:40<00:41,  2.43s/it]Epoch [5/10]:  90%|████████▉ | 141/157 [05:42<00:38,  2.43s/it]Epoch [5/10]:  90%|█████████ | 142/157 [05:45<00:36,  2.43s/it]Epoch [5/10]:  91%|█████████ | 143/157 [05:47<00:33,  2.42s/it]Epoch [5/10]:  92%|█████████▏| 144/157 [05:50<00:31,  2.42s/it]Epoch [5/10]:  92%|█████████▏| 145/157 [05:52<00:28,  2.42s/it]Epoch [5/10]:  93%|█████████▎| 146/157 [05:54<00:26,  2.42s/it]Epoch [5/10]:  94%|█████████▎| 147/157 [05:57<00:24,  2.41s/it]Epoch [5/10]:  94%|█████████▍| 148/157 [05:59<00:21,  2.41s/it]Epoch [5/10]:  95%|█████████▍| 149/157 [06:02<00:19,  2.41s/it]Epoch [5/10]:  96%|█████████▌| 150/157 [06:04<00:16,  2.41s/it]Epoch [5/10]:  96%|█████████▌| 151/157 [06:06<00:14,  2.41s/it]Epoch [5/10]:  97%|█████████▋| 152/157 [06:09<00:12,  2.41s/it]Epoch [5/10]:  97%|█████████▋| 153/157 [06:11<00:09,  2.40s/it]Epoch [5/10]:  98%|█████████▊| 154/157 [06:14<00:07,  2.39s/it]Epoch [5/10]:  99%|█████████▊| 155/157 [06:16<00:04,  2.47s/it]Epoch [5/10]:  99%|█████████▉| 156/157 [06:19<00:02,  2.45s/it]Epoch [5/10]: 100%|██████████| 157/157 [06:19<00:00,  1.89s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:22,  3.27s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:14,  2.48s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.23s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.11s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:10<00:06,  2.04s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:04,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.97s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 6.6327e-05,
        3.7010e-02, 6.9281e-02, 5.5959e-02, 5.7276e-02, 5.0643e-02, 5.0485e-02])
Skip %: 2.67%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.037, 0.0], [0.0, 0.963]]	100.00%

Correct prediction ratio for layer 7:
[[0.0693, 0.0], [0.0, 0.9307]]	100.00%

Correct prediction ratio for layer 8:
[[0.056, 0.0], [0.0, 0.944]]	100.00%

Correct prediction ratio for layer 9:
[[0.0573, 0.0], [0.0, 0.9427]]	100.00%

Correct prediction ratio for layer 10:
[[0.0506, 0.0], [0.0, 0.9494]]	100.00%

Correct prediction ratio for layer 11:
[[0.0505, 0.0], [0.0, 0.9495]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 5 epochs: 0.40%

Epoch [6/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [6/10]:   1%|          | 1/157 [00:03<09:36,  3.69s/it]Epoch [6/10]:   1%|▏         | 2/157 [00:06<07:34,  2.93s/it]Epoch [6/10]:   2%|▏         | 3/157 [00:08<06:54,  2.69s/it]Epoch [6/10]:   3%|▎         | 4/157 [00:10<06:34,  2.58s/it]Epoch [6/10]:   3%|▎         | 5/157 [00:13<06:21,  2.51s/it]Epoch [6/10]:   4%|▍         | 6/157 [00:15<06:15,  2.49s/it]Epoch [6/10]:   4%|▍         | 7/157 [00:18<06:09,  2.46s/it]Epoch [6/10]:   5%|▌         | 8/157 [00:20<06:04,  2.44s/it]Epoch [6/10]:   6%|▌         | 9/157 [00:22<06:00,  2.43s/it]Epoch [6/10]:   6%|▋         | 10/157 [00:25<05:56,  2.42s/it]Epoch [6/10]:   7%|▋         | 11/157 [00:27<05:53,  2.42s/it]Epoch [6/10]:   8%|▊         | 12/157 [00:30<05:50,  2.42s/it]Epoch [6/10]:   8%|▊         | 13/157 [00:32<05:47,  2.42s/it]Epoch [6/10]:   9%|▉         | 14/157 [00:35<05:44,  2.41s/it]Epoch [6/10]:  10%|▉         | 15/157 [00:37<05:42,  2.41s/it]Epoch [6/10]:  10%|█         | 16/157 [00:39<05:39,  2.41s/it]Epoch [6/10]:  11%|█         | 17/157 [00:42<05:37,  2.41s/it]Epoch [6/10]:  11%|█▏        | 18/157 [00:44<05:34,  2.41s/it]Epoch [6/10]:  12%|█▏        | 19/157 [00:47<05:32,  2.41s/it]Epoch [6/10]:  13%|█▎        | 20/157 [00:49<05:29,  2.41s/it]Epoch [6/10]:  13%|█▎        | 21/157 [00:51<05:28,  2.42s/it]Epoch [6/10]:  14%|█▍        | 22/157 [00:54<05:25,  2.41s/it]Epoch [6/10]:  15%|█▍        | 23/157 [00:56<05:23,  2.41s/it]Epoch [6/10]:  15%|█▌        | 24/157 [00:59<05:20,  2.41s/it]Epoch [6/10]:  16%|█▌        | 25/157 [01:01<05:17,  2.41s/it]Epoch [6/10]:  17%|█▋        | 26/157 [01:03<05:15,  2.41s/it]Epoch [6/10]:  17%|█▋        | 27/157 [01:06<05:12,  2.41s/it]Epoch [6/10]:  18%|█▊        | 28/157 [01:08<05:10,  2.41s/it]Epoch [6/10]:  18%|█▊        | 29/157 [01:11<05:20,  2.50s/it]Epoch [6/10]:  19%|█▉        | 30/157 [01:13<05:14,  2.47s/it]Epoch [6/10]:  20%|█▉        | 31/157 [01:16<05:09,  2.46s/it]Epoch [6/10]:  20%|██        | 32/157 [01:18<05:04,  2.44s/it]Epoch [6/10]:  21%|██        | 33/157 [01:21<05:01,  2.43s/it]Epoch [6/10]:  22%|██▏       | 34/157 [01:23<04:58,  2.43s/it]Epoch [6/10]:  22%|██▏       | 35/157 [01:25<04:55,  2.42s/it]Epoch [6/10]:  23%|██▎       | 36/157 [01:28<04:52,  2.42s/it]Epoch [6/10]:  24%|██▎       | 37/157 [01:30<04:50,  2.42s/it]Epoch [6/10]:  24%|██▍       | 38/157 [01:33<04:49,  2.43s/it]Epoch [6/10]:  25%|██▍       | 39/157 [01:35<04:46,  2.43s/it]Epoch [6/10]:  25%|██▌       | 40/157 [01:38<04:43,  2.43s/it]Epoch [6/10]:  26%|██▌       | 41/157 [01:40<04:41,  2.42s/it]Epoch [6/10]:  27%|██▋       | 42/157 [01:42<04:38,  2.42s/it]Epoch [6/10]:  27%|██▋       | 43/157 [01:45<04:36,  2.42s/it]Epoch [6/10]:  28%|██▊       | 44/157 [01:47<04:33,  2.42s/it]Epoch [6/10]:  29%|██▊       | 45/157 [01:50<04:31,  2.43s/it]Epoch [6/10]:  29%|██▉       | 46/157 [01:52<04:28,  2.42s/it]Epoch [6/10]:  30%|██▉       | 47/157 [01:54<04:26,  2.42s/it]Epoch [6/10]:  31%|███       | 48/157 [01:57<04:23,  2.42s/it]Epoch [6/10]:  31%|███       | 49/157 [01:59<04:21,  2.42s/it]Epoch [6/10]:  32%|███▏      | 50/157 [02:02<04:18,  2.42s/it]Epoch [6/10]:  32%|███▏      | 51/157 [02:04<04:16,  2.42s/it]Epoch [6/10]:  33%|███▎      | 52/157 [02:07<04:13,  2.41s/it]Epoch [6/10]:  34%|███▍      | 53/157 [02:09<04:11,  2.42s/it]Epoch [6/10]:  34%|███▍      | 54/157 [02:11<04:08,  2.42s/it]Epoch [6/10]:  35%|███▌      | 55/157 [02:14<04:07,  2.43s/it]Epoch [6/10]:  36%|███▌      | 56/157 [02:16<04:04,  2.42s/it]Epoch [6/10]:  36%|███▋      | 57/157 [02:19<04:02,  2.42s/it]Epoch [6/10]:  37%|███▋      | 58/157 [02:21<03:59,  2.42s/it]Epoch [6/10]:  38%|███▊      | 59/157 [02:24<04:04,  2.50s/it]Epoch [6/10]:  38%|███▊      | 60/157 [02:26<03:59,  2.47s/it]Epoch [6/10]:  39%|███▉      | 61/157 [02:29<03:55,  2.45s/it]Epoch [6/10]:  39%|███▉      | 62/157 [02:31<03:51,  2.44s/it]Epoch [6/10]:  40%|████      | 63/157 [02:33<03:48,  2.43s/it]Epoch [6/10]:  41%|████      | 64/157 [02:36<03:45,  2.42s/it]Epoch [6/10]:  41%|████▏     | 65/157 [02:38<03:43,  2.43s/it]Epoch [6/10]:  42%|████▏     | 66/157 [02:41<03:40,  2.42s/it]Epoch [6/10]:  43%|████▎     | 67/157 [02:43<03:38,  2.42s/it]Epoch [6/10]:  43%|████▎     | 68/157 [02:46<03:35,  2.42s/it]Epoch [6/10]:  44%|████▍     | 69/157 [02:48<03:32,  2.42s/it]Epoch [6/10]:  45%|████▍     | 70/157 [02:50<03:30,  2.42s/it]Epoch [6/10]:  45%|████▌     | 71/157 [02:53<03:27,  2.42s/it]Epoch [6/10]:  46%|████▌     | 72/157 [02:55<03:25,  2.42s/it]Epoch [6/10]:  46%|████▋     | 73/157 [02:58<03:22,  2.42s/it]Epoch [6/10]:  47%|████▋     | 74/157 [03:00<03:20,  2.42s/it]Epoch [6/10]:  48%|████▊     | 75/157 [03:02<03:18,  2.42s/it]Epoch [6/10]:  48%|████▊     | 76/157 [03:05<03:15,  2.41s/it]Epoch [6/10]:  49%|████▉     | 77/157 [03:07<03:13,  2.41s/it]Epoch [6/10]:  50%|████▉     | 78/157 [03:10<03:11,  2.42s/it]Epoch [6/10]:  50%|█████     | 79/157 [03:12<03:09,  2.43s/it]Epoch [6/10]:  51%|█████     | 80/157 [03:15<03:06,  2.42s/it]Epoch [6/10]:  52%|█████▏    | 81/157 [03:17<03:03,  2.42s/it]Epoch [6/10]:  52%|█████▏    | 82/157 [03:19<03:01,  2.42s/it]Epoch [6/10]:  53%|█████▎    | 83/157 [03:22<02:58,  2.42s/it]Epoch [6/10]:  54%|█████▎    | 84/157 [03:24<02:56,  2.42s/it]Epoch [6/10]:  54%|█████▍    | 85/157 [03:27<02:59,  2.50s/it]Epoch [6/10]:  55%|█████▍    | 86/157 [03:29<02:55,  2.47s/it]Epoch [6/10]:  55%|█████▌    | 87/157 [03:32<02:52,  2.46s/it]Epoch [6/10]:  56%|█████▌    | 88/157 [03:34<02:49,  2.46s/it]Epoch [6/10]:  57%|█████▋    | 89/157 [03:37<02:46,  2.45s/it]Epoch [6/10]:  57%|█████▋    | 90/157 [03:39<02:44,  2.45s/it]Epoch [6/10]:  58%|█████▊    | 91/157 [03:41<02:41,  2.45s/it]Epoch [6/10]:  59%|█████▊    | 92/157 [03:44<02:39,  2.45s/it]Epoch [6/10]:  59%|█████▉    | 93/157 [03:46<02:36,  2.45s/it]Epoch [6/10]:  60%|█████▉    | 94/157 [03:49<02:34,  2.45s/it]Epoch [6/10]:  61%|██████    | 95/157 [03:51<02:31,  2.44s/it]Epoch [6/10]:  61%|██████    | 96/157 [03:54<02:29,  2.46s/it]Epoch [6/10]:  62%|██████▏   | 97/157 [03:56<02:27,  2.45s/it]Epoch [6/10]:  62%|██████▏   | 98/157 [03:59<02:24,  2.45s/it]Epoch [6/10]:  63%|██████▎   | 99/157 [04:01<02:21,  2.44s/it]Epoch [6/10]:  64%|██████▎   | 100/157 [04:04<02:19,  2.45s/it]Epoch [6/10]:  64%|██████▍   | 101/157 [04:06<02:16,  2.44s/it]Epoch [6/10]:  65%|██████▍   | 102/157 [04:08<02:14,  2.45s/it]Epoch [6/10]:  66%|██████▌   | 103/157 [04:11<02:11,  2.44s/it]Epoch [6/10]:  66%|██████▌   | 104/157 [04:13<02:09,  2.44s/it]Epoch [6/10]:  67%|██████▋   | 105/157 [04:16<02:06,  2.43s/it]Epoch [6/10]:  68%|██████▊   | 106/157 [04:18<02:03,  2.43s/it]Epoch [6/10]:  68%|██████▊   | 107/157 [04:21<02:01,  2.43s/it]Epoch [6/10]:  69%|██████▉   | 108/157 [04:23<01:59,  2.43s/it]Epoch [6/10]:  69%|██████▉   | 109/157 [04:25<01:56,  2.43s/it]Epoch [6/10]:  70%|███████   | 110/157 [04:28<01:54,  2.43s/it]Epoch [6/10]:  71%|███████   | 111/157 [04:30<01:51,  2.43s/it]Epoch [6/10]:  71%|███████▏  | 112/157 [04:33<01:49,  2.43s/it]Epoch [6/10]:  72%|███████▏  | 113/157 [04:35<01:46,  2.43s/it]Epoch [6/10]:  73%|███████▎  | 114/157 [04:38<01:44,  2.43s/it]Epoch [6/10]:  73%|███████▎  | 115/157 [04:40<01:45,  2.51s/it]Epoch [6/10]:  74%|███████▍  | 116/157 [04:43<01:41,  2.49s/it]Epoch [6/10]:  75%|███████▍  | 117/157 [04:45<01:38,  2.47s/it]Epoch [6/10]:  75%|███████▌  | 118/157 [04:48<01:35,  2.46s/it]Epoch [6/10]:  76%|███████▌  | 119/157 [04:50<01:33,  2.45s/it]Epoch [6/10]:  76%|███████▋  | 120/157 [04:52<01:30,  2.44s/it]Epoch [6/10]:  77%|███████▋  | 121/157 [04:55<01:27,  2.44s/it]Epoch [6/10]:  78%|███████▊  | 122/157 [04:57<01:25,  2.45s/it]Epoch [6/10]:  78%|███████▊  | 123/157 [05:00<01:22,  2.44s/it]Epoch [6/10]:  79%|███████▉  | 124/157 [05:02<01:20,  2.44s/it]Epoch [6/10]:  80%|███████▉  | 125/157 [05:05<01:18,  2.44s/it]Epoch [6/10]:  80%|████████  | 126/157 [05:07<01:15,  2.44s/it]Epoch [6/10]:  81%|████████  | 127/157 [05:09<01:12,  2.43s/it]Epoch [6/10]:  82%|████████▏ | 128/157 [05:12<01:10,  2.43s/it]Epoch [6/10]:  82%|████████▏ | 129/157 [05:14<01:08,  2.43s/it]Epoch [6/10]:  83%|████████▎ | 130/157 [05:17<01:05,  2.44s/it]Epoch [6/10]:  83%|████████▎ | 131/157 [05:19<01:03,  2.44s/it]Epoch [6/10]:  84%|████████▍ | 132/157 [05:22<01:00,  2.44s/it]Epoch [6/10]:  85%|████████▍ | 133/157 [05:24<00:58,  2.44s/it]Epoch [6/10]:  85%|████████▌ | 134/157 [05:26<00:56,  2.44s/it]Epoch [6/10]:  86%|████████▌ | 135/157 [05:29<00:53,  2.44s/it]Epoch [6/10]:  87%|████████▋ | 136/157 [05:31<00:51,  2.44s/it]Epoch [6/10]:  87%|████████▋ | 137/157 [05:34<00:48,  2.44s/it]Epoch [6/10]:  88%|████████▊ | 138/157 [05:36<00:46,  2.44s/it]Epoch [6/10]:  89%|████████▊ | 139/157 [05:39<00:43,  2.44s/it]Epoch [6/10]:  89%|████████▉ | 140/157 [05:41<00:41,  2.44s/it]Epoch [6/10]:  90%|████████▉ | 141/157 [05:44<00:38,  2.44s/it]Epoch [6/10]:  90%|█████████ | 142/157 [05:46<00:36,  2.44s/it]Epoch [6/10]:  91%|█████████ | 143/157 [05:48<00:34,  2.43s/it]Epoch [6/10]:  92%|█████████▏| 144/157 [05:51<00:31,  2.43s/it]Epoch [6/10]:  92%|█████████▏| 145/157 [05:54<00:30,  2.52s/it]Epoch [6/10]:  93%|█████████▎| 146/157 [05:56<00:27,  2.50s/it]Epoch [6/10]:  94%|█████████▎| 147/157 [05:58<00:24,  2.48s/it]Epoch [6/10]:  94%|█████████▍| 148/157 [06:01<00:22,  2.46s/it]Epoch [6/10]:  95%|█████████▍| 149/157 [06:03<00:19,  2.45s/it]Epoch [6/10]:  96%|█████████▌| 150/157 [06:06<00:17,  2.44s/it]Epoch [6/10]:  96%|█████████▌| 151/157 [06:08<00:14,  2.44s/it]Epoch [6/10]:  97%|█████████▋| 152/157 [06:11<00:12,  2.44s/it]Epoch [6/10]:  97%|█████████▋| 153/157 [06:13<00:09,  2.43s/it]Epoch [6/10]:  98%|█████████▊| 154/157 [06:15<00:07,  2.43s/it]Epoch [6/10]:  99%|█████████▊| 155/157 [06:18<00:04,  2.43s/it]Epoch [6/10]:  99%|█████████▉| 156/157 [06:20<00:02,  2.43s/it]Epoch [6/10]: 100%|██████████| 157/157 [06:21<00:00,  1.89s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:24,  3.48s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.57s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.28s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.15s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.07s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.03s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:15<00:01,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.87s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 8.6735e-05,
        3.6194e-02, 6.6597e-02, 5.4561e-02, 5.3388e-02, 4.9699e-02, 4.9745e-02])
Skip %: 2.59%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.0362, 0.0], [0.0, 0.9638]]	100.00%

Correct prediction ratio for layer 7:
[[0.0666, 0.0], [0.0, 0.9334]]	100.00%

Correct prediction ratio for layer 8:
[[0.0546, 0.0], [0.0, 0.9454]]	100.00%

Correct prediction ratio for layer 9:
[[0.0534, 0.0], [0.0, 0.9466]]	100.00%

Correct prediction ratio for layer 10:
[[0.0497, 0.0], [0.0, 0.9503]]	100.00%

Correct prediction ratio for layer 11:
[[0.0497, 0.0], [0.0, 0.9503]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 6 epochs: 0.40%

Epoch [7/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [7/10]:   1%|          | 1/157 [00:03<10:03,  3.87s/it]Epoch [7/10]:   1%|▏         | 2/157 [00:06<07:48,  3.02s/it]Epoch [7/10]:   2%|▏         | 3/157 [00:08<07:03,  2.75s/it]Epoch [7/10]:   3%|▎         | 4/157 [00:11<06:39,  2.61s/it]Epoch [7/10]:   3%|▎         | 5/157 [00:13<06:27,  2.55s/it]Epoch [7/10]:   4%|▍         | 6/157 [00:15<06:18,  2.51s/it]Epoch [7/10]:   4%|▍         | 7/157 [00:18<06:12,  2.49s/it]Epoch [7/10]:   5%|▌         | 8/157 [00:20<06:07,  2.47s/it]Epoch [7/10]:   6%|▌         | 9/157 [00:23<06:03,  2.46s/it]Epoch [7/10]:   6%|▋         | 10/157 [00:25<05:59,  2.45s/it]Epoch [7/10]:   7%|▋         | 11/157 [00:28<05:56,  2.44s/it]Epoch [7/10]:   8%|▊         | 12/157 [00:30<05:53,  2.44s/it]Epoch [7/10]:   8%|▊         | 13/157 [00:33<05:50,  2.44s/it]Epoch [7/10]:   9%|▉         | 14/157 [00:35<05:48,  2.44s/it]Epoch [7/10]:  10%|▉         | 15/157 [00:37<05:45,  2.44s/it]Epoch [7/10]:  10%|█         | 16/157 [00:40<05:43,  2.44s/it]Epoch [7/10]:  11%|█         | 17/157 [00:43<05:55,  2.54s/it]Epoch [7/10]:  11%|█▏        | 18/157 [00:45<05:49,  2.51s/it]Epoch [7/10]:  12%|█▏        | 19/157 [00:47<05:43,  2.49s/it]Epoch [7/10]:  13%|█▎        | 20/157 [00:50<05:38,  2.47s/it]Epoch [7/10]:  13%|█▎        | 21/157 [00:52<05:33,  2.45s/it]Epoch [7/10]:  14%|█▍        | 22/157 [00:55<05:29,  2.44s/it]Epoch [7/10]:  15%|█▍        | 23/157 [00:57<05:25,  2.43s/it]Epoch [7/10]:  15%|█▌        | 24/157 [01:00<05:22,  2.42s/it]Epoch [7/10]:  16%|█▌        | 25/157 [01:02<05:18,  2.41s/it]Epoch [7/10]:  17%|█▋        | 26/157 [01:04<05:15,  2.41s/it]Epoch [7/10]:  17%|█▋        | 27/157 [01:07<05:14,  2.42s/it]Epoch [7/10]:  18%|█▊        | 28/157 [01:09<05:12,  2.42s/it]Epoch [7/10]:  18%|█▊        | 29/157 [01:12<05:10,  2.42s/it]Epoch [7/10]:  19%|█▉        | 30/157 [01:14<05:08,  2.43s/it]Epoch [7/10]:  20%|█▉        | 31/157 [01:17<05:06,  2.43s/it]Epoch [7/10]:  20%|██        | 32/157 [01:19<05:03,  2.43s/it]Epoch [7/10]:  21%|██        | 33/157 [01:21<05:01,  2.43s/it]Epoch [7/10]:  22%|██▏       | 34/157 [01:24<04:58,  2.43s/it]Epoch [7/10]:  22%|██▏       | 35/157 [01:26<04:56,  2.43s/it]Epoch [7/10]:  23%|██▎       | 36/157 [01:29<04:54,  2.43s/it]Epoch [7/10]:  24%|██▎       | 37/157 [01:31<04:51,  2.43s/it]Epoch [7/10]:  24%|██▍       | 38/157 [01:34<04:48,  2.43s/it]Epoch [7/10]:  25%|██▍       | 39/157 [01:36<04:46,  2.43s/it]Epoch [7/10]:  25%|██▌       | 40/157 [01:38<04:44,  2.43s/it]Epoch [7/10]:  26%|██▌       | 41/157 [01:41<04:41,  2.43s/it]Epoch [7/10]:  27%|██▋       | 42/157 [01:43<04:41,  2.45s/it]Epoch [7/10]:  27%|██▋       | 43/157 [01:46<04:39,  2.45s/it]Epoch [7/10]:  28%|██▊       | 44/157 [01:48<04:38,  2.46s/it]Epoch [7/10]:  29%|██▊       | 45/157 [01:51<04:35,  2.46s/it]Epoch [7/10]:  29%|██▉       | 46/157 [01:53<04:32,  2.45s/it]Epoch [7/10]:  30%|██▉       | 47/157 [01:56<04:38,  2.53s/it]Epoch [7/10]:  31%|███       | 48/157 [01:58<04:32,  2.50s/it]Epoch [7/10]:  31%|███       | 49/157 [02:01<04:27,  2.48s/it]Epoch [7/10]:  32%|███▏      | 50/157 [02:03<04:23,  2.46s/it]Epoch [7/10]:  32%|███▏      | 51/157 [02:06<04:19,  2.45s/it]Epoch [7/10]:  33%|███▎      | 52/157 [02:08<04:16,  2.44s/it]Epoch [7/10]:  34%|███▍      | 53/157 [02:10<04:13,  2.44s/it]Epoch [7/10]:  34%|███▍      | 54/157 [02:13<04:11,  2.44s/it]Epoch [7/10]:  35%|███▌      | 55/157 [02:15<04:08,  2.44s/it]Epoch [7/10]:  36%|███▌      | 56/157 [02:18<04:07,  2.45s/it]Epoch [7/10]:  36%|███▋      | 57/157 [02:20<04:04,  2.45s/it]Epoch [7/10]:  37%|███▋      | 58/157 [02:23<04:01,  2.44s/it]Epoch [7/10]:  38%|███▊      | 59/157 [02:25<03:59,  2.44s/it]Epoch [7/10]:  38%|███▊      | 60/157 [02:27<03:56,  2.44s/it]Epoch [7/10]:  39%|███▉      | 61/157 [02:30<03:53,  2.43s/it]Epoch [7/10]:  39%|███▉      | 62/157 [02:32<03:51,  2.43s/it]Epoch [7/10]:  40%|████      | 63/157 [02:35<03:48,  2.43s/it]Epoch [7/10]:  41%|████      | 64/157 [02:37<03:45,  2.43s/it]Epoch [7/10]:  41%|████▏     | 65/157 [02:40<03:43,  2.43s/it]Epoch [7/10]:  42%|████▏     | 66/157 [02:42<03:41,  2.43s/it]Epoch [7/10]:  43%|████▎     | 67/157 [02:44<03:38,  2.43s/it]Epoch [7/10]:  43%|████▎     | 68/157 [02:47<03:36,  2.43s/it]Epoch [7/10]:  44%|████▍     | 69/157 [02:49<03:34,  2.43s/it]Epoch [7/10]:  45%|████▍     | 70/157 [02:52<03:31,  2.44s/it]Epoch [7/10]:  45%|████▌     | 71/157 [02:54<03:29,  2.43s/it]Epoch [7/10]:  46%|████▌     | 72/157 [02:57<03:26,  2.43s/it]Epoch [7/10]:  46%|████▋     | 73/157 [02:59<03:31,  2.51s/it]Epoch [7/10]:  47%|████▋     | 74/157 [03:02<03:26,  2.49s/it]Epoch [7/10]:  48%|████▊     | 75/157 [03:04<03:22,  2.47s/it]Epoch [7/10]:  48%|████▊     | 76/157 [03:07<03:19,  2.46s/it]Epoch [7/10]:  49%|████▉     | 77/157 [03:09<03:16,  2.45s/it]Epoch [7/10]:  50%|████▉     | 78/157 [03:11<03:12,  2.44s/it]Epoch [7/10]:  50%|█████     | 79/157 [03:14<03:10,  2.44s/it]Epoch [7/10]:  51%|█████     | 80/157 [03:16<03:07,  2.44s/it]Epoch [7/10]:  52%|█████▏    | 81/157 [03:19<03:04,  2.43s/it]Epoch [7/10]:  52%|█████▏    | 82/157 [03:21<03:02,  2.43s/it]Epoch [7/10]:  53%|█████▎    | 83/157 [03:24<02:59,  2.43s/it]Epoch [7/10]:  54%|█████▎    | 84/157 [03:26<02:56,  2.42s/it]Epoch [7/10]:  54%|█████▍    | 85/157 [03:28<02:54,  2.42s/it]Epoch [7/10]:  55%|█████▍    | 86/157 [03:31<02:52,  2.43s/it]Epoch [7/10]:  55%|█████▌    | 87/157 [03:33<02:50,  2.44s/it]Epoch [7/10]:  56%|█████▌    | 88/157 [03:36<02:48,  2.44s/it]Epoch [7/10]:  57%|█████▋    | 89/157 [03:38<02:45,  2.44s/it]Epoch [7/10]:  57%|█████▋    | 90/157 [03:41<02:43,  2.44s/it]Epoch [7/10]:  58%|█████▊    | 91/157 [03:43<02:41,  2.44s/it]Epoch [7/10]:  59%|█████▊    | 92/157 [03:46<02:38,  2.44s/it]Epoch [7/10]:  59%|█████▉    | 93/157 [03:48<02:36,  2.44s/it]Epoch [7/10]:  60%|█████▉    | 94/157 [03:50<02:33,  2.44s/it]Epoch [7/10]:  61%|██████    | 95/157 [03:53<02:31,  2.44s/it]Epoch [7/10]:  61%|██████    | 96/157 [03:55<02:28,  2.44s/it]Epoch [7/10]:  62%|██████▏   | 97/157 [03:58<02:26,  2.44s/it]Epoch [7/10]:  62%|██████▏   | 98/157 [04:00<02:23,  2.44s/it]Epoch [7/10]:  63%|██████▎   | 99/157 [04:03<02:21,  2.44s/it]Epoch [7/10]:  64%|██████▎   | 100/157 [04:05<02:23,  2.52s/it]Epoch [7/10]:  64%|██████▍   | 101/157 [04:08<02:19,  2.50s/it]Epoch [7/10]:  65%|██████▍   | 102/157 [04:10<02:16,  2.48s/it]Epoch [7/10]:  66%|██████▌   | 103/157 [04:13<02:13,  2.48s/it]Epoch [7/10]:  66%|██████▌   | 104/157 [04:15<02:11,  2.47s/it]Epoch [7/10]:  67%|██████▋   | 105/157 [04:18<02:08,  2.47s/it]Epoch [7/10]:  68%|██████▊   | 106/157 [04:20<02:05,  2.46s/it]Epoch [7/10]:  68%|██████▊   | 107/157 [04:23<02:02,  2.46s/it]Epoch [7/10]:  69%|██████▉   | 108/157 [04:25<02:00,  2.45s/it]Epoch [7/10]:  69%|██████▉   | 109/157 [04:27<01:57,  2.45s/it]Epoch [7/10]:  70%|███████   | 110/157 [04:30<01:55,  2.45s/it]Epoch [7/10]:  71%|███████   | 111/157 [04:32<01:52,  2.45s/it]Epoch [7/10]:  71%|███████▏  | 112/157 [04:35<01:49,  2.44s/it]Epoch [7/10]:  72%|███████▏  | 113/157 [04:37<01:47,  2.44s/it]Epoch [7/10]:  73%|███████▎  | 114/157 [04:40<01:45,  2.45s/it]Epoch [7/10]:  73%|███████▎  | 115/157 [04:42<01:42,  2.44s/it]Epoch [7/10]:  74%|███████▍  | 116/157 [04:44<01:40,  2.44s/it]Epoch [7/10]:  75%|███████▍  | 117/157 [04:47<01:37,  2.44s/it]Epoch [7/10]:  75%|███████▌  | 118/157 [04:49<01:35,  2.44s/it]Epoch [7/10]:  76%|███████▌  | 119/157 [04:52<01:32,  2.44s/it]Epoch [7/10]:  76%|███████▋  | 120/157 [04:54<01:30,  2.44s/it]Epoch [7/10]:  77%|███████▋  | 121/157 [04:57<01:27,  2.44s/it]Epoch [7/10]:  78%|███████▊  | 122/157 [04:59<01:25,  2.44s/it]Epoch [7/10]:  78%|███████▊  | 123/157 [05:02<01:22,  2.44s/it]Epoch [7/10]:  79%|███████▉  | 124/157 [05:04<01:20,  2.44s/it]Epoch [7/10]:  80%|███████▉  | 125/157 [05:06<01:18,  2.44s/it]Epoch [7/10]:  80%|████████  | 126/157 [05:09<01:15,  2.44s/it]Epoch [7/10]:  81%|████████  | 127/157 [05:11<01:13,  2.44s/it]Epoch [7/10]:  82%|████████▏ | 128/157 [05:14<01:10,  2.44s/it]Epoch [7/10]:  82%|████████▏ | 129/157 [05:16<01:08,  2.45s/it]Epoch [7/10]:  83%|████████▎ | 130/157 [05:19<01:08,  2.53s/it]Epoch [7/10]:  83%|████████▎ | 131/157 [05:21<01:05,  2.51s/it]Epoch [7/10]:  84%|████████▍ | 132/157 [05:24<01:01,  2.48s/it]Epoch [7/10]:  85%|████████▍ | 133/157 [05:26<00:58,  2.45s/it]Epoch [7/10]:  85%|████████▌ | 134/157 [05:29<00:55,  2.43s/it]Epoch [7/10]:  86%|████████▌ | 135/157 [05:31<00:53,  2.42s/it]Epoch [7/10]:  87%|████████▋ | 136/157 [05:33<00:50,  2.42s/it]Epoch [7/10]:  87%|████████▋ | 137/157 [05:36<00:48,  2.41s/it]Epoch [7/10]:  88%|████████▊ | 138/157 [05:38<00:45,  2.41s/it]Epoch [7/10]:  89%|████████▊ | 139/157 [05:41<00:43,  2.41s/it]Epoch [7/10]:  89%|████████▉ | 140/157 [05:43<00:41,  2.42s/it]Epoch [7/10]:  90%|████████▉ | 141/157 [05:45<00:38,  2.41s/it]Epoch [7/10]:  90%|█████████ | 142/157 [05:48<00:36,  2.42s/it]Epoch [7/10]:  91%|█████████ | 143/157 [05:50<00:34,  2.43s/it]Epoch [7/10]:  92%|█████████▏| 144/157 [05:53<00:31,  2.44s/it]Epoch [7/10]:  92%|█████████▏| 145/157 [05:55<00:29,  2.44s/it]Epoch [7/10]:  93%|█████████▎| 146/157 [05:58<00:26,  2.45s/it]Epoch [7/10]:  94%|█████████▎| 147/157 [06:00<00:24,  2.45s/it]Epoch [7/10]:  94%|█████████▍| 148/157 [06:03<00:22,  2.45s/it]Epoch [7/10]:  95%|█████████▍| 149/157 [06:05<00:19,  2.45s/it]Epoch [7/10]:  96%|█████████▌| 150/157 [06:08<00:17,  2.45s/it]Epoch [7/10]:  96%|█████████▌| 151/157 [06:10<00:14,  2.45s/it]Epoch [7/10]:  97%|█████████▋| 152/157 [06:12<00:12,  2.45s/it]Epoch [7/10]:  97%|█████████▋| 153/157 [06:15<00:09,  2.44s/it]Epoch [7/10]:  98%|█████████▊| 154/157 [06:17<00:07,  2.44s/it]Epoch [7/10]:  99%|█████████▊| 155/157 [06:20<00:04,  2.44s/it]Epoch [7/10]:  99%|█████████▉| 156/157 [06:22<00:02,  2.44s/it]Epoch [7/10]: 100%|██████████| 157/157 [06:23<00:00,  1.90s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.30s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.50s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.25s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.13s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.06s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.02s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.99s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.86s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 6.1224e-05,
        3.9255e-02, 6.8434e-02, 5.6954e-02, 5.5745e-02, 5.2485e-02, 5.2556e-02])
Skip %: 2.71%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.0393, 0.0], [0.0, 0.9607]]	100.00%

Correct prediction ratio for layer 7:
[[0.0684, 0.0], [0.0, 0.9316]]	100.00%

Correct prediction ratio for layer 8:
[[0.057, 0.0], [0.0, 0.943]]	100.00%

Correct prediction ratio for layer 9:
[[0.0557, 0.0], [0.0, 0.9443]]	100.00%

Correct prediction ratio for layer 10:
[[0.0525, 0.0], [0.0, 0.9475]]	100.00%

Correct prediction ratio for layer 11:
[[0.0526, 0.0], [0.0, 0.9474]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 7 epochs: 0.40%

Epoch [8/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [8/10]:   1%|          | 1/157 [00:04<10:49,  4.16s/it]Epoch [8/10]:   1%|▏         | 2/157 [00:06<08:04,  3.13s/it]Epoch [8/10]:   2%|▏         | 3/157 [00:08<07:12,  2.81s/it]Epoch [8/10]:   3%|▎         | 4/157 [00:11<06:45,  2.65s/it]Epoch [8/10]:   3%|▎         | 5/157 [00:13<06:30,  2.57s/it]Epoch [8/10]:   4%|▍         | 6/157 [00:16<06:19,  2.52s/it]Epoch [8/10]:   4%|▍         | 7/157 [00:18<06:13,  2.49s/it]Epoch [8/10]:   5%|▌         | 8/157 [00:21<06:08,  2.47s/it]Epoch [8/10]:   6%|▌         | 9/157 [00:23<06:04,  2.46s/it]Epoch [8/10]:   6%|▋         | 10/157 [00:25<06:00,  2.45s/it]Epoch [8/10]:   7%|▋         | 11/157 [00:28<05:57,  2.45s/it]Epoch [8/10]:   8%|▊         | 12/157 [00:30<05:54,  2.44s/it]Epoch [8/10]:   8%|▊         | 13/157 [00:33<05:51,  2.44s/it]Epoch [8/10]:   9%|▉         | 14/157 [00:35<05:48,  2.44s/it]Epoch [8/10]:  10%|▉         | 15/157 [00:38<05:45,  2.43s/it]Epoch [8/10]:  10%|█         | 16/157 [00:40<05:42,  2.43s/it]Epoch [8/10]:  11%|█         | 17/157 [00:43<05:40,  2.43s/it]Epoch [8/10]:  11%|█▏        | 18/157 [00:45<05:38,  2.44s/it]Epoch [8/10]:  12%|█▏        | 19/157 [00:47<05:38,  2.46s/it]Epoch [8/10]:  13%|█▎        | 20/157 [00:50<05:37,  2.46s/it]Epoch [8/10]:  13%|█▎        | 21/157 [00:52<05:35,  2.47s/it]Epoch [8/10]:  14%|█▍        | 22/157 [00:55<05:34,  2.48s/it]Epoch [8/10]:  15%|█▍        | 23/157 [00:57<05:33,  2.49s/it]Epoch [8/10]:  15%|█▌        | 24/157 [01:00<05:33,  2.51s/it]Epoch [8/10]:  16%|█▌        | 25/157 [01:03<05:34,  2.53s/it]Epoch [8/10]:  17%|█▋        | 26/157 [01:05<05:33,  2.55s/it]Epoch [8/10]:  17%|█▋        | 27/157 [01:08<05:30,  2.54s/it]Epoch [8/10]:  18%|█▊        | 28/157 [01:10<05:27,  2.54s/it]Epoch [8/10]:  18%|█▊        | 29/157 [01:13<05:20,  2.51s/it]Epoch [8/10]:  19%|█▉        | 30/157 [01:15<05:15,  2.48s/it]Epoch [8/10]:  20%|█▉        | 31/157 [01:18<05:21,  2.55s/it]Epoch [8/10]:  20%|██        | 32/157 [01:20<05:14,  2.51s/it]Epoch [8/10]:  21%|██        | 33/157 [01:23<05:08,  2.48s/it]Epoch [8/10]:  22%|██▏       | 34/157 [01:25<05:03,  2.46s/it]Epoch [8/10]:  22%|██▏       | 35/157 [01:27<04:59,  2.46s/it]Epoch [8/10]:  23%|██▎       | 36/157 [01:30<04:56,  2.45s/it]Epoch [8/10]:  24%|██▎       | 37/157 [01:32<04:53,  2.45s/it]Epoch [8/10]:  24%|██▍       | 38/157 [01:35<04:51,  2.45s/it]Epoch [8/10]:  25%|██▍       | 39/157 [01:37<04:48,  2.44s/it]Epoch [8/10]:  25%|██▌       | 40/157 [01:40<04:45,  2.44s/it]Epoch [8/10]:  26%|██▌       | 41/157 [01:42<04:42,  2.44s/it]Epoch [8/10]:  27%|██▋       | 42/157 [01:45<04:40,  2.44s/it]Epoch [8/10]:  27%|██▋       | 43/157 [01:47<04:37,  2.43s/it]Epoch [8/10]:  28%|██▊       | 44/157 [01:49<04:34,  2.43s/it]Epoch [8/10]:  29%|██▊       | 45/157 [01:52<04:32,  2.43s/it]Epoch [8/10]:  29%|██▉       | 46/157 [01:54<04:29,  2.43s/it]Epoch [8/10]:  30%|██▉       | 47/157 [01:57<04:27,  2.43s/it]Epoch [8/10]:  31%|███       | 48/157 [01:59<04:24,  2.43s/it]Epoch [8/10]:  31%|███       | 49/157 [02:02<04:21,  2.42s/it]Epoch [8/10]:  32%|███▏      | 50/157 [02:04<04:20,  2.43s/it]Epoch [8/10]:  32%|███▏      | 51/157 [02:06<04:17,  2.43s/it]Epoch [8/10]:  33%|███▎      | 52/157 [02:09<04:16,  2.45s/it]Epoch [8/10]:  34%|███▍      | 53/157 [02:11<04:13,  2.44s/it]Epoch [8/10]:  34%|███▍      | 54/157 [02:14<04:10,  2.44s/it]Epoch [8/10]:  35%|███▌      | 55/157 [02:16<04:08,  2.43s/it]Epoch [8/10]:  36%|███▌      | 56/157 [02:19<04:05,  2.43s/it]Epoch [8/10]:  36%|███▋      | 57/157 [02:21<04:02,  2.43s/it]Epoch [8/10]:  37%|███▋      | 58/157 [02:23<04:00,  2.42s/it]Epoch [8/10]:  38%|███▊      | 59/157 [02:26<03:57,  2.42s/it]Epoch [8/10]:  38%|███▊      | 60/157 [02:29<04:03,  2.51s/it]Epoch [8/10]:  39%|███▉      | 61/157 [02:31<03:58,  2.48s/it]Epoch [8/10]:  39%|███▉      | 62/157 [02:33<03:54,  2.47s/it]Epoch [8/10]:  40%|████      | 63/157 [02:36<03:51,  2.46s/it]Epoch [8/10]:  41%|████      | 64/157 [02:38<03:47,  2.45s/it]Epoch [8/10]:  41%|████▏     | 65/157 [02:41<03:44,  2.44s/it]Epoch [8/10]:  42%|████▏     | 66/157 [02:43<03:41,  2.44s/it]Epoch [8/10]:  43%|████▎     | 67/157 [02:46<03:38,  2.43s/it]Epoch [8/10]:  43%|████▎     | 68/157 [02:48<03:36,  2.43s/it]Epoch [8/10]:  44%|████▍     | 69/157 [02:50<03:34,  2.44s/it]Epoch [8/10]:  45%|████▍     | 70/157 [02:53<03:35,  2.47s/it]Epoch [8/10]:  45%|████▌     | 71/157 [02:55<03:33,  2.48s/it]Epoch [8/10]:  46%|████▌     | 72/157 [02:58<03:31,  2.49s/it]Epoch [8/10]:  46%|████▋     | 73/157 [03:01<03:30,  2.51s/it]Epoch [8/10]:  47%|████▋     | 74/157 [03:03<03:26,  2.48s/it]Epoch [8/10]:  48%|████▊     | 75/157 [03:05<03:22,  2.47s/it]Epoch [8/10]:  48%|████▊     | 76/157 [03:08<03:18,  2.46s/it]Epoch [8/10]:  49%|████▉     | 77/157 [03:10<03:15,  2.45s/it]Epoch [8/10]:  50%|████▉     | 78/157 [03:13<03:12,  2.44s/it]Epoch [8/10]:  50%|█████     | 79/157 [03:15<03:10,  2.44s/it]Epoch [8/10]:  51%|█████     | 80/157 [03:18<03:07,  2.44s/it]Epoch [8/10]:  52%|█████▏    | 81/157 [03:20<03:05,  2.44s/it]Epoch [8/10]:  52%|█████▏    | 82/157 [03:22<03:02,  2.44s/it]Epoch [8/10]:  53%|█████▎    | 83/157 [03:25<03:00,  2.44s/it]Epoch [8/10]:  54%|█████▎    | 84/157 [03:27<02:57,  2.43s/it]Epoch [8/10]:  54%|█████▍    | 85/157 [03:30<02:55,  2.43s/it]Epoch [8/10]:  55%|█████▍    | 86/157 [03:32<02:58,  2.51s/it]Epoch [8/10]:  55%|█████▌    | 87/157 [03:35<02:54,  2.49s/it]Epoch [8/10]:  56%|█████▌    | 88/157 [03:37<02:51,  2.48s/it]Epoch [8/10]:  57%|█████▋    | 89/157 [03:40<02:47,  2.46s/it]Epoch [8/10]:  57%|█████▋    | 90/157 [03:42<02:44,  2.45s/it]Epoch [8/10]:  58%|█████▊    | 91/157 [03:45<02:41,  2.45s/it]Epoch [8/10]:  59%|█████▊    | 92/157 [03:47<02:38,  2.44s/it]Epoch [8/10]:  59%|█████▉    | 93/157 [03:49<02:36,  2.44s/it]Epoch [8/10]:  60%|█████▉    | 94/157 [03:52<02:33,  2.43s/it]Epoch [8/10]:  61%|██████    | 95/157 [03:54<02:30,  2.44s/it]Epoch [8/10]:  61%|██████    | 96/157 [03:57<02:28,  2.43s/it]Epoch [8/10]:  62%|██████▏   | 97/157 [03:59<02:25,  2.43s/it]Epoch [8/10]:  62%|██████▏   | 98/157 [04:02<02:23,  2.43s/it]Epoch [8/10]:  63%|██████▎   | 99/157 [04:04<02:20,  2.43s/it]Epoch [8/10]:  64%|██████▎   | 100/157 [04:06<02:18,  2.42s/it]Epoch [8/10]:  64%|██████▍   | 101/157 [04:09<02:15,  2.42s/it]Epoch [8/10]:  65%|██████▍   | 102/157 [04:11<02:13,  2.43s/it]Epoch [8/10]:  66%|██████▌   | 103/157 [04:14<02:11,  2.43s/it]Epoch [8/10]:  66%|██████▌   | 104/157 [04:16<02:08,  2.43s/it]Epoch [8/10]:  67%|██████▋   | 105/157 [04:19<02:06,  2.43s/it]Epoch [8/10]:  68%|██████▊   | 106/157 [04:21<02:03,  2.43s/it]Epoch [8/10]:  68%|██████▊   | 107/157 [04:23<02:01,  2.43s/it]Epoch [8/10]:  69%|██████▉   | 108/157 [04:26<01:59,  2.43s/it]Epoch [8/10]:  69%|██████▉   | 109/157 [04:28<01:56,  2.43s/it]Epoch [8/10]:  70%|███████   | 110/157 [04:31<01:54,  2.43s/it]Epoch [8/10]:  71%|███████   | 111/157 [04:33<01:51,  2.43s/it]Epoch [8/10]:  71%|███████▏  | 112/157 [04:36<01:49,  2.43s/it]Epoch [8/10]:  72%|███████▏  | 113/157 [04:38<01:46,  2.43s/it]Epoch [8/10]:  73%|███████▎  | 114/157 [04:40<01:44,  2.43s/it]Epoch [8/10]:  73%|███████▎  | 115/157 [04:43<01:41,  2.42s/it]Epoch [8/10]:  74%|███████▍  | 116/157 [04:46<01:42,  2.50s/it]Epoch [8/10]:  75%|███████▍  | 117/157 [04:48<01:39,  2.48s/it]Epoch [8/10]:  75%|███████▌  | 118/157 [04:50<01:36,  2.46s/it]Epoch [8/10]:  76%|███████▌  | 119/157 [04:53<01:33,  2.46s/it]Epoch [8/10]:  76%|███████▋  | 120/157 [04:55<01:30,  2.44s/it]Epoch [8/10]:  77%|███████▋  | 121/157 [04:58<01:27,  2.44s/it]Epoch [8/10]:  78%|███████▊  | 122/157 [05:00<01:25,  2.43s/it]Epoch [8/10]:  78%|███████▊  | 123/157 [05:03<01:22,  2.43s/it]Epoch [8/10]:  79%|███████▉  | 124/157 [05:05<01:20,  2.43s/it]Epoch [8/10]:  80%|███████▉  | 125/157 [05:07<01:17,  2.42s/it]Epoch [8/10]:  80%|████████  | 126/157 [05:10<01:15,  2.42s/it]Epoch [8/10]:  81%|████████  | 127/157 [05:12<01:12,  2.42s/it]Epoch [8/10]:  82%|████████▏ | 128/157 [05:15<01:10,  2.42s/it]Epoch [8/10]:  82%|████████▏ | 129/157 [05:17<01:07,  2.42s/it]Epoch [8/10]:  83%|████████▎ | 130/157 [05:19<01:05,  2.42s/it]Epoch [8/10]:  83%|████████▎ | 131/157 [05:22<01:02,  2.42s/it]Epoch [8/10]:  84%|████████▍ | 132/157 [05:24<01:00,  2.42s/it]Epoch [8/10]:  85%|████████▍ | 133/157 [05:27<00:58,  2.43s/it]Epoch [8/10]:  85%|████████▌ | 134/157 [05:29<00:55,  2.42s/it]Epoch [8/10]:  86%|████████▌ | 135/157 [05:32<00:53,  2.42s/it]Epoch [8/10]:  87%|████████▋ | 136/157 [05:34<00:50,  2.42s/it]Epoch [8/10]:  87%|████████▋ | 137/157 [05:36<00:48,  2.42s/it]Epoch [8/10]:  88%|████████▊ | 138/157 [05:39<00:45,  2.42s/it]Epoch [8/10]:  89%|████████▊ | 139/157 [05:41<00:43,  2.42s/it]Epoch [8/10]:  89%|████████▉ | 140/157 [05:44<00:41,  2.42s/it]Epoch [8/10]:  90%|████████▉ | 141/157 [05:46<00:38,  2.42s/it]Epoch [8/10]:  90%|█████████ | 142/157 [05:48<00:36,  2.42s/it]Epoch [8/10]:  91%|█████████ | 143/157 [05:51<00:33,  2.42s/it]Epoch [8/10]:  92%|█████████▏| 144/157 [05:54<00:32,  2.50s/it]Epoch [8/10]:  92%|█████████▏| 145/157 [05:56<00:29,  2.48s/it]Epoch [8/10]:  93%|█████████▎| 146/157 [05:58<00:27,  2.46s/it]Epoch [8/10]:  94%|█████████▎| 147/157 [06:01<00:24,  2.45s/it]Epoch [8/10]:  94%|█████████▍| 148/157 [06:03<00:21,  2.44s/it]Epoch [8/10]:  95%|█████████▍| 149/157 [06:06<00:19,  2.43s/it]Epoch [8/10]:  96%|█████████▌| 150/157 [06:08<00:16,  2.43s/it]Epoch [8/10]:  96%|█████████▌| 151/157 [06:10<00:14,  2.42s/it]Epoch [8/10]:  97%|█████████▋| 152/157 [06:13<00:12,  2.42s/it]Epoch [8/10]:  97%|█████████▋| 153/157 [06:15<00:09,  2.42s/it]Epoch [8/10]:  98%|█████████▊| 154/157 [06:18<00:07,  2.42s/it]Epoch [8/10]:  99%|█████████▊| 155/157 [06:20<00:04,  2.42s/it]Epoch [8/10]:  99%|█████████▉| 156/157 [06:23<00:02,  2.42s/it]Epoch [8/10]: 100%|██████████| 157/157 [06:23<00:00,  1.88s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.35s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.52s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.25s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.12s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.05s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:12<00:04,  2.01s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  1.98s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.85s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 4.0816e-05,
        4.1168e-02, 6.7628e-02, 5.8872e-02, 5.6954e-02, 5.4776e-02, 5.6000e-02])
Skip %: 2.80%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 6:
[[0.0412, 0.0], [0.0, 0.9588]]	100.00%

Correct prediction ratio for layer 7:
[[0.0676, 0.0], [0.0, 0.9324]]	100.00%

Correct prediction ratio for layer 8:
[[0.0589, 0.0], [0.0, 0.9411]]	100.00%

Correct prediction ratio for layer 9:
[[0.057, 0.0], [0.0, 0.943]]	100.00%

Correct prediction ratio for layer 10:
[[0.0548, 0.0], [0.0, 0.9452]]	100.00%

Correct prediction ratio for layer 11:
[[0.056, 0.0], [0.0, 0.944]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 8 epochs: 0.40%

Epoch [9/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [9/10]:   1%|          | 1/157 [00:03<09:40,  3.72s/it]Epoch [9/10]:   1%|▏         | 2/157 [00:06<07:35,  2.94s/it]Epoch [9/10]:   2%|▏         | 3/157 [00:08<06:53,  2.68s/it]Epoch [9/10]:   3%|▎         | 4/157 [00:10<06:32,  2.57s/it]Epoch [9/10]:   3%|▎         | 5/157 [00:13<06:20,  2.50s/it]Epoch [9/10]:   4%|▍         | 6/157 [00:15<06:12,  2.46s/it]Epoch [9/10]:   4%|▍         | 7/157 [00:18<06:05,  2.44s/it]Epoch [9/10]:   5%|▌         | 8/157 [00:20<06:01,  2.42s/it]Epoch [9/10]:   6%|▌         | 9/157 [00:22<05:57,  2.41s/it]Epoch [9/10]:   6%|▋         | 10/157 [00:25<05:53,  2.41s/it]Epoch [9/10]:   7%|▋         | 11/157 [00:27<05:50,  2.40s/it]Epoch [9/10]:   8%|▊         | 12/157 [00:30<05:47,  2.40s/it]Epoch [9/10]:   8%|▊         | 13/157 [00:32<05:45,  2.40s/it]Epoch [9/10]:   9%|▉         | 14/157 [00:35<05:58,  2.51s/it]Epoch [9/10]:  10%|▉         | 15/157 [00:37<05:51,  2.47s/it]Epoch [9/10]:  10%|█         | 16/157 [00:39<05:45,  2.45s/it]Epoch [9/10]:  11%|█         | 17/157 [00:42<05:40,  2.44s/it]Epoch [9/10]:  11%|█▏        | 18/157 [00:44<05:36,  2.42s/it]Epoch [9/10]:  12%|█▏        | 19/157 [00:47<05:32,  2.41s/it]Epoch [9/10]:  13%|█▎        | 20/157 [00:49<05:30,  2.41s/it]Epoch [9/10]:  13%|█▎        | 21/157 [00:51<05:28,  2.41s/it]Epoch [9/10]:  14%|█▍        | 22/157 [00:54<05:25,  2.41s/it]Epoch [9/10]:  15%|█▍        | 23/157 [00:56<05:23,  2.41s/it]Epoch [9/10]:  15%|█▌        | 24/157 [00:59<05:20,  2.41s/it]Epoch [9/10]:  16%|█▌        | 25/157 [01:01<05:18,  2.41s/it]Epoch [9/10]:  17%|█▋        | 26/157 [01:04<05:15,  2.41s/it]Epoch [9/10]:  17%|█▋        | 27/157 [01:06<05:13,  2.41s/it]Epoch [9/10]:  18%|█▊        | 28/157 [01:08<05:11,  2.41s/it]Epoch [9/10]:  18%|█▊        | 29/157 [01:11<05:09,  2.41s/it]Epoch [9/10]:  19%|█▉        | 30/157 [01:13<05:07,  2.42s/it]Epoch [9/10]:  20%|█▉        | 31/157 [01:16<05:04,  2.42s/it]Epoch [9/10]:  20%|██        | 32/157 [01:18<05:02,  2.42s/it]Epoch [9/10]:  21%|██        | 33/157 [01:20<05:00,  2.42s/it]Epoch [9/10]:  22%|██▏       | 34/157 [01:23<04:57,  2.42s/it]Epoch [9/10]:  22%|██▏       | 35/157 [01:25<04:54,  2.42s/it]Epoch [9/10]:  23%|██▎       | 36/157 [01:28<04:52,  2.42s/it]Epoch [9/10]:  24%|██▎       | 37/157 [01:30<04:49,  2.42s/it]Epoch [9/10]:  24%|██▍       | 38/157 [01:33<04:47,  2.42s/it]Epoch [9/10]:  25%|██▍       | 39/157 [01:35<04:45,  2.42s/it]Epoch [9/10]:  25%|██▌       | 40/157 [01:37<04:42,  2.42s/it]Epoch [9/10]:  26%|██▌       | 41/157 [01:40<04:40,  2.42s/it]Epoch [9/10]:  27%|██▋       | 42/157 [01:42<04:38,  2.42s/it]Epoch [9/10]:  27%|██▋       | 43/157 [01:45<04:35,  2.42s/it]Epoch [9/10]:  28%|██▊       | 44/157 [01:47<04:42,  2.50s/it]Epoch [9/10]:  29%|██▊       | 45/157 [01:50<04:37,  2.48s/it]Epoch [9/10]:  29%|██▉       | 46/157 [01:52<04:32,  2.46s/it]Epoch [9/10]:  30%|██▉       | 47/157 [01:55<04:28,  2.44s/it]Epoch [9/10]:  31%|███       | 48/157 [01:57<04:25,  2.43s/it]Epoch [9/10]:  31%|███       | 49/157 [01:59<04:21,  2.43s/it]Epoch [9/10]:  32%|███▏      | 50/157 [02:02<04:19,  2.42s/it]Epoch [9/10]:  32%|███▏      | 51/157 [02:04<04:16,  2.42s/it]Epoch [9/10]:  33%|███▎      | 52/157 [02:07<04:13,  2.41s/it]Epoch [9/10]:  34%|███▍      | 53/157 [02:09<04:10,  2.41s/it]Epoch [9/10]:  34%|███▍      | 54/157 [02:11<04:08,  2.42s/it]Epoch [9/10]:  35%|███▌      | 55/157 [02:14<04:06,  2.41s/it]Epoch [9/10]:  36%|███▌      | 56/157 [02:16<04:04,  2.42s/it]Epoch [9/10]:  36%|███▋      | 57/157 [02:19<04:01,  2.42s/it]Epoch [9/10]:  37%|███▋      | 58/157 [02:21<03:59,  2.42s/it]Epoch [9/10]:  38%|███▊      | 59/157 [02:23<03:56,  2.41s/it]Epoch [9/10]:  38%|███▊      | 60/157 [02:26<03:54,  2.41s/it]Epoch [9/10]:  39%|███▉      | 61/157 [02:28<03:51,  2.41s/it]Epoch [9/10]:  39%|███▉      | 62/157 [02:31<03:49,  2.41s/it]Epoch [9/10]:  40%|████      | 63/157 [02:33<03:46,  2.41s/it]Epoch [9/10]:  41%|████      | 64/157 [02:36<03:44,  2.41s/it]Epoch [9/10]:  41%|████▏     | 65/157 [02:38<03:42,  2.42s/it]Epoch [9/10]:  42%|████▏     | 66/157 [02:40<03:40,  2.42s/it]Epoch [9/10]:  43%|████▎     | 67/157 [02:43<03:38,  2.42s/it]Epoch [9/10]:  43%|████▎     | 68/157 [02:45<03:35,  2.42s/it]Epoch [9/10]:  44%|████▍     | 69/157 [02:48<03:32,  2.42s/it]Epoch [9/10]:  45%|████▍     | 70/157 [02:50<03:30,  2.42s/it]Epoch [9/10]:  45%|████▌     | 71/157 [02:53<03:27,  2.42s/it]Epoch [9/10]:  46%|████▌     | 72/157 [02:55<03:25,  2.41s/it]Epoch [9/10]:  46%|████▋     | 73/157 [02:58<03:29,  2.50s/it]Epoch [9/10]:  47%|████▋     | 74/157 [03:00<03:25,  2.47s/it]Epoch [9/10]:  48%|████▊     | 75/157 [03:02<03:21,  2.46s/it]Epoch [9/10]:  48%|████▊     | 76/157 [03:05<03:17,  2.44s/it]Epoch [9/10]:  49%|████▉     | 77/157 [03:07<03:14,  2.43s/it]Epoch [9/10]:  50%|████▉     | 78/157 [03:10<03:11,  2.42s/it]Epoch [9/10]:  50%|█████     | 79/157 [03:12<03:08,  2.42s/it]Epoch [9/10]:  51%|█████     | 80/157 [03:15<03:06,  2.42s/it]Epoch [9/10]:  52%|█████▏    | 81/157 [03:17<03:03,  2.42s/it]Epoch [9/10]:  52%|█████▏    | 82/157 [03:19<03:01,  2.42s/it]Epoch [9/10]:  53%|█████▎    | 83/157 [03:22<02:58,  2.42s/it]Epoch [9/10]:  54%|█████▎    | 84/157 [03:24<02:56,  2.42s/it]Epoch [9/10]:  54%|█████▍    | 85/157 [03:27<02:54,  2.42s/it]Epoch [9/10]:  55%|█████▍    | 86/157 [03:29<02:51,  2.42s/it]Epoch [9/10]:  55%|█████▌    | 87/157 [03:31<02:49,  2.42s/it]Epoch [9/10]:  56%|█████▌    | 88/157 [03:34<02:46,  2.42s/it]Epoch [9/10]:  57%|█████▋    | 89/157 [03:36<02:44,  2.42s/it]Epoch [9/10]:  57%|█████▋    | 90/157 [03:39<02:41,  2.41s/it]Epoch [9/10]:  58%|█████▊    | 91/157 [03:41<02:39,  2.41s/it]Epoch [9/10]:  59%|█████▊    | 92/157 [03:44<02:36,  2.41s/it]Epoch [9/10]:  59%|█████▉    | 93/157 [03:46<02:34,  2.41s/it]Epoch [9/10]:  60%|█████▉    | 94/157 [03:48<02:32,  2.41s/it]Epoch [9/10]:  61%|██████    | 95/157 [03:51<02:29,  2.41s/it]Epoch [9/10]:  61%|██████    | 96/157 [03:53<02:27,  2.41s/it]Epoch [9/10]:  62%|██████▏   | 97/157 [03:56<02:25,  2.42s/it]Epoch [9/10]:  62%|██████▏   | 98/157 [03:58<02:22,  2.42s/it]Epoch [9/10]:  63%|██████▎   | 99/157 [04:01<02:24,  2.50s/it]Epoch [9/10]:  64%|██████▎   | 100/157 [04:03<02:20,  2.47s/it]Epoch [9/10]:  64%|██████▍   | 101/157 [04:05<02:17,  2.45s/it]Epoch [9/10]:  65%|██████▍   | 102/157 [04:08<02:14,  2.44s/it]Epoch [9/10]:  66%|██████▌   | 103/157 [04:10<02:11,  2.43s/it]Epoch [9/10]:  66%|██████▌   | 104/157 [04:13<02:08,  2.43s/it]Epoch [9/10]:  67%|██████▋   | 105/157 [04:15<02:05,  2.42s/it]Epoch [9/10]:  68%|██████▊   | 106/157 [04:18<02:03,  2.42s/it]Epoch [9/10]:  68%|██████▊   | 107/157 [04:20<02:00,  2.42s/it]Epoch [9/10]:  69%|██████▉   | 108/157 [04:22<01:58,  2.41s/it]Epoch [9/10]:  69%|██████▉   | 109/157 [04:25<01:56,  2.42s/it]Epoch [9/10]:  70%|███████   | 110/157 [04:27<01:53,  2.41s/it]Epoch [9/10]:  71%|███████   | 111/157 [04:30<01:51,  2.41s/it]Epoch [9/10]:  71%|███████▏  | 112/157 [04:32<01:48,  2.41s/it]Epoch [9/10]:  72%|███████▏  | 113/157 [04:34<01:46,  2.41s/it]Epoch [9/10]:  73%|███████▎  | 114/157 [04:37<01:43,  2.41s/it]Epoch [9/10]:  73%|███████▎  | 115/157 [04:39<01:41,  2.41s/it]Epoch [9/10]:  74%|███████▍  | 116/157 [04:42<01:38,  2.41s/it]Epoch [9/10]:  75%|███████▍  | 117/157 [04:44<01:36,  2.41s/it]Epoch [9/10]:  75%|███████▌  | 118/157 [04:46<01:34,  2.41s/it]Epoch [9/10]:  76%|███████▌  | 119/157 [04:49<01:31,  2.41s/it]Epoch [9/10]:  76%|███████▋  | 120/157 [04:51<01:29,  2.41s/it]Epoch [9/10]:  77%|███████▋  | 121/157 [04:54<01:26,  2.42s/it]Epoch [9/10]:  78%|███████▊  | 122/157 [04:56<01:24,  2.41s/it]Epoch [9/10]:  78%|███████▊  | 123/157 [04:59<01:22,  2.42s/it]Epoch [9/10]:  79%|███████▉  | 124/157 [05:01<01:19,  2.42s/it]Epoch [9/10]:  80%|███████▉  | 125/157 [05:03<01:17,  2.42s/it]Epoch [9/10]:  80%|████████  | 126/157 [05:06<01:14,  2.41s/it]Epoch [9/10]:  81%|████████  | 127/157 [05:08<01:12,  2.41s/it]Epoch [9/10]:  82%|████████▏ | 128/157 [05:11<01:09,  2.41s/it]Epoch [9/10]:  82%|████████▏ | 129/157 [05:13<01:09,  2.49s/it]Epoch [9/10]:  83%|████████▎ | 130/157 [05:16<01:06,  2.46s/it]Epoch [9/10]:  83%|████████▎ | 131/157 [05:18<01:03,  2.44s/it]Epoch [9/10]:  84%|████████▍ | 132/157 [05:20<01:00,  2.43s/it]Epoch [9/10]:  85%|████████▍ | 133/157 [05:23<00:58,  2.42s/it]Epoch [9/10]:  85%|████████▌ | 134/157 [05:25<00:55,  2.42s/it]Epoch [9/10]:  86%|████████▌ | 135/157 [05:28<00:53,  2.42s/it]Epoch [9/10]:  87%|████████▋ | 136/157 [05:30<00:50,  2.41s/it]Epoch [9/10]:  87%|████████▋ | 137/157 [05:33<00:48,  2.42s/it]Epoch [9/10]:  88%|████████▊ | 138/157 [05:35<00:45,  2.42s/it]Epoch [9/10]:  89%|████████▊ | 139/157 [05:37<00:43,  2.42s/it]Epoch [9/10]:  89%|████████▉ | 140/157 [05:40<00:41,  2.41s/it]Epoch [9/10]:  90%|████████▉ | 141/157 [05:42<00:38,  2.41s/it]Epoch [9/10]:  90%|█████████ | 142/157 [05:45<00:36,  2.41s/it]Epoch [9/10]:  91%|█████████ | 143/157 [05:47<00:33,  2.41s/it]Epoch [9/10]:  92%|█████████▏| 144/157 [05:49<00:31,  2.41s/it]Epoch [9/10]:  92%|█████████▏| 145/157 [05:52<00:28,  2.41s/it]Epoch [9/10]:  93%|█████████▎| 146/157 [05:54<00:26,  2.41s/it]Epoch [9/10]:  94%|█████████▎| 147/157 [05:57<00:24,  2.41s/it]Epoch [9/10]:  94%|█████████▍| 148/157 [05:59<00:21,  2.41s/it]Epoch [9/10]:  95%|█████████▍| 149/157 [06:01<00:19,  2.41s/it]Epoch [9/10]:  96%|█████████▌| 150/157 [06:04<00:16,  2.41s/it]Epoch [9/10]:  96%|█████████▌| 151/157 [06:06<00:14,  2.41s/it]Epoch [9/10]:  97%|█████████▋| 152/157 [06:09<00:12,  2.41s/it]Epoch [9/10]:  97%|█████████▋| 153/157 [06:11<00:09,  2.41s/it]Epoch [9/10]:  98%|█████████▊| 154/157 [06:14<00:07,  2.41s/it]Epoch [9/10]:  99%|█████████▊| 155/157 [06:16<00:04,  2.41s/it]Epoch [9/10]:  99%|█████████▉| 156/157 [06:19<00:02,  2.49s/it]Epoch [9/10]: 100%|██████████| 157/157 [06:19<00:00,  1.93s/it]                                                               Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.42s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.54s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.26s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.13s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.06s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.02s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:15<00:01,  1.99s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.86s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 4.5918e-05,
        3.9684e-02, 6.4485e-02, 5.6184e-02, 5.4041e-02, 5.2316e-02, 5.3026e-02])
Skip %: 2.66%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 6:
[[0.0397, 0.0], [0.0, 0.9603]]	100.00%

Correct prediction ratio for layer 7:
[[0.0645, 0.0], [0.0, 0.9355]]	100.00%

Correct prediction ratio for layer 8:
[[0.0562, 0.0], [0.0, 0.9438]]	100.00%

Correct prediction ratio for layer 9:
[[0.054, 0.0], [0.0, 0.946]]	100.00%

Correct prediction ratio for layer 10:
[[0.0523, 0.0], [0.0, 0.9477]]	100.00%

Correct prediction ratio for layer 11:
[[0.053, 0.0], [0.0, 0.947]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 9 epochs: 0.40%

Epoch [10/10]:   0%|          | 0/157 [00:00<?, ?it/s]Epoch [10/10]:   1%|          | 1/157 [00:03<09:56,  3.82s/it]Epoch [10/10]:   1%|▏         | 2/157 [00:06<07:43,  2.99s/it]Epoch [10/10]:   2%|▏         | 3/157 [00:08<06:59,  2.72s/it]Epoch [10/10]:   3%|▎         | 4/157 [00:11<06:38,  2.60s/it]Epoch [10/10]:   3%|▎         | 5/157 [00:13<06:25,  2.54s/it]Epoch [10/10]:   4%|▍         | 6/157 [00:15<06:16,  2.50s/it]Epoch [10/10]:   4%|▍         | 7/157 [00:18<06:10,  2.47s/it]Epoch [10/10]:   5%|▌         | 8/157 [00:20<06:06,  2.46s/it]Epoch [10/10]:   6%|▌         | 9/157 [00:23<06:02,  2.45s/it]Epoch [10/10]:   6%|▋         | 10/157 [00:25<05:58,  2.44s/it]Epoch [10/10]:   7%|▋         | 11/157 [00:28<05:54,  2.43s/it]Epoch [10/10]:   8%|▊         | 12/157 [00:30<05:52,  2.43s/it]Epoch [10/10]:   8%|▊         | 13/157 [00:32<05:49,  2.43s/it]Epoch [10/10]:   9%|▉         | 14/157 [00:35<05:46,  2.42s/it]Epoch [10/10]:  10%|▉         | 15/157 [00:37<05:43,  2.42s/it]Epoch [10/10]:  10%|█         | 16/157 [00:40<05:41,  2.42s/it]Epoch [10/10]:  11%|█         | 17/157 [00:42<05:39,  2.42s/it]Epoch [10/10]:  11%|█▏        | 18/157 [00:44<05:36,  2.42s/it]Epoch [10/10]:  12%|█▏        | 19/157 [00:47<05:34,  2.42s/it]Epoch [10/10]:  13%|█▎        | 20/157 [00:49<05:32,  2.43s/it]Epoch [10/10]:  13%|█▎        | 21/157 [00:52<05:29,  2.42s/it]Epoch [10/10]:  14%|█▍        | 22/157 [00:54<05:27,  2.42s/it]Epoch [10/10]:  15%|█▍        | 23/157 [00:57<05:24,  2.42s/it]Epoch [10/10]:  15%|█▌        | 24/157 [00:59<05:22,  2.42s/it]Epoch [10/10]:  16%|█▌        | 25/157 [01:01<05:19,  2.42s/it]Epoch [10/10]:  17%|█▋        | 26/157 [01:04<05:17,  2.42s/it]Epoch [10/10]:  17%|█▋        | 27/157 [01:06<05:14,  2.42s/it]Epoch [10/10]:  18%|█▊        | 28/157 [01:09<05:12,  2.42s/it]Epoch [10/10]:  18%|█▊        | 29/157 [01:11<05:09,  2.42s/it]Epoch [10/10]:  19%|█▉        | 30/157 [01:14<05:19,  2.52s/it]Epoch [10/10]:  20%|█▉        | 31/157 [01:16<05:13,  2.49s/it]Epoch [10/10]:  20%|██        | 32/157 [01:19<05:08,  2.47s/it]Epoch [10/10]:  21%|██        | 33/157 [01:21<05:04,  2.45s/it]Epoch [10/10]:  22%|██▏       | 34/157 [01:24<05:00,  2.45s/it]Epoch [10/10]:  22%|██▏       | 35/157 [01:26<04:57,  2.44s/it]Epoch [10/10]:  23%|██▎       | 36/157 [01:28<04:53,  2.43s/it]Epoch [10/10]:  24%|██▎       | 37/157 [01:31<04:51,  2.43s/it]Epoch [10/10]:  24%|██▍       | 38/157 [01:33<04:48,  2.42s/it]Epoch [10/10]:  25%|██▍       | 39/157 [01:36<04:45,  2.42s/it]Epoch [10/10]:  25%|██▌       | 40/157 [01:38<04:43,  2.42s/it]Epoch [10/10]:  26%|██▌       | 41/157 [01:40<04:41,  2.42s/it]Epoch [10/10]:  27%|██▋       | 42/157 [01:43<04:41,  2.45s/it]Epoch [10/10]:  27%|██▋       | 43/157 [01:45<04:39,  2.45s/it]Epoch [10/10]:  28%|██▊       | 44/157 [01:48<04:38,  2.47s/it]Epoch [10/10]:  29%|██▊       | 45/157 [01:50<04:38,  2.48s/it]Epoch [10/10]:  29%|██▉       | 46/157 [01:53<04:36,  2.49s/it]Epoch [10/10]:  30%|██▉       | 47/157 [01:55<04:33,  2.49s/it]Epoch [10/10]:  31%|███       | 48/157 [01:58<04:29,  2.47s/it]Epoch [10/10]:  31%|███       | 49/157 [02:00<04:26,  2.47s/it]Epoch [10/10]:  32%|███▏      | 50/157 [02:03<04:22,  2.46s/it]Epoch [10/10]:  32%|███▏      | 51/157 [02:05<04:20,  2.46s/it]Epoch [10/10]:  33%|███▎      | 52/157 [02:08<04:17,  2.45s/it]Epoch [10/10]:  34%|███▍      | 53/157 [02:10<04:14,  2.45s/it]Epoch [10/10]:  34%|███▍      | 54/157 [02:13<04:11,  2.44s/it]Epoch [10/10]:  35%|███▌      | 55/157 [02:15<04:08,  2.44s/it]Epoch [10/10]:  36%|███▌      | 56/157 [02:17<04:06,  2.44s/it]Epoch [10/10]:  36%|███▋      | 57/157 [02:20<04:03,  2.44s/it]Epoch [10/10]:  37%|███▋      | 58/157 [02:23<04:09,  2.52s/it]Epoch [10/10]:  38%|███▊      | 59/157 [02:25<04:04,  2.49s/it]Epoch [10/10]:  38%|███▊      | 60/157 [02:27<03:59,  2.47s/it]Epoch [10/10]:  39%|███▉      | 61/157 [02:30<03:57,  2.47s/it]Epoch [10/10]:  39%|███▉      | 62/157 [02:32<03:53,  2.46s/it]Epoch [10/10]:  40%|████      | 63/157 [02:35<03:50,  2.45s/it]Epoch [10/10]:  41%|████      | 64/157 [02:37<03:47,  2.45s/it]Epoch [10/10]:  41%|████▏     | 65/157 [02:40<03:45,  2.45s/it]Epoch [10/10]:  42%|████▏     | 66/157 [02:42<03:42,  2.44s/it]Epoch [10/10]:  43%|████▎     | 67/157 [02:44<03:39,  2.44s/it]Epoch [10/10]:  43%|████▎     | 68/157 [02:47<03:36,  2.44s/it]Epoch [10/10]:  44%|████▍     | 69/157 [02:49<03:34,  2.44s/it]Epoch [10/10]:  45%|████▍     | 70/157 [02:52<03:31,  2.43s/it]Epoch [10/10]:  45%|████▌     | 71/157 [02:54<03:29,  2.44s/it]Epoch [10/10]:  46%|████▌     | 72/157 [02:57<03:27,  2.44s/it]Epoch [10/10]:  46%|████▋     | 73/157 [02:59<03:24,  2.44s/it]Epoch [10/10]:  47%|████▋     | 74/157 [03:02<03:22,  2.43s/it]Epoch [10/10]:  48%|████▊     | 75/157 [03:04<03:20,  2.44s/it]Epoch [10/10]:  48%|████▊     | 76/157 [03:06<03:17,  2.43s/it]Epoch [10/10]:  49%|████▉     | 77/157 [03:09<03:14,  2.44s/it]Epoch [10/10]:  50%|████▉     | 78/157 [03:11<03:12,  2.43s/it]Epoch [10/10]:  50%|█████     | 79/157 [03:14<03:09,  2.43s/it]Epoch [10/10]:  51%|█████     | 80/157 [03:16<03:07,  2.43s/it]Epoch [10/10]:  52%|█████▏    | 81/157 [03:19<03:04,  2.43s/it]Epoch [10/10]:  52%|█████▏    | 82/157 [03:21<03:01,  2.42s/it]Epoch [10/10]:  53%|█████▎    | 83/157 [03:23<02:59,  2.43s/it]Epoch [10/10]:  54%|█████▎    | 84/157 [03:26<02:56,  2.42s/it]Epoch [10/10]:  54%|█████▍    | 85/157 [03:28<03:00,  2.50s/it]Epoch [10/10]:  55%|█████▍    | 86/157 [03:31<02:56,  2.48s/it]Epoch [10/10]:  55%|█████▌    | 87/157 [03:33<02:53,  2.47s/it]Epoch [10/10]:  56%|█████▌    | 88/157 [03:36<02:49,  2.46s/it]Epoch [10/10]:  57%|█████▋    | 89/157 [03:38<02:46,  2.45s/it]Epoch [10/10]:  57%|█████▋    | 90/157 [03:41<02:43,  2.44s/it]Epoch [10/10]:  58%|█████▊    | 91/157 [03:43<02:40,  2.44s/it]Epoch [10/10]:  59%|█████▊    | 92/157 [03:45<02:38,  2.43s/it]Epoch [10/10]:  59%|█████▉    | 93/157 [03:48<02:35,  2.43s/it]Epoch [10/10]:  60%|█████▉    | 94/157 [03:50<02:32,  2.42s/it]Epoch [10/10]:  61%|██████    | 95/157 [03:53<02:30,  2.42s/it]Epoch [10/10]:  61%|██████    | 96/157 [03:55<02:27,  2.42s/it]Epoch [10/10]:  62%|██████▏   | 97/157 [03:58<02:25,  2.42s/it]Epoch [10/10]:  62%|██████▏   | 98/157 [04:00<02:22,  2.42s/it]Epoch [10/10]:  63%|██████▎   | 99/157 [04:02<02:20,  2.42s/it]Epoch [10/10]:  64%|██████▎   | 100/157 [04:05<02:18,  2.42s/it]Epoch [10/10]:  64%|██████▍   | 101/157 [04:07<02:15,  2.43s/it]Epoch [10/10]:  65%|██████▍   | 102/157 [04:10<02:13,  2.43s/it]Epoch [10/10]:  66%|██████▌   | 103/157 [04:12<02:11,  2.43s/it]Epoch [10/10]:  66%|██████▌   | 104/157 [04:15<02:08,  2.43s/it]Epoch [10/10]:  67%|██████▋   | 105/157 [04:17<02:06,  2.43s/it]Epoch [10/10]:  68%|██████▊   | 106/157 [04:19<02:03,  2.43s/it]Epoch [10/10]:  68%|██████▊   | 107/157 [04:22<02:01,  2.43s/it]Epoch [10/10]:  69%|██████▉   | 108/157 [04:24<01:59,  2.43s/it]Epoch [10/10]:  69%|██████▉   | 109/157 [04:27<01:56,  2.43s/it]Epoch [10/10]:  70%|███████   | 110/157 [04:29<01:54,  2.43s/it]Epoch [10/10]:  71%|███████   | 111/157 [04:32<01:52,  2.44s/it]Epoch [10/10]:  71%|███████▏  | 112/157 [04:34<01:53,  2.52s/it]Epoch [10/10]:  72%|███████▏  | 113/157 [04:37<01:49,  2.50s/it]Epoch [10/10]:  73%|███████▎  | 114/157 [04:39<01:46,  2.48s/it]Epoch [10/10]:  73%|███████▎  | 115/157 [04:42<01:43,  2.47s/it]Epoch [10/10]:  74%|███████▍  | 116/157 [04:44<01:40,  2.46s/it]Epoch [10/10]:  75%|███████▍  | 117/157 [04:47<01:37,  2.45s/it]Epoch [10/10]:  75%|███████▌  | 118/157 [04:49<01:35,  2.45s/it]Epoch [10/10]:  76%|███████▌  | 119/157 [04:51<01:32,  2.44s/it]Epoch [10/10]:  76%|███████▋  | 120/157 [04:54<01:30,  2.44s/it]Epoch [10/10]:  77%|███████▋  | 121/157 [04:56<01:27,  2.44s/it]Epoch [10/10]:  78%|███████▊  | 122/157 [04:59<01:25,  2.44s/it]Epoch [10/10]:  78%|███████▊  | 123/157 [05:01<01:23,  2.44s/it]Epoch [10/10]:  79%|███████▉  | 124/157 [05:04<01:20,  2.44s/it]Epoch [10/10]:  80%|███████▉  | 125/157 [05:06<01:18,  2.44s/it]Epoch [10/10]:  80%|████████  | 126/157 [05:08<01:15,  2.44s/it]Epoch [10/10]:  81%|████████  | 127/157 [05:11<01:13,  2.43s/it]Epoch [10/10]:  82%|████████▏ | 128/157 [05:13<01:10,  2.43s/it]Epoch [10/10]:  82%|████████▏ | 129/157 [05:16<01:07,  2.43s/it]Epoch [10/10]:  83%|████████▎ | 130/157 [05:18<01:05,  2.43s/it]Epoch [10/10]:  83%|████████▎ | 131/157 [05:21<01:03,  2.43s/it]Epoch [10/10]:  84%|████████▍ | 132/157 [05:23<01:00,  2.42s/it]Epoch [10/10]:  85%|████████▍ | 133/157 [05:25<00:58,  2.42s/it]Epoch [10/10]:  85%|████████▌ | 134/157 [05:28<00:55,  2.43s/it]Epoch [10/10]:  86%|████████▌ | 135/157 [05:30<00:53,  2.42s/it]Epoch [10/10]:  87%|████████▋ | 136/157 [05:33<00:51,  2.43s/it]Epoch [10/10]:  87%|████████▋ | 137/157 [05:35<00:48,  2.43s/it]Epoch [10/10]:  88%|████████▊ | 138/157 [05:38<00:46,  2.42s/it]Epoch [10/10]:  89%|████████▊ | 139/157 [05:40<00:43,  2.42s/it]Epoch [10/10]:  89%|████████▉ | 140/157 [05:42<00:41,  2.42s/it]Epoch [10/10]:  90%|████████▉ | 141/157 [05:45<00:38,  2.42s/it]Epoch [10/10]:  90%|█████████ | 142/157 [05:48<00:37,  2.50s/it]Epoch [10/10]:  91%|█████████ | 143/157 [05:50<00:34,  2.48s/it]Epoch [10/10]:  92%|█████████▏| 144/157 [05:52<00:31,  2.46s/it]Epoch [10/10]:  92%|█████████▏| 145/157 [05:55<00:29,  2.45s/it]Epoch [10/10]:  93%|█████████▎| 146/157 [05:57<00:26,  2.44s/it]Epoch [10/10]:  94%|█████████▎| 147/157 [06:00<00:24,  2.44s/it]Epoch [10/10]:  94%|█████████▍| 148/157 [06:02<00:21,  2.44s/it]Epoch [10/10]:  95%|█████████▍| 149/157 [06:04<00:19,  2.44s/it]Epoch [10/10]:  96%|█████████▌| 150/157 [06:07<00:17,  2.45s/it]Epoch [10/10]:  96%|█████████▌| 151/157 [06:09<00:14,  2.45s/it]Epoch [10/10]:  97%|█████████▋| 152/157 [06:12<00:12,  2.45s/it]Epoch [10/10]:  97%|█████████▋| 153/157 [06:14<00:09,  2.46s/it]Epoch [10/10]:  98%|█████████▊| 154/157 [06:17<00:07,  2.46s/it]Epoch [10/10]:  99%|█████████▊| 155/157 [06:19<00:04,  2.46s/it]Epoch [10/10]:  99%|█████████▉| 156/157 [06:22<00:02,  2.46s/it]Epoch [10/10]: 100%|██████████| 157/157 [06:22<00:00,  1.91s/it]                                                                Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.38s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.55s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.27s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.15s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.07s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.03s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:15<00:01,  1.99s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.86s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 8.1633e-05,
        3.9755e-02, 6.1893e-02, 5.5408e-02, 5.3240e-02, 5.1551e-02, 5.3398e-02])
Skip %: 2.63%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.0398, 0.0], [0.0, 0.9602]]	100.00%

Correct prediction ratio for layer 7:
[[0.0619, 0.0], [0.0, 0.9381]]	100.00%

Correct prediction ratio for layer 8:
[[0.0554, 0.0], [0.0, 0.9446]]	100.00%

Correct prediction ratio for layer 9:
[[0.0532, 0.0], [0.0, 0.9468]]	100.00%

Correct prediction ratio for layer 10:
[[0.0516, 0.0], [0.0, 0.9484]]	100.00%

Correct prediction ratio for layer 11:
[[0.0534, 0.0], [0.0, 0.9466]]	100.00%

Overall accuracy of MLP: 100.00%
Test accuracy after 10 epochs: 0.40%

Best accuracy: 0.7000000000000001%

Testing:   0%|          | 0/8 [00:00<?, ?it/s]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  12%|█▎        | 1/8 [00:03<00:23,  3.34s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  25%|██▌       | 2/8 [00:05<00:15,  2.51s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  38%|███▊      | 3/8 [00:07<00:11,  2.25s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  50%|█████     | 4/8 [00:09<00:08,  2.13s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  62%|██████▎   | 5/8 [00:11<00:06,  2.07s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  75%|███████▌  | 6/8 [00:13<00:04,  2.02s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing:  88%|████████▊ | 7/8 [00:14<00:01,  2.00s/it]/home/ai21btech11012/ViT-pruning/mukunda/new/hi_main.py:282: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  total_correct_mlp[i] += vit_layer.mlp_confusion_matrix
Testing: 100%|██████████| 8/8 [00:16<00:00,  1.87s/it]                                                      Skip ratio: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 8.1633e-05,
        3.9755e-02, 6.1893e-02, 5.5408e-02, 5.3240e-02, 5.1551e-02, 5.3398e-02])
Skip %: 2.63%
Correct prediction ratio for layer 0:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 1:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 2:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 3:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 4:
[[0.0, 0.0], [0.0, 1.0]]	100.00%

Correct prediction ratio for layer 5:
[[0.0001, 0.0], [0.0, 0.9999]]	100.00%

Correct prediction ratio for layer 6:
[[0.0398, 0.0], [0.0, 0.9602]]	100.00%

Correct prediction ratio for layer 7:
[[0.0619, 0.0], [0.0, 0.9381]]	100.00%

Correct prediction ratio for layer 8:
[[0.0554, 0.0], [0.0, 0.9446]]	100.00%

Correct prediction ratio for layer 9:
[[0.0532, 0.0], [0.0, 0.9468]]	100.00%

Correct prediction ratio for layer 10:
[[0.0516, 0.0], [0.0, 0.9484]]	100.00%

Correct prediction ratio for layer 11:
[[0.0534, 0.0], [0.0, 0.9466]]	100.00%

Overall accuracy of MLP: 100.00%
33.85 GMac 16.87 GMac
